this.LeaferIN=this.LeaferIN||{},this.LeaferIN.flow=function(t,e){"use strict";const{M:o,L:i,C:n,Q:s,Z:h,N:a,D:c,X:r,G:l,F:_,O:u,P:p,U:f}=e.PathCommandMap,d={scale(t,e,d){if(!t)return;let w,y=0,x=t.length;for(;y<x;)switch(w=t[y],w){case o:case i:g(t,e,d,y,1),y+=3;break;case n:g(t,e,d,y,3),y+=7;break;case s:g(t,e,d,y,2),y+=5;break;case h:y+=1;break;case a:g(t,e,d,y,2),y+=5;break;case c:g(t,e,d,y,2),y+=9;break;case r:g(t,e,d,y,2),y+=6;break;case l:g(t,e,d,y,2),y+=9;break;case _:g(t,e,d,y,2),y+=5;break;case u:t[y]=l,t.splice(y+4,0,t[y+3],0),g(t,e,d,y,2),y+=9,x+=2;break;case p:t[y]=_,t.splice(y+4,0,t[y+3]),g(t,e,d,y,2),y+=5,x+=1;break;case f:g(t,e,d,y,2),y+=6}},scalePoints(t,e,o,i,n){for(let s=n?i+1:0,h=n?s+2*n:t.length;s<h;s+=2)t[s]*=e,t[s+1]*=o}},{scalePoints:g}=d,w=e.MatrixHelper.get(),{topLeft:y,top:x,topRight:b,right:G,bottom:B,left:R}=e.Direction9;function m(t,e,o){t.pathInputed?A(t,e,o):(1!==e&&(t.width*=e),1!==o&&(t.height*=o))}function z(t,e,o){const{app:i}=t,n=i&&i.editor;let s=e;if(n.editing){const i=t.__layout;let{width:h,height:a}=i.boxBounds;switch(h*=o-e,a*=e-o,n.resizeDirection){case x:case B:s=o,i.affectScaleOrRotation?t.moveInner(-h/2,0):t.x-=h/2;break;case R:case G:i.affectScaleOrRotation?t.moveInner(0,-a/2):t.y-=a/2;break;case y:case b:i.affectScaleOrRotation?t.moveInner(0,-a):t.y-=a}}t.fontSize*=s;const h=t.__;h.__autoWidth||(t.width*=s),h.__autoHeight||(t.height*=s)}function A(t,e,o){d.scale(t.__.path,e,o),t.path=t.__.path}function k(t,e,o){const{points:i}=t;"object"==typeof i[0]?i.forEach((t=>{t.x*=e,t.y*=o})):d.scalePoints(i,e,o),t.points=i}function F(t,e,o){const{children:i}=t;for(let t=0;t<i.length;t++)w.a=e,w.d=o,i[t].transform(w,!0)}const S=e.Leaf.prototype;function v(t,e,o,i){var n,s=arguments.length,h=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,o,i);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(h=(s<3?n(h):s>3?n(e,o,h):n(e,o))||h);return s>3&&h&&Object.defineProperty(e,o,h),h}S.scaleResize=function(t,e=t,o){const i=this;o||i.editConfig&&"scale"===i.editConfig.editSize?(i.scaleX*=t,i.scaleY*=e):(t<0&&(i.scaleX*=-1,t=-t),e<0&&(i.scaleY*=-1,e=-e),this.__scaleResize(t,e))},S.__scaleResize=function(t,e){m(this,t,e)},S.resizeWidth=function(t){const e=t/this.getBounds("box","local").width;this.scaleOf(this.__layout.boxBounds,e,this.__.lockRatio?e:1,!0)},S.resizeHeight=function(t){const e=t/this.getBounds("box","local").height;this.scaleOf(this.__layout.boxBounds,this.__.lockRatio?e:1,e,!0)},e.Text.prototype.__scaleResize=function(t,e){this.__.resizeFontSize||this.editConfig&&"font-size"===this.editConfig.editSize?z(this,t,e):m(this,t,e)},e.Path.prototype.__scaleResize=function(t,e){A(this,t,e)},e.Line.prototype.__scaleResize=function(t,e){this.pathInputed?A(this,t,e):this.points?k(this,t,e):this.width*=t},e.Polygon.prototype.__scaleResize=function(t,e){this.pathInputed?A(this,t,e):this.points?k(this,t,e):m(this,t,e)},e.Group.prototype.__scaleResize=function(t,e){F(this,t,e)},e.Box.prototype.__scaleResize=function(t,e){this.__.__autoSize&&this.children.length?F(this,t,e):(m(this,t,e),this.__.resizeChildren&&F(this,t,e))},"function"==typeof SuppressedError&&SuppressedError;class P extends e.BoxData{}t.Flow=class extends e.Box{get __tag(){return"Flow"}constructor(t){super(t),this.__hasAutoLayout=!0}},v([e.dataProcessor(P)],t.Flow.prototype,"__",void 0),v([e.autoLayoutType("x")],t.Flow.prototype,"flow",void 0),t.Flow=v([e.registerUI()],t.Flow);const H={},X={"top-left":"from",top:"center","top-right":"to",right:"to","bottom-right":"to",bottom:"center","bottom-left":"from",left:"from",center:"center","baseline-left":"from","baseline-center":"center","baseline-right":"to"},C={"top-left":"from",top:"from","top-right":"from",right:"center","bottom-right":"to",bottom:"to","bottom-left":"to",left:"center",center:"center","baseline-left":"to","baseline-center":"to","baseline-right":"to"};function I(t,o,i){const n=t.__,{contentBounds:s}=t.__layout;e.AlignHelper.toPoint(i,o,s,H),o.x=n.__autoWidth?s.x:H.x,o.y=n.__autoHeight?s.y:H.y}const{move:L}=e.PointHelper;function T(t,e,o,i,n,s){const{children:h}=t;let a,c,{x:r,start:l}=e,_=i;r+=o;for(let t=0,o=e.count;t<o;t++)a=h[s?l-t:l+t],a.__.inFlow&&0!==a.__.visible?(c=a.__flowBounds,"from"!==n&&(_=i+(e.height-c.height)/("center"===n?2:1)),L(a,r-c.x,_-c.y),r+=c.width+e.gap):o++}function Y(t,e,o){const i="width"===o?"height":"width";t[o]=Math.max(t[o],e[o]),t[i]+=t.count?e[i]+t.gap:e[i],t.list.push(e),t.count++}const W={};function O(t,e){const{gap:o,flowAlign:i,flowWrap:n,__autoWidth:s,__autoHeight:h}=t.__,a=n&&(e?!s:!h);return"object"==typeof o?(W.xGap=o.x||0,W.yGap=o.y||0):W.xGap=W.yGap=o,W.isAutoXGap="string"==typeof W.xGap&&!s,W.isAutoYGap="string"==typeof W.yGap&&!h,W.complex=a||"top-left"!==i||t.__hasGrow||W.isAutoXGap||W.isAutoYGap,W.wrap=a,W.complex&&(W.isFitXGap="fit"===W.xGap&&!s,W.isFitYGap="fit"===W.yGap&&!h,"object"==typeof i?(W.contentAlign=i.content||"top-left",W.rowXAlign=i.x||"from",W.rowYAlign=i.y||"from"):(W.contentAlign=i,W.rowXAlign=X[i],W.rowYAlign=C[i])),W}function M(t,e){return{x:0,y:0,width:0,height:0,gap:e,start:t,count:0,grow:0}}function j(t,e,o,i){const{count:n}=t;n>1&&(o>t[e]||i)&&(t.gap=(o-t[e])/(n-1),t[e]=o)}function D(t,e){return"box"===e?t.__local:t.__layout.localStrokeBounds}const{within:E}=e.MathHelper;function N(t,e,o,i){let n,s,h,a=0,c=e.hasRangeSize&&[],{grow:r,start:l}=e;const _=e.width<o?(o-e.width)/r:0,{children:u}=t;_&&(e.width=o);for(let t=0,o=e.count;t<o;t++)n=u[i?l-t:l+t],n.__.inFlow&&0!==n.__.visible?(s=n.__widthGrow)&&(h=U(n,n.__flowBounds,_*s),h?(a+=h,r-=s):c&&(n.__.widthRange?c.unshift(n):c.push(n))):o++;a&&function(t,e,o){let i,n,s,h;t.forEach((t=>{i=t.__widthGrow,n=e/o*i,h=U(t,s=t.__flowBounds,s.width+n),e-=n-h,o-=i}))}(c,a,r)}function U(t,e,o){const{widthRange:i,lockRatio:n}=t.__,s=i?E(o,i):o,h=s/e.width;return t.scaleResize(h,n?h:1),e.width=s,o-s}const{within:Q}=e.MathHelper;function Z(t,e,o,i){let n,s,h,a=0,c=e.hasRangeSize&&[],{grow:r,start:l}=e;const _=e.height<o?(o-e.height)/r:0,{children:u}=t;_&&(e.height=o);for(let t=0,o=e.count;t<o;t++)n=u[i?l-t:l+t],n.__.inFlow&&0!==n.__.visible?(s=n.__heightGrow)&&(h=q(n,n.__flowBounds,_*s),h?(a+=h,r-=s):c&&(n.__.heightRange?c.unshift(n):c.push(n))):o++;a&&function(t,e,o){let i,n,s,h;t.forEach((t=>{i=t.__heightGrow,n=e/o*i,h=q(t,s=t.__flowBounds,s.height+n),e-=n-h,o-=i}))}(c,a,r)}function q(t,e,o){const{heightRange:i,lockRatio:n}=t.__,s=i?Q(o,i):o,h=s/e.height;return t.scaleResize(n?h:1,h),e.height=s,o-s}const{move:J}=e.PointHelper;function K(t,e){const o="width",{children:i,itemBox:n}=t,s=O(t,!0),{complex:h,wrap:a,xGap:c,yGap:r,isAutoXGap:l,isFitXGap:_}=s;if(!i.length)return;const u=a&&{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]},p=l?0:c;let f,d,g,w,y,{x:x,y:b,width:G,height:B}=t.__layout.contentBounds;for(let s=0,c=i.length;s<c;s++)f=i[w=e?c-1-s:s],f.__.inFlow&&0!==f.__.visible&&(d=D(f,n),h?(f.__flowBounds=d,y||(y=M(w,p)),a&&y.count&&y.width+d.width>G&&(y.grow?N(t,y,G,e):l&&j(y,o,G,_),Y(u,y,o),y=M(w,p)),g=d.width,f.__widthGrow&&(y.grow+=f.__widthGrow,g=0,f.__.widthRange&&(y.hasRangeSize=!0)),f.__heightGrow&&q(f,d,B),y.width+=y.count?g+p:g,y.height=Math.max(y.height,d.height),y.count++):(J(f,x-d.x,b-d.y),x+=d.width+p));if(h){const{isAutoYGap:i,isFitYGap:n,contentAlign:h,rowXAlign:c,rowYAlign:p}=s;y.count&&(y.grow?N(t,y,G,e):l&&j(y,o,G,_),a&&Y(u,y,o)),a?(i?j(u,"height",B,n):u.gap=r,function(t,e,o,i){I(t,e,o);const{list:n}=e;if(n.length>1&&(i||(i=X[o]),"from"!==i)){let t;for(let o=0,s=n.length;o<s;o++)t=n[o],t.x=e.width-t.width,"center"===i&&(t.x/=2)}}(t,u,h,c),function(t,e,o,i){const{list:n}=e,s="reverse"===t.__.flowWrap;let h,{x:a,y:c}=e;for(let r=0,l=n.length;r<l;r++)h=n[s?l-1-r:r],T(t,h,a,c,o,i),c+=h.height+e.gap}(t,u,p,e)):(I(t,y,h),T(t,y,0,y.y,p,e))}}const{move:V}=e.PointHelper;function $(t,e,o,i,n,s){const{children:h}=t;let a,c,{y:r,start:l}=e,_=o;r+=i;for(let t=0,i=e.count;t<i;t++)a=h[s?l-t:l+t],a.__.inFlow&&0!==a.__.visible?(c=a.__flowBounds,"from"!==n&&(_=o+(e.width-c.width)/("center"===n?2:1)),V(a,_-c.x,r-c.y),r+=c.height+e.gap):i++}const{move:tt}=e.PointHelper;function et(t,e){const o="height",{children:i,itemBox:n}=t,s=O(t,!1),{complex:h,wrap:a,xGap:c,yGap:r,isAutoYGap:l,isFitYGap:_}=s;if(!i.length)return;const u=a&&{x:0,y:0,width:0,height:0,gap:0,count:0,list:[]},p=l?0:r;let f,d,g,w,y,{x:x,y:b,width:G,height:B}=t.__layout.contentBounds;for(let s=0,c=i.length;s<c;s++)f=i[w=e?c-1-s:s],f.__.inFlow&&0!==f.__.visible&&(d=D(f,n),h?(f.__flowBounds=d,y||(y=M(w,p)),a&&y.count&&y.height+d.height>B&&(y.grow&&Z(t,y,B,e),l&&j(y,o,B,_),Y(u,y,o),y=M(w,p)),g=d.height,f.__heightGrow&&(y.grow+=f.__heightGrow,g=0,f.__.heightRange&&(y.hasRangeSize=!0)),f.__widthGrow&&U(f,d,G),y.height+=y.count?g+p:g,y.width=Math.max(y.width,d.width),y.count++):(tt(f,x-d.x,b-d.y),b+=d.height+p));if(h){const{isAutoXGap:i,isFitXGap:n,contentAlign:h,rowXAlign:r,rowYAlign:p}=s;y.count&&(y.grow&&Z(t,y,B,e),l&&j(y,o,B,_),a&&Y(u,y,o)),a?(i?j(u,"width",G,n):u.gap=c,function(t,e,o,i){I(t,e,o);const{list:n}=e;if(n.length>1&&(i||(i=C[o]),"from"!==i)){let t;for(let o=0,s=n.length;o<s;o++)t=n[o],t.y=e.height-t.height,"center"===i&&(t.y/=2)}}(t,u,h,p),function(t,e,o,i){const{list:n}=e,s="reverse"===t.__.flowWrap;let h,{x:a,y:c}=e;for(let r=0,l=n.length;r<l;r++)h=n[s?l-1-r:r],$(t,h,a,c,o,i),a+=h.width+e.gap}(t,u,r,e)):(I(t,y,h),$(t,y,y.x,0,r,e))}}function ot(t){return e.decorateLeafAttr(t,(t=>e.attr({set(o){const i="number"==typeof o?o:0;"autoWidth"===t?this.__widthGrow=i:this.__heightGrow=i,!i||this.parent&&this.parent.__hasGrow||this.waitParent((()=>{this.parent.__hasGrow=!0})),this.__setAttr(t,o)&&e.doBoundsType(this)}})))}const it=e.UI.prototype,nt=e.Box.prototype,{__updateBoxBounds:st}=e.Group.prototype;e.autoLayoutType(!1)(it,"flow"),e.boundsType(0)(it,"gap"),e.boundsType("top-left")(it,"flowAlign"),e.boundsType(!1)(it,"flowWrap"),e.boundsType("box")(it,"itemBox"),e.boundsType(!0)(it,"inFlow"),ot()(it,"autoWidth"),ot()(it,"autoHeight"),e.boundsType()(it,"lockRatio"),e.boundsType()(it,"autoBox"),e.boundsType()(it,"widthRange"),e.boundsType()(it,"heightRange");const{copyAndSpread:ht}=e.BoundsHelper;return nt.__updateFlowLayout=function(){const{leaferIsCreated:t,flow:e}=this;switch(t&&(this.leafer.created=!1),e){case"x":case!0:K(this);break;case"y":et(this);break;case"x-reverse":K(this,!0);break;case"y-reverse":et(this,!0)}t&&(this.leafer.created=!0)},nt.__updateContentBounds=function(){const{padding:t}=this.__,e=this.__layout,o=e.contentBounds===e.boxBounds;t?(o&&e.shrinkContent(),ht(e.contentBounds,e.boxBounds,t,!0)):o||e.shrinkContentCancel()},nt.__updateBoxBounds=function(t){const e=this.__;if(this.children.length){const{flow:o}=e;if(e.__autoSide){o&&!t?this.__updateRectBoxBounds():st.call(this);const{boxBounds:i}=this.__layout;e.__autoSize||(e.__autoWidth?(o||(i.width+=i.x,i.x=0),i.height=e.height,i.y=0):(o||(i.height+=i.y,i.y=0),i.width=e.width,i.x=0)),o&&t&&e.padding&&ht(i,i,e.padding,!1,e.__autoSize?null:e.__autoWidth?"width":"height"),this.__updateNaturalSize()}else this.__updateRectBoxBounds();o&&this.__updateContentBounds()}else this.__updateRectBoxBounds()},t.PathScaler=d,t.scaleResize=m,t.scaleResizeFontSize=z,t.scaleResizeGroup=F,t.scaleResizePath=A,t.scaleResizePoints=k,t}({},LeaferUI);
