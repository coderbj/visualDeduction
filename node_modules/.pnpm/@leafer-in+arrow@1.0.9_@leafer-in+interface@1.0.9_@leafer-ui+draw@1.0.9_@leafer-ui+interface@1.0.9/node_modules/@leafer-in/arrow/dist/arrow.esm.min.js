import{LineData as e,dataProcessor as t,strokeType as o,registerUI as r,Line as n,PathCommandMap as a,PointHelper as c,DataHelper as s,decorateLeafAttr as i,attr as p,doStrokeType as l,UI as f,PathArrow as u}from"@leafer-ui/draw";function h(e,t,o,r){var n,a=arguments.length,c=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(a<3?n(c):a>3?n(t,o,c):n(t,o))||c);return a>3&&c&&Object.defineProperty(t,o,c),c}"function"==typeof SuppressedError&&SuppressedError;class d extends e{}let b=class extends n{get __tag(){return"Arrow"}constructor(e){super(e),this.__.__useArrow=!0}};h([t(d)],b.prototype,"__",void 0),h([o("angle")],b.prototype,"endArrow",void 0),b=h([r()],b);const{M:_,L:x,C:k,Q:y,O:w}=a,{rotate:g,copyFrom:A,scale:J}=c,v={},m={layout(e,t,o,r,n,a,c){let s,i,p=0,l=e.length;for(;p<l;)switch(s=e[p],s){case _:case x:O(e,p+1,t,o,r,n,a,c),p+=3;break;case k:for(i=1;i<6;i+=2)O(e,p+i,t,o,r,n,a,c);p+=7;break;case y:for(i=1;i<4;i+=2)O(e,p+i,t,o,r,n,a,c);p+=5;break;case w:e[p+1]+=t,e[p+2]+=o,r&&(e[p+3]*=r),a&&(e[p+4]+=a,e[p+5]+=a),p+=7}},rotate(e,t,o){m.layout(e,0,0,1,1,t,o)}};function O(e,t,o,r,n,a,c,s){A(v,e[t],e[t+1]),c&&g(v,c,s),n&&J(v,n,a),e[t]=o+v.x,e[t+1]=r+v.y}const{layout:j,rotate:F}=m,{getAngle:R}=c,P={x:-.5},C={connect:P,offset:{x:-.71,bevelJoin:.36,roundJoin:.22},path:[1,-3,-3,2,0,0,2,-3,3]},D={connect:P,offset:{x:-1.207,bevelJoin:.854,roundJoin:.707},path:[1,-3,-3,2,0,0,2,-1,0]},q={connect:P,offset:{x:-.9,bevelJoin:.624,roundJoin:.4},path:[1,-3,0,2,-3,-2,2,0,0,2,-3,2,2,-3,0,1,-2.05,1.1,2,-2.05,-1.1]},E={connect:P,offset:{x:-1.1,bevelJoin:.872,roundJoin:.6},path:[1,-3,0,2,-3.5,-1.8,2,0,0,2,-3.5,1.8,2,-3,0,1,-2.25,.95,2,-2.25,-.95]},L={offset:P,path:[...q.path]};F(L.path,180,{x:-1.5,y:0});const M={connect:{x:-1.3},path:[1,1.8,-.1,2,1.8,0,26,0,0,1.8,0,359,0]},Q={connect:{x:.5},path:[...M.path,1,0,0,26,0,0,1,0,360,0]},S={connect:{x:-1.3},path:[1,-1.4,0,2,-1.4,-1.4,2,1.4,-1.4,2,1.4,1.4,2,-1.4,1.4,2,-1.4,0]},G={path:[...S.path,2,-1.4,-.49,2,1,-.49,1,-1.4,.49,2,1,.49]},N=s.clone(S),U=s.clone(G);F(N.path,45),F(U.path,45);const W={angle:C,"angle-side":D,arrow:E,triangle:q,"triangle-flip":L,circle:Q,"circle-line":M,square:G,"square-line":S,diamond:U,"diamond-line":N,mark:{offset:P,path:[1,0,-2,2,0,2]}};function X(e,t,o,r,n,a){const{strokeCap:c,strokeJoin:s}=e.__,{offset:i,connect:p,path:l}="object"==typeof t?t:W[t];let f=p?p.x:0,u=i?i.x:0;const h=[...l];return"none"!==c&&(f-=.5),i&&("round"===s&&i.roundJoin?u+=i.roundJoin:"bevel"===s&&i.bevelJoin&&(u+=i.bevelJoin)),u&&j(h,u,0),j(h,r.x,r.y,n,n,R(o,r)),a.x=(f+u)*n,h}const{M:Z,L:z,C:B,Q:H,Z:I,N:K,D:T,X:V,G:Y,F:$,O:ee,P:te,U:oe}=a,{copy:re,copyFrom:ne,getDistancePoint:ae}=c,ce={},se={},ie={},pe={},le={},fe={list:W,addArrows(e,t){const{startArrow:o,endArrow:r,strokeWidth:n,__pathForRender:a}=e.__;let c,s=0,i=a.length,p=0,l=o&&"none"!==o;for(;s<i;){switch(c=a[s],c){case Z:case z:(p<2||s+6>=i)&&(ne(le,a[s+1],a[s+2]),!p&&l&&re(se,le)),s+=3;break;case B:1!==p&&s+7!==i||ue(a,pe,le,s+3),s+=7;break;case H:1!==p&&s+5!==i||ue(a,pe,le,s+1),s+=5;break;case I:return;case K:s+=5;break;case T:s+=9;break;case V:s+=6;break;case Y:s+=9;break;case $:s+=5;break;case ee:s+=7;break;case te:s+=4;break;case oe:1!==p&&s+6!==i||ue(a,pe,le,s+1),s+=6}if(p++,1===p&&c!==Z)return;if(2===p&&l&&re(ie,c===z?le:pe),s===i){const i=e.__.__pathForRender=t?[...a]:a;if(l&&(i.push(...X(e,o,ie,se,n,ce)),ce.x&&(ae(se,ie,-ce.x,!0),i[1]=ie.x,i[2]=ie.y)),r&&"none"!==r&&(i.push(...X(e,r,pe,le,n,ce)),ce.x)){let e;switch(ae(le,pe,-ce.x,!0),c){case z:e=s-3+1;break;case B:e=s-7+5;break;case H:e=s-5+3;break;case oe:e=s-6+3}e&&he(i,pe,e)}}else re(pe,le)}}};function ue(e,t,o,r){ne(t,e[r],e[r+1]),ne(o,e[r+2],e[r+3])}function he(e,t,o){e[o]=t.x,e[o+1]=t.y}function de(e){return i(e,(e=>p({set(t){if(this.__setAttr(e,t)){const e=this.__;e.__useArrow="none"!==e.startArrow||"none"!==e.endArrow,l(this)}}})))}const be=f.prototype;de("none")(be,"startArrow"),de("none")(be,"endArrow"),Object.assign(u,fe);export{b as Arrow,d as ArrowData,fe as PathArrowModule,m as PathMatrixHelper,de as arrowType};
