const t={toURL(t,e){let s=encodeURIComponent(t);return"text"===e?s="data:text/plain;charset=utf-8,"+s:"svg"===e&&(s="data:image/svg+xml,"+s),s},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",getRealURL(e){const{prefix:s,suffix:r}=t.image;return!r||e.startsWith("data:")||e.startsWith("blob:")||(e+=(e.includes("?")?"&":"?")+r),s&&"/"===e[0]&&(e=s+e),e}}},e={},s={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(t){const{types:e}=r;return e[t]?e[t]++:(e[t]=1,0)}},r=s,{round:i,pow:n,PI:o}=Math,a={within:(t,e,s)=>("object"==typeof e&&(s=e.max,e=e.min),void 0!==e&&t<e&&(t=e),void 0!==s&&t>s&&(t=s),t),fourNumber(t,e){let s;if(t instanceof Array)switch(t.length){case 4:s=void 0===e?t:[...t];break;case 2:s=[t[0],t[1],t[0],t[1]];break;case 3:s=[t[0],t[1],t[2],t[1]];break;case 1:t=t[0];break;default:t=0}if(s||(s=[t,t,t,t]),e)for(let t=0;t<4;t++)s[t]>e&&(s[t]=e);return s},formatRotation:(t,e)=>(t%=360,e?t<0&&(t+=360):(t>180&&(t-=360),t<-180&&(t+=360)),a.float(t)),getGapRotation(t,e,s=0){let r=t+s;if(e>1){const t=Math.abs(r%e);(t<1||t>e-1)&&(r=Math.round(r/e)*e)}return r-s},float(t,e){const s=e?n(10,e):1e12;return-0===(t=i(t*s)/s)?0:t},getScaleData:(t,e,s,r)=>(r||(r={}),e?(r.scaleX=("number"==typeof e?e:e.width)/s.width,r.scaleY=("number"==typeof e?e:e.height)/s.height):t&&a.assignScale(r,t),r),assignScale(t,e){"number"==typeof e?t.scaleX=t.scaleY=e:(t.scaleX=e.x,t.scaleY=e.y)}},h=o/180,l=2*o,d=o/2;function u(){return{x:0,y:0}}function c(){return{x:0,y:0,width:0,height:0}}function _(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:p,cos:f,acos:g,sqrt:y}=Math,{float:m}=a,x={};function w(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const b={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:w(),tempMatrix:{},set(t,e=1,s=0,r=0,i=1,n=0,o=0){t.a=e,t.b=s,t.c=r,t.d=i,t.e=n,t.f=o},get:_,getWorld:w,copy(t,e){t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.e=e.e,t.f=e.f},translate(t,e,s){t.e+=e,t.f+=s},translateInner(t,e,s,r){t.e+=t.a*e+t.c*s,t.f+=t.b*e+t.d*s,r&&(t.e-=e,t.f-=s)},scale(t,e,s=e){t.a*=e,t.b*=e,t.c*=s,t.d*=s},scaleOfOuter(t,e,s,r){v.toInnerPoint(t,e,x),v.scaleOfInner(t,x,s,r)},scaleOfInner(t,e,s,r=s){v.translateInner(t,e.x,e.y),v.scale(t,s,r),v.translateInner(t,-e.x,-e.y)},rotate(t,e){const{a:s,b:r,c:i,d:n}=t,o=f(e*=h),a=p(e);t.a=s*o-r*a,t.b=s*a+r*o,t.c=i*o-n*a,t.d=i*a+n*o},rotateOfOuter(t,e,s){v.toInnerPoint(t,e,x),v.rotateOfInner(t,x,s)},rotateOfInner(t,e,s){v.translateInner(t,e.x,e.y),v.rotate(t,s),v.translateInner(t,-e.x,-e.y)},skew(t,e,s){const{a:r,b:i,c:n,d:o}=t;s&&(s*=h,t.a=r+n*s,t.b=i+o*s),e&&(e*=h,t.c=n+r*e,t.d=o+i*e)},skewOfOuter(t,e,s,r){v.toInnerPoint(t,e,x),v.skewOfInner(t,x,s,r)},skewOfInner(t,e,s,r=0){v.translateInner(t,e.x,e.y),v.skew(t,s,r),v.translateInner(t,-e.x,-e.y)},multiply(t,e){const{a:s,b:r,c:i,d:n,e:o,f:a}=t;t.a=e.a*s+e.b*i,t.b=e.a*r+e.b*n,t.c=e.c*s+e.d*i,t.d=e.c*r+e.d*n,t.e=e.e*s+e.f*i+o,t.f=e.e*r+e.f*n+a},multiplyParent(t,e,s,r,i,n){let{e:o,f:a}=t;if(n&&(o+=n.scrollX,a+=n.scrollY),s||(s=t),void 0===r&&(r=1!==t.a||t.b||t.c||1!==t.d),r){const{a:r,b:n,c:o,d:a}=t;s.a=r*e.a+n*e.c,s.b=r*e.b+n*e.d,s.c=o*e.a+a*e.c,s.d=o*e.b+a*e.d,i&&(s.scaleX=e.scaleX*i.scaleX,s.scaleY=e.scaleY*i.scaleY)}else s.a=e.a,s.b=e.b,s.c=e.c,s.d=e.d,i&&(s.scaleX=e.scaleX,s.scaleY=e.scaleY);s.e=o*e.a+a*e.c+e.e,s.f=o*e.b+a*e.d+e.f},divide(t,e){v.multiply(t,v.tempInvert(e))},divideParent(t,e){v.multiplyParent(t,v.tempInvert(e))},tempInvert(t){const{tempMatrix:e}=v;return v.copy(e,t),v.invert(e),e},invert(t){const{a:e,b:s,c:r,d:i,e:n,f:o}=t;if(s||r){const a=1/(e*i-s*r);t.a=i*a,t.b=-s*a,t.c=-r*a,t.d=e*a,t.e=-(n*i-o*r)*a,t.f=-(o*e-n*s)*a}else if(1===e&&1===i)t.e=-n,t.f=-o;else{const s=1/(e*i);t.a=i*s,t.d=e*s,t.e=-n*i*s,t.f=-o*e*s}},toOuterPoint(t,e,s,r){const{x:i,y:n}=e;s||(s=e),s.x=i*t.a+n*t.c,s.y=i*t.b+n*t.d,r||(s.x+=t.e,s.y+=t.f)},toInnerPoint(t,e,s,r){const{a:i,b:n,c:o,d:a}=t,h=1/(i*a-n*o),{x:l,y:d}=e;if(s||(s=e),s.x=(l*a-d*o)*h,s.y=(d*i-l*n)*h,!r){const{e:e,f:r}=t;s.x-=(e*a-r*o)*h,s.y-=(r*i-e*n)*h}},setLayout(t,e,s,r,i){const{x:n,y:o,scaleX:a,scaleY:l}=e;if(void 0===i&&(i=e.rotation||e.skewX||e.skewY),i){const{rotation:s,skewX:r,skewY:i}=e,n=s*h,o=f(n),d=p(n);if(r||i){const e=r*h,s=i*h;t.a=(o+s*-d)*a,t.b=(d+s*o)*a,t.c=(e*o-d)*l,t.d=(o+e*d)*l}else t.a=o*a,t.b=d*a,t.c=-d*l,t.d=o*l}else t.a=a,t.b=0,t.c=0,t.d=l;t.e=n,t.f=o,(s=s||r)&&v.translateInner(t,-s.x,-s.y,!r)},getLayout(t,e,s,r){const{a:i,b:n,c:o,d:a,e:l,f:u}=t;let c,_,x,w,b,v=l,B=u;if(n||o){const t=i*a-n*o;if(o&&!r){c=y(i*i+n*n),_=t/c;const e=i/c;x=n>0?g(e):-g(e)}else{_=y(o*o+a*a),c=t/_;const e=o/_;x=d-(a>0?g(-e):-g(e))}const e=m(f(x)),s=p(x);c=m(c),_=m(_),w=e?m((o/_+s)/e/h,9):0,b=e?m((n/c-s)/e/h,9):0,x=m(x/h)}else c=i,_=a,x=w=b=0;return(e=s||e)&&(v+=e.x*i+e.y*o,B+=e.x*n+e.y*a,s||(v-=e.x,B-=e.y)),{x:v,y:B,scaleX:c,scaleY:_,rotation:x,skewX:w,skewY:b}},withScale(t,e,s=e){const r=t;if(!e||!s){const{a:r,b:i,c:n,d:o}=t;i||n?s=(r*o-i*n)/(e=y(r*r+i*i)):(e=r,s=o)}return r.scaleX=e,r.scaleY=s,r},reset(t){v.set(t)}},v=b,{toInnerPoint:B,toOuterPoint:k}=b,{sin:C,cos:O,abs:T,sqrt:P,atan2:R,min:S,PI:L}=Math,E={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(t,e=0,s=0){t.x=e,t.y=s},setRadius(t,e,s){t.radiusX=e,t.radiusY=void 0===s?e:s},copy(t,e){t.x=e.x,t.y=e.y},copyFrom(t,e,s){t.x=e,t.y=s},move(t,e,s){t.x+=e,t.y+=s},scale(t,e,s=e){t.x&&(t.x*=e),t.y&&(t.y*=s)},scaleOf(t,e,s,r=s){t.x+=(t.x-e.x)*(s-1),t.y+=(t.y-e.y)*(r-1)},rotate(t,e,s){s||(s=I.defaultPoint);const r=O(e*=h),i=C(e),n=t.x-s.x,o=t.y-s.y;t.x=s.x+n*r-o*i,t.y=s.y+n*i+o*r},tempToInnerOf(t,e){const{tempPoint:s}=I;return A(s,t),B(e,s,s),s},tempToOuterOf(t,e){const{tempPoint:s}=I;return A(s,t),k(e,s,s),s},tempToInnerRadiusPointOf(t,e){const{tempRadiusPoint:s}=I;return A(s,t),I.toInnerRadiusPointOf(t,e,s),s},toInnerRadiusPointOf(t,e,s){s||(s=t),B(e,t,s),s.radiusX=Math.abs(t.radiusX/e.scaleX),s.radiusY=Math.abs(t.radiusY/e.scaleY)},toInnerOf(t,e,s){B(e,t,s)},toOuterOf(t,e,s){k(e,t,s)},getCenter:(t,e)=>({x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}),getCenterX:(t,e)=>t+(e-t)/2,getCenterY:(t,e)=>t+(e-t)/2,getDistance:(t,e)=>M(t.x,t.y,e.x,e.y),getDistanceFrom(t,e,s,r){const i=T(s-t),n=T(r-e);return P(i*i+n*n)},getMinDistanceFrom:(t,e,s,r,i,n)=>S(M(t,e,s,r),M(s,r,i,n)),getAngle:(t,e)=>W(t,e)/h,getRotation:(t,e,s,r)=>(r||(r=e),I.getRadianFrom(t.x,t.y,e.x,e.y,s.x,s.y,r.x,r.y)/h),getRadianFrom(t,e,s,r,i,n,o,a){void 0===o&&(o=s,a=r);let h=R(e-r,t-s);const d=R(n-a,i-o)-h;return d<-L?d+l:d},getAtan2:(t,e)=>R(e.y-t.y,e.x-t.x),getDistancePoint(t,e,s,r){const i=W(t,e);return(e=r?e:{}).x=t.x+O(i)*s,e.y=t.y+C(i)*s,e},toNumberPoints(t){let e=t;return"object"==typeof t[0]&&(e=[],t.forEach((t=>e.push(t.x,t.y)))),e},reset(t){I.reset(t)}},I=E,{getDistanceFrom:M,copy:A,getAtan2:W}=I;class N{constructor(t,e){this.set(t,e)}set(t,e){return"object"==typeof t?E.copy(this,t):E.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new N(this)}move(t,e){return E.move(this,t,e),this}scale(t,e){return E.scale(this,t,e),this}scaleOf(t,e,s){return E.scaleOf(this,t,e,s),this}rotate(t,e){return E.rotate(this,t,e),this}rotateOf(t,e){return E.rotate(this,e,t),this}getRotation(t,e,s){return E.getRotation(this,t,e,s)}toInnerOf(t,e){return E.toInnerOf(this,t,e),this}toOuterOf(t,e){return E.toOuterOf(this,t,e),this}getCenter(t){return new N(E.getCenter(this,t))}getDistance(t){return E.getDistance(this,t)}getDistancePoint(t,e,s){return new N(E.getDistancePoint(this,t,e,s))}getAngle(t){return E.getAngle(this,t)}getAtan2(t){return E.getAtan2(this,t)}reset(){return E.reset(this),this}}const Y=new N;class D{constructor(t,e,s,r,i,n){this.set(t,e,s,r,i,n)}set(t,e,s,r,i,n){return"object"==typeof t?b.copy(this,t):b.set(this,t,e,s,r,i,n),this}setWith(t){return b.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:s,d:r,e:i,f:n}=this;return{a:t,b:e,c:s,d:r,e:i,f:n}}clone(){return new D(this)}translate(t,e){return b.translate(this,t,e),this}translateInner(t,e){return b.translateInner(this,t,e),this}scale(t,e){return b.scale(this,t,e),this}scaleWith(t,e){return b.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,s){return b.scaleOfOuter(this,t,e,s),this}scaleOfInner(t,e,s){return b.scaleOfInner(this,t,e,s),this}rotate(t){return b.rotate(this,t),this}rotateOfOuter(t,e){return b.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return b.rotateOfInner(this,t,e),this}skew(t,e){return b.skew(this,t,e),this}skewOfOuter(t,e,s){return b.skewOfOuter(this,t,e,s),this}skewOfInner(t,e,s){return b.skewOfInner(this,t,e,s),this}multiply(t){return b.multiply(this,t),this}multiplyParent(t){return b.multiplyParent(this,t),this}divide(t){return b.divide(this,t),this}divideParent(t){return b.divideParent(this,t),this}invert(){return b.invert(this),this}invertWith(){return b.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,s){b.toOuterPoint(this,t,e,s)}toInnerPoint(t,e,s){b.toInnerPoint(this,t,e,s)}setLayout(t,e,s){return b.setLayout(this,t,e,s),this}getLayout(t,e,s){return b.getLayout(this,t,e,s)}withScale(t,e){return b.withScale(this,t,e)}reset(){b.reset(this)}}const X=new D,z={tempPointBounds:{},setPoint(t,e,s){t.minX=t.maxX=e,t.minY=t.maxY=s},addPoint(t,e,s){t.minX=e<t.minX?e:t.minX,t.minY=s<t.minY?s:t.minY,t.maxX=e>t.maxX?e:t.maxX,t.maxY=s>t.maxY?s:t.maxY},addBounds(t,e,s,r,i){F(t,e,s),F(t,e+r,s+i)},copy(t,e){t.minX=e.minX,t.minY=e.minY,t.maxX=e.maxX,t.maxY=e.maxY},addPointBounds(t,e){t.minX=e.minX<t.minX?e.minX:t.minX,t.minY=e.minY<t.minY?e.minY:t.minY,t.maxX=e.maxX>t.maxX?e.maxX:t.maxX,t.maxY=e.maxY>t.maxY?e.maxY:t.maxY},toBounds(t,e){e.x=t.minX,e.y=t.minY,e.width=t.maxX-t.minX,e.height=t.maxY-t.minY}},{addPoint:F}=z,{tempPointBounds:j,setPoint:U,addPoint:G,toBounds:H}=z,{toOuterPoint:q}=b,{float:V,fourNumber:Q}=a,{floor:Z,ceil:J}=Math;let $,K,tt,et;const st={},rt={},it={tempBounds:{},set(t,e=0,s=0,r=0,i=0){t.x=e,t.y=s,t.width=r,t.height=i},copy(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},copyAndSpread(t,e,s,r,i){const{x:n,y:o,width:a,height:h}=e;if(s instanceof Array){const e=Q(s);r?nt.set(t,n+e[3],o+e[0],a-e[1]-e[3],h-e[2]-e[0]):nt.set(t,n-e[3],o-e[0],a+e[1]+e[3],h+e[2]+e[0])}else r&&(s=-s),nt.set(t,n-s,o-s,a+2*s,h+2*s);i&&("width"===i?(t.y=o,t.height=h):(t.x=n,t.width=a))},minX:t=>t.width>0?t.x:t.x+t.width,minY:t=>t.height>0?t.y:t.y+t.height,maxX:t=>t.width>0?t.x+t.width:t.x,maxY:t=>t.height>0?t.y+t.height:t.y,move(t,e,s){t.x+=e,t.y+=s},getByMove:(t,e,s)=>(t=Object.assign({},t),nt.move(t,e,s),t),toOffsetOutBounds(t,e,s){e?at(e,t):e=t,s?(e.offsetX=-(nt.maxX(s)-t.x),e.offsetY=-(nt.maxY(s)-t.y)):(e.offsetX=t.x+t.width,e.offsetY=t.y+t.height),nt.move(e,-e.offsetX,-e.offsetY)},scale(t,e,s=e){E.scale(t,e,s),t.width*=e,t.height*=s},scaleOf(t,e,s,r=s){E.scaleOf(t,e,s,r),t.width*=s,t.height*=r},tempToOuterOf:(t,e)=>(nt.copy(nt.tempBounds,t),nt.toOuterOf(nt.tempBounds,e),nt.tempBounds),getOuterOf:(t,e)=>(t=Object.assign({},t),nt.toOuterOf(t,e),t),toOuterOf(t,e,s){if(s||(s=t),0===e.b&&0===e.c){const{a:r,d:i}=e;r>0?(s.width=t.width*r,s.x=e.e+t.x*r):(s.width=t.width*-r,s.x=e.e+t.x*r-s.width),i>0?(s.height=t.height*i,s.y=e.f+t.y*i):(s.height=t.height*-i,s.y=e.f+t.y*i-s.height)}else st.x=t.x,st.y=t.y,q(e,st,rt),U(j,rt.x,rt.y),st.x=t.x+t.width,q(e,st,rt),G(j,rt.x,rt.y),st.y=t.y+t.height,q(e,st,rt),G(j,rt.x,rt.y),st.x=t.x,q(e,st,rt),G(j,rt.x,rt.y),H(j,s)},toInnerOf(t,e,s){s||(s=t),nt.move(s,-e.e,-e.f),nt.scale(s,1/e.a,1/e.d)},getFitMatrix(t,e,s=1){const r=Math.min(s,Math.min(t.width/e.width,t.height/e.height));return new D(r,0,0,r,-e.x*r,-e.y*r)},getSpread(t,e,s){const r={};return nt.copyAndSpread(r,t,e,!1,s),r},spread(t,e,s){nt.copyAndSpread(t,t,e,!1,s)},shrink(t,e,s){nt.copyAndSpread(t,t,e,!0,s)},ceil(t){const{x:e,y:s}=t;t.x=Z(t.x),t.y=Z(t.y),t.width=e>t.x?J(t.width+e-t.x):J(t.width),t.height=s>t.y?J(t.height+s-t.y):J(t.height)},unsign(t){t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height)},float(t,e){t.x=V(t.x,e),t.y=V(t.y,e),t.width=V(t.width,e),t.height=V(t.height,e)},add(t,e,s){$=t.x+t.width,K=t.y+t.height,tt=e.x,et=e.y,s||(tt+=e.width,et+=e.height),$=$>tt?$:tt,K=K>et?K:et,t.x=t.x<e.x?t.x:e.x,t.y=t.y<e.y?t.y:e.y,t.width=$-t.x,t.height=K-t.y},addList(t,e){nt.setListWithFn(t,e,void 0,!0)},setList(t,e,s=!1){nt.setListWithFn(t,e,void 0,s)},addListWithFn(t,e,s){nt.setListWithFn(t,e,s,!0)},setListWithFn(t,e,s,r=!1){let i,n=!0;for(let o=0,a=e.length;o<a;o++)i=s?s(e[o]):e[o],i&&(i.width||i.height)&&(n?(n=!1,r||at(t,i)):ot(t,i));n&&nt.reset(t)},setPoints(t,e){e.forEach(((t,e)=>0===e?U(j,t.x,t.y):G(j,t.x,t.y))),H(j,t)},setPoint(t,e){nt.set(t,e.x,e.y)},addPoint(t,e){ot(t,e,!0)},getPoints(t){const{x:e,y:s,width:r,height:i}=t;return[{x:e,y:s},{x:e+r,y:s},{x:e+r,y:s+i},{x:e,y:s+i}]},hitRadiusPoint:(t,e,s)=>(s&&(e=E.tempToInnerRadiusPointOf(e,s)),e.x>=t.x-e.radiusX&&e.x<=t.x+t.width+e.radiusX&&e.y>=t.y-e.radiusY&&e.y<=t.y+t.height+e.radiusY),hitPoint:(t,e,s)=>(s&&(e=E.tempToInnerOf(e,s)),e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height),hit:(t,e,s)=>(s&&(e=nt.tempToOuterOf(e,s)),!(t.y+t.height<e.y||e.y+e.height<t.y||t.x+t.width<e.x||e.x+e.width<t.x)),includes:(t,e,s)=>(s&&(e=nt.tempToOuterOf(e,s)),t.x<=e.x&&t.y<=e.y&&t.x+t.width>=e.x+e.width&&t.y+t.height>=e.y+e.height),getIntersectData(t,e,s){if(s&&(e=nt.tempToOuterOf(e,s)),!nt.hit(t,e))return{x:0,y:0,width:0,height:0};let{x:r,y:i,width:n,height:o}=e;return $=r+n,K=i+o,tt=t.x+t.width,et=t.y+t.height,r=r>t.x?r:t.x,i=i>t.y?i:t.y,$=$<tt?$:tt,K=K<et?K:et,n=$-r,o=K-i,{x:r,y:i,width:n,height:o}},intersect(t,e,s){nt.copy(t,nt.getIntersectData(t,e,s))},isSame:(t,e)=>t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height,isEmpty:t=>0===t.x&&0===t.y&&0===t.width&&0===t.height,reset(t){nt.set(t)}},nt=it,{add:ot,copy:at}=nt;class ht{get minX(){return it.minX(this)}get minY(){return it.minY(this)}get maxX(){return it.maxX(this)}get maxY(){return it.maxY(this)}constructor(t,e,s,r){this.set(t,e,s,r)}set(t,e,s,r){return"object"==typeof t?it.copy(this,t):it.set(this,t,e,s,r),this}get(){const{x:t,y:e,width:s,height:r}=this;return{x:t,y:e,width:s,height:r}}clone(){return new ht(this)}move(t,e){return it.move(this,t,e),this}scale(t,e){return it.scale(this,t,e),this}scaleOf(t,e,s){return it.scaleOf(this,t,e,s),this}toOuterOf(t,e){return it.toOuterOf(this,t,e),this}toInnerOf(t,e){return it.toInnerOf(this,t,e),this}getFitMatrix(t,e){return it.getFitMatrix(this,t,e)}spread(t,e){return it.spread(this,t,e),this}shrink(t,e){return it.shrink(this,t,e),this}ceil(){return it.ceil(this),this}unsign(){return it.unsign(this),this}float(t){return it.float(this,t),this}add(t){return it.add(this,t),this}addList(t){return it.setList(this,t,!0),this}setList(t){return it.setList(this,t),this}addListWithFn(t,e){return it.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return it.setListWithFn(this,t,e),this}setPoint(t){return it.setPoint(this,t),this}setPoints(t){return it.setPoints(this,t),this}addPoint(t){return it.addPoint(this,t),this}getPoints(){return it.getPoints(this)}hitPoint(t,e){return it.hitPoint(this,t,e)}hitRadiusPoint(t,e){return it.hitRadiusPoint(this,t,e)}hit(t,e){return it.hit(this,t,e)}includes(t,e){return it.includes(this,t,e)}intersect(t,e){return it.intersect(this,t,e),this}getIntersect(t,e){return new ht(it.getIntersectData(this,t,e))}isSame(t){return it.isSame(this,t)}isEmpty(){return it.isEmpty(this)}reset(){it.reset(this)}}const lt=new ht;class dt{constructor(t,e,s,r,i,n){"object"==typeof t?this.copy(t):this.set(t,e,s,r,i,n)}set(t=0,e=0,s=0,r=0,i=0,n=0){this.top=t,this.right=e,this.bottom=s,this.left=r,this.width=i,this.height=n}copy(t){const{top:e,right:s,bottom:r,left:i,width:n,height:o}=t;this.set(e,s,r,i,n,o)}getBoundsFrom(t){const{top:e,right:s,bottom:r,left:i,width:n,height:o}=this;return new ht(i,e,n||t.width-i-s,o||t.height-e-r)}}var ut,ct;!function(t){t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left"}(ut||(ut={})),function(t){t[t.topLeft=0]="topLeft",t[t.top=1]="top",t[t.topRight=2]="topRight",t[t.right=3]="right",t[t.bottomRight=4]="bottomRight",t[t.bottom=5]="bottom",t[t.bottomLeft=6]="bottomLeft",t[t.left=7]="left",t[t.center=8]="center",t[t["top-left"]=0]="top-left",t[t["top-right"]=2]="top-right",t[t["bottom-right"]=4]="bottom-right",t[t["bottom-left"]=6]="bottom-left"}(ct||(ct={}));const _t=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];_t.forEach((t=>t.type="percent"));const pt={directionData:_t,tempPoint:{},get:ft,toPoint(t,e,s,r,i){const n=ft(t);s.x=n.x,s.y=n.y,"percent"===n.type&&(s.x*=e.width,s.y*=e.height,i&&(s.x-=i.x,s.y-=i.y,n.x&&(s.x-=1===n.x?i.width:.5===n.x?n.x*i.width:0),n.y&&(s.y-=1===n.y?i.height:.5===n.y?n.y*i.height:0))),r||(s.x+=e.x,s.y+=e.y)}};function ft(t){return"string"==typeof t?_t[ct[t]]:t}const{toPoint:gt}=pt,yt={toPoint(t,e,s,r,i){gt(t,s,r,i,e)}},mt={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class xt{constructor(t){this.repeatMap={},this.name=t}static get(t){return new xt(t)}static set filter(t){this.filterList=wt(t)}static set exclude(t){this.excludeList=wt(t)}log(...t){if(bt.enable){if(bt.filterList.length&&bt.filterList.every((t=>t!==this.name)))return;if(bt.excludeList.length&&bt.excludeList.some((t=>t===this.name)))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){bt.enable&&this.warn(...t)}warn(...t){bt.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}function wt(t){return t?"string"==typeof t&&(t=[t]):t=[],t}xt.filterList=[],xt.excludeList=[],xt.showWarn=!0;const bt=xt,vt=xt.get("RunTime"),Bt={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(t,e){const r=s.create(s.RUNTIME);return kt.currentId=kt.idMap[r]=e?performance.now():Date.now(),kt.currentName=kt.nameMap[r]=t,kt.nameToIdMap[t]=r,r},end(t,e){const s=kt.idMap[t],r=kt.nameMap[t],i=e?(performance.now()-s)/1e3:Date.now()-s;kt.idMap[t]=kt.nameMap[t]=kt.nameToIdMap[r]=void 0,vt.log(r,i,"ms")},endOfName(t,e){const s=kt.nameToIdMap[t];void 0!==s&&kt.end(s,e)}},kt=Bt;function Ct(t){console.error("need plugin: @leafer-in/"+t)}const Ot=xt.get("UICreator"),Tt={list:{},register(t){const{__tag:e}=t.prototype;Pt[e]&&Ot.repeat(e),Pt[e]=t},get(t,e,s,r,i,n){Pt[t]||Ot.error("not register "+t);const o=new Pt[t](e);return void 0!==s&&(o.x=s,r&&(o.y=r),i&&(o.width=i),n&&(o.height=n)),o}},{list:Pt}=Tt,Rt=xt.get("EventCreator"),St={nameList:{},register(t){let e;Object.keys(t).forEach((s=>{e=t[s],"string"==typeof e&&(Lt[e]&&Rt.repeat(e),Lt[e]=t)}))},changeName(t,e){const s=Lt[t];if(s){const r=Object.keys(s).find((e=>s[e]===t));r&&(s[r]=e,Lt[e]=s)}},has(t){return!!this.nameList[t]},get:(t,...e)=>new Lt[t](...e)},{nameList:Lt}=St;class Et{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let s;const{list:r}=this;for(let e=0,i=r.length;e<i;e++)if(s=r[e],s.recycled&&s.isSameSize(t))return s.recycled=!1,s.manager||(s.manager=this),s;const i=e.canvas(t);return this.add(i),i}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let s=0,r=this.list.length;s<r;s++)t=this.list[s],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach((t=>{t.destroy()})),this.list.length=0}destroy(){this.clear()}}const It={default:(t,e)=>(Mt(e,t),Mt(t,e),t),assign(t,e){let s;Object.keys(e).forEach((r=>{var i;s=e[r],(null==s?void 0:s.constructor)===Object&&(null===(i=t[r])||void 0===i?void 0:i.constructor)===Object?Mt(t[r],e[r]):t[r]=e[r]}))},copyAttrs:(t,e,s)=>(s.forEach((s=>{void 0!==e[s]&&(t[s]=e[s])})),t),clone:t=>JSON.parse(JSON.stringify(t)),toMap(t){const e={};for(let s=0,r=t.length;s<r;s++)e[t[s]]=!0;return e}},{assign:Mt}=It;class At{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&6===t.length&&1===t[0]}get __blendMode(){if(this.eraser&&"path"!==this.eraser)return"destination-out";const{blendMode:t}=this;return"pass-through"===t?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let s;for(let r in this)"_"!==r[0]&&(s=e?e[r]:void 0,t[r]=void 0===s?this[r]:s);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}if("path"!==t||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&void 0!==this.__input[t]&&(this.__input[t]=void 0)}__getInputData(t,e){const s={};if(t)if(t instanceof Array)for(let e of t)s[e]=this.__getInput(e);else for(let e in t)s[e]=this.__getInput(e);else{let t,e,{__input:r}=this;s.tag=this.__leaf.tag;for(let i in this)if("_"!==i[0]&&(t=this["_"+i],void 0!==t)){if("path"===i&&!this.__pathInputed)continue;e=r?r[i]:void 0,s[i]=void 0===e?t:e}}if(e&&e.matrix){const{a:t,b:e,c:r,d:i,e:n,f:o}=this.__leaf.__localMatrix;s.matrix={a:t,b:e,c:r,d:i,e:n,f:o}}return s}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if("pass-through"===t.blendMode){const e=this.__leaf;t.opacity<1&&(e.isBranch||t.__hasMultiPaint)||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var Wt;!function(t){t[t.No=0]="No",t[t.Yes=1]="Yes",t[t.NoAndSkip=2]="NoAndSkip",t[t.YesAndSkip=3]="YesAndSkip"}(Wt||(Wt={}));const Nt={};function Yt(t){return null==t}function Dt(t,e,s,r){var i,n=arguments.length,o=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,s,r);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(n<3?i(o):n>3?i(e,s,o):i(e,s))||o);return n>3&&o&&Object.defineProperty(e,s,o),o}function Xt(t,e,s,r){return new(s||(s=Promise))((function(i,n){function o(t){try{h(r.next(t))}catch(t){n(t)}}function a(t){try{h(r.throw(t))}catch(t){n(t)}}function h(t){var e;t.done?i(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,a)}h((r=r.apply(t,e||[])).next())}))}function zt(t){return(e,s)=>{t||(t=s),Object.defineProperty(e,s,{get(){return this.context[t]},set(e){this.context[t]=e}})}}"function"==typeof SuppressedError&&SuppressedError;const Ft=[];function jt(){return(t,e)=>{Ft.push(e)}}const Ut=[];class Gt{set blendMode(t){"normal"===t&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||Ut)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;Ft.forEach((e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))})),this.textBaseline="alphabetic"}setTransform(t,e,s,r,i,n){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,s,r,i,n){"object"==typeof t?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,s,r,i,n)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,s,r){}strokeRect(t,e,s,r){}clearRect(t,e,s,r){}drawImage(t,e,s,r,i,n,o,a,h){switch(arguments.length){case 9:if(e<0){const t=-e/r*a;r+=e,e=0,n+=t,a-=t}if(s<0){const t=-s/i*h;i+=s,s=0,o+=t,h-=t}this.context.drawImage(t,e,s,r,i,n,o,a,h);break;case 5:this.context.drawImage(t,e,s,r,i);break;case 3:this.context.drawImage(t,e,s)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,s,r,i,n){}quadraticCurveTo(t,e,s,r){}closePath(){}arc(t,e,s,r,i,n){}arcTo(t,e,s,r,i){}ellipse(t,e,s,r,i,n,o,a){}rect(t,e,s,r){}roundRect(t,e,s,r,i){}createConicGradient(t,e,s){}createLinearGradient(t,e,s,r){}createPattern(t,e){}createRadialGradient(t,e,s,r,i,n){}fillText(t,e,s,r){}measureText(t){}strokeText(t,e,s,r){}destroy(){this.context=null}}Dt([zt("imageSmoothingEnabled")],Gt.prototype,"smooth",void 0),Dt([zt("imageSmoothingQuality")],Gt.prototype,"smoothLevel",void 0),Dt([zt("globalAlpha")],Gt.prototype,"opacity",void 0),Dt([zt()],Gt.prototype,"fillStyle",void 0),Dt([zt()],Gt.prototype,"strokeStyle",void 0),Dt([zt("lineWidth")],Gt.prototype,"strokeWidth",void 0),Dt([zt("lineCap")],Gt.prototype,"strokeCap",void 0),Dt([zt("lineJoin")],Gt.prototype,"strokeJoin",void 0),Dt([zt("lineDashOffset")],Gt.prototype,"dashOffset",void 0),Dt([zt()],Gt.prototype,"miterLimit",void 0),Dt([zt()],Gt.prototype,"shadowBlur",void 0),Dt([zt()],Gt.prototype,"shadowColor",void 0),Dt([zt()],Gt.prototype,"shadowOffsetX",void 0),Dt([zt()],Gt.prototype,"shadowOffsetY",void 0),Dt([zt()],Gt.prototype,"filter",void 0),Dt([zt()],Gt.prototype,"font",void 0),Dt([zt()],Gt.prototype,"fontKerning",void 0),Dt([zt()],Gt.prototype,"fontStretch",void 0),Dt([zt()],Gt.prototype,"fontVariantCaps",void 0),Dt([zt()],Gt.prototype,"textAlign",void 0),Dt([zt()],Gt.prototype,"textBaseline",void 0),Dt([zt()],Gt.prototype,"textRendering",void 0),Dt([zt()],Gt.prototype,"wordSpacing",void 0),Dt([zt()],Gt.prototype,"letterSpacing",void 0),Dt([zt()],Gt.prototype,"direction",void 0),Dt([jt()],Gt.prototype,"setTransform",null),Dt([jt()],Gt.prototype,"resetTransform",null),Dt([jt()],Gt.prototype,"getTransform",null),Dt([jt()],Gt.prototype,"save",null),Dt([jt()],Gt.prototype,"restore",null),Dt([jt()],Gt.prototype,"translate",null),Dt([jt()],Gt.prototype,"scale",null),Dt([jt()],Gt.prototype,"rotate",null),Dt([jt()],Gt.prototype,"fill",null),Dt([jt()],Gt.prototype,"stroke",null),Dt([jt()],Gt.prototype,"clip",null),Dt([jt()],Gt.prototype,"fillRect",null),Dt([jt()],Gt.prototype,"strokeRect",null),Dt([jt()],Gt.prototype,"clearRect",null),Dt([jt()],Gt.prototype,"beginPath",null),Dt([jt()],Gt.prototype,"moveTo",null),Dt([jt()],Gt.prototype,"lineTo",null),Dt([jt()],Gt.prototype,"bezierCurveTo",null),Dt([jt()],Gt.prototype,"quadraticCurveTo",null),Dt([jt()],Gt.prototype,"closePath",null),Dt([jt()],Gt.prototype,"arc",null),Dt([jt()],Gt.prototype,"arcTo",null),Dt([jt()],Gt.prototype,"ellipse",null),Dt([jt()],Gt.prototype,"rect",null),Dt([jt()],Gt.prototype,"roundRect",null),Dt([jt()],Gt.prototype,"createConicGradient",null),Dt([jt()],Gt.prototype,"createLinearGradient",null),Dt([jt()],Gt.prototype,"createPattern",null),Dt([jt()],Gt.prototype,"createRadialGradient",null),Dt([jt()],Gt.prototype,"fillText",null),Dt([jt()],Gt.prototype,"measureText",null),Dt([jt()],Gt.prototype,"strokeText",null);const{copy:Ht}=b,qt={width:1,height:1,pixelRatio:1},Vt=["width","height","pixelRatio"];class Qt extends Gt{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(e,r){super(),this.size={},this.worldTransform={},e||(e=qt),e.pixelRatio||(e.pixelRatio=t.devicePixelRatio),this.manager=r,this.innerId=s.create(s.CNAVAS);const{width:i,height:n,pixelRatio:o}=e;this.autoLayout=!i||!n,this.size.pixelRatio=o,this.config=e,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this));const s=this.size;It.copyAttrs(s,t,Vt),Vt.forEach((t=>s[t]||(s[t]=1))),this.bounds=new ht(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:s}=this,r=this.worldTransform;if(e){const{a:i,b:n,c:o,d:a,e:h,f:l}=e;this.setTransform(r.a=(t.a*i+t.b*o)*s,r.b=(t.a*n+t.b*a)*s,r.c=(t.c*i+t.d*o)*s,r.d=(t.c*n+t.d*a)*s,r.e=(t.e*i+t.f*o+h)*s,r.f=(t.e*n+t.f*a+l)*s)}else this.setTransform(r.a=t.a*s,r.b=t.b*s,r.c=t.c*s,r.d=t.d*s,r.e=t.e*s,r.f=t.f*s)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,s){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),s&&this.setStrokeOptions(s)}setStrokeOptions(t){this.strokeCap="none"===t.strokeCap?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,s=1){return!0}setWorldShadow(t,e,s,r){const{pixelRatio:i}=this;this.shadowOffsetX=t*i,this.shadowOffsetY=e*i,this.shadowBlur=s*i,this.shadowColor=r||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,s,r){if(r&&(this.blendMode=r),e){const{pixelRatio:r}=this;s||(s=e),this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x*r,s.y*r,s.width*r,s.height*r)}else this.drawImage(t.view,0,0);r&&(this.blendMode="source-over")}copyWorldToInner(t,e,s,r){if(r&&(this.blendMode=r),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,it.tempToOuterOf(s,e)),this.restore();else{const{pixelRatio:r}=this;this.drawImage(t.view,e.x*r,e.y*r,e.width*r,e.height*r,s.x,s.y,s.width,s.height)}r&&(this.blendMode="source-over")}copyWorldByReset(t,e,s,r,i){this.resetTransform(),this.copyWorld(t,e,s,r),i||this.useWorldTransform()}useGrayscaleAlpha(t){let e,s;this.setTempBounds(t,!0,!0);const{context:r}=this,i=r.getImageData(lt.x,lt.y,lt.width,lt.height),{data:n}=i;for(let t=0,r=n.length;t<r;t+=4)s=.299*n[t]+.587*n[t+1]+.114*n[t+2],(e=n[t+3])&&(n[t+3]=255===e?s:e*(s/255));r.putImageData(i,lt.x,lt.y)}useMask(t,e,s){this.copyWorld(t,e,s,"destination-in")}useEraser(t,e,s){this.copyWorld(t,e,s,"destination-out")}fillWorld(t,e,s){s&&(this.blendMode=s),this.fillStyle=e,this.setTempBounds(t),this.fillRect(lt.x,lt.y,lt.width,lt.height),s&&(this.blendMode="source-over")}strokeWorld(t,e,s){s&&(this.blendMode=s),this.strokeStyle=e,this.setTempBounds(t),this.strokeRect(lt.x,lt.y,lt.width,lt.height),s&&(this.blendMode="source-over")}clearWorld(t,e){this.setTempBounds(t,e),this.clearRect(lt.x,lt.y,lt.width,lt.height)}clipWorld(t,e){this.beginPath(),this.setTempBounds(t,e),this.rect(lt.x,lt.y,lt.width,lt.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempBounds(t,e,s){lt.set(t),s&&lt.intersect(this.bounds),lt.scale(this.pixelRatio),e&&lt.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,s){const r=this.manager?this.manager.get(this.size):e.canvas(Object.assign({},this.size));return r.save(),t&&(Ht(r.worldTransform,this.worldTransform),r.useWorldTransform()),s&&(r.smooth=this.smooth),r}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const Zt={creator:{},parse(t,e){},convertToCanvasData(t,e){}},Jt={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},$t=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},Jt),Kt={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},te={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},ee=Object.assign(Object.assign({},te),Jt),se=$t,re={};for(let t in se)re[se[t]]=t;const ie={};for(let t in se)ie[se[t]]=Kt[t];const ne={drawRoundRect(t,e,s,r,i,n){const o=a.fourNumber(n,Math.min(r/2,i/2)),h=e+r,l=s+i;o[0]?t.moveTo(e+o[0],s):t.moveTo(e,s),o[1]?t.arcTo(h,s,h,l,o[1]):t.lineTo(h,s),o[2]?t.arcTo(h,l,e,l,o[2]):t.lineTo(h,l),o[3]?t.arcTo(e,l,e,s,o[3]):t.lineTo(e,l),o[0]?t.arcTo(e,s,h,s,o[0]):t.lineTo(e,s)}},{sin:oe,cos:ae,atan2:he,ceil:le,abs:de,PI:ue,sqrt:ce,pow:_e}=Math,{setPoint:pe,addPoint:fe}=z,{set:ge,toNumberPoints:ye}=E,{M:me,L:xe,C:we,Q:be,Z:ve}=$t,Be={},ke={points(t,e,s,r){let i=ye(e);if(t.push(me,i[0],i[1]),s&&i.length>5){let e,n,o,a,h,l,d,u,c,_,p,f,g,y=i.length;const m=!0===s?.5:s;r&&(i=[i[y-2],i[y-1],...i,i[0],i[1],i[2],i[3]],y=i.length);for(let s=2;s<y-2;s+=2)e=i[s-2],n=i[s-1],o=i[s],a=i[s+1],h=i[s+2],l=i[s+3],p=ce(_e(o-e,2)+_e(a-n,2)),f=ce(_e(h-o,2)+_e(l-a,2)),g=p+f,p=m*p/g,f=m*f/g,h-=e,l-=n,d=o-p*h,u=a-p*l,2===s?r||t.push(be,d,u,o,a):t.push(we,c,_,d,u,o,a),c=o+f*h,_=a+f*l;r||t.push(be,c,_,i[y-2],i[y-1])}else for(let e=2,s=i.length;e<s;e+=2)t.push(xe,i[e],i[e+1]);r&&t.push(ve)},rect(t,e,s,r,i){Zt.creator.path=t,Zt.creator.moveTo(e,s).lineTo(e+r,s).lineTo(e+r,s+i).lineTo(e,s+i).lineTo(e,s)},roundRect(t,e,s,r,i,n){Zt.creator.path=[],ne.drawRoundRect(Zt.creator,e,s,r,i,n),t.push(...Zt.convertToCanvasData(Zt.creator.path,!0))},arcTo(t,e,s,r,i,n,o,a,u,c,_){const p=r-e,f=i-s,g=n-r,y=o-i;let m=he(f,p),x=he(y,g),w=x-m;if(w<0&&(w+=l),w===ue||de(p+f)<1e-12||de(g+y)<1e-12)return t&&t.push(xe,r,i),u&&(pe(u,e,s),fe(u,r,i)),_&&ge(_,e,s),void(c&&ge(c,r,i));const b=p*y-g*f<0,v=b?-1:1,B=a/ae(w/2),k=r+B*ae(m+w/2+d*v),C=i+B*oe(m+w/2+d*v);return m-=d*v,x-=d*v,Te(t,k,C,a,a,0,m/h,x/h,b,u,c,_)},arc:(t,e,s,r,i,n,o,a,h,l)=>Te(t,e,s,r,r,0,i,n,o,a,h,l),ellipse(t,e,s,r,i,n,o,a,u,c,_,p){const f=n*h,g=oe(f),y=ae(f);let m=o*h,x=a*h;m>ue&&(m-=l),x<0&&(x+=l);let w=x-m;w<0?w+=l:w>l&&(w-=l),u&&(w-=l);const b=le(de(w/d)),v=w/b,B=oe(v/4),k=8/3*B*B/oe(v/2);x=m+v;let C,O,T,P,R,S,L,E,I=ae(m),M=oe(m),A=T=y*r*I-g*i*M,W=P=g*r*I+y*i*M,N=e+T,Y=s+P;t&&t.push(t.length?xe:me,N,Y),c&&pe(c,N,Y),p&&ge(p,N,Y);for(let n=0;n<b;n++)C=ae(x),O=oe(x),T=y*r*C-g*i*O,P=g*r*C+y*i*O,R=e+A-k*(y*r*M+g*i*I),S=s+W-k*(g*r*M-y*i*I),L=e+T+k*(y*r*O+g*i*C),E=s+P+k*(g*r*O-y*i*C),t&&t.push(we,R,S,L,E,e+T,s+P),c&&Oe(e+A,s+W,R,S,L,E,e+T,s+P,c,!0),A=T,W=P,I=C,M=O,m=x,x+=v;_&&ge(_,e+T,s+P)},quadraticCurveTo(t,e,s,r,i,n,o){t.push(we,(e+2*r)/3,(s+2*i)/3,(n+2*r)/3,(o+2*i)/3,n,o)},toTwoPointBoundsByQuadraticCurve(t,e,s,r,i,n,o,a){Oe(t,e,(t+2*s)/3,(e+2*r)/3,(i+2*s)/3,(n+2*r)/3,i,n,o,a)},toTwoPointBounds(t,e,s,r,i,n,o,a,h,l){const d=[];let u,c,_,p,f,g,y,m,x=t,w=s,b=i,v=o;for(let t=0;t<2;++t)if(1==t&&(x=e,w=r,b=n,v=a),u=-3*x+9*w-9*b+3*v,c=6*x-12*w+6*b,_=3*w-3*x,Math.abs(u)<1e-12){if(Math.abs(c)<1e-12)continue;p=-_/c,0<p&&p<1&&d.push(p)}else y=c*c-4*_*u,m=Math.sqrt(y),y<0||(f=(-c+m)/(2*u),0<f&&f<1&&d.push(f),g=(-c-m)/(2*u),0<g&&g<1&&d.push(g));l?fe(h,t,e):pe(h,t,e),fe(h,o,a);for(let l=0,u=d.length;l<u;l++)Ce(d[l],t,e,s,r,i,n,o,a,Be),fe(h,Be.x,Be.y)},getPointAndSet(t,e,s,r,i,n,o,a,h,l){const d=1-t,u=d*d*d,c=3*d*d*t,_=3*d*t*t,p=t*t*t;l.x=u*e+c*r+_*n+p*a,l.y=u*s+c*i+_*o+p*h},getPoint(t,e,s,r,i,n,o,a,h){const l={};return Ce(t,e,s,r,i,n,o,a,h,l),l}},{getPointAndSet:Ce,toTwoPointBounds:Oe,ellipse:Te}=ke,{sin:Pe,cos:Re,sqrt:Se,atan2:Le}=Math,{ellipse:Ee}=ke,Ie={ellipticalArc(e,s,r,i,n,o,a,d,u,c,_){const p=(u-s)/2,f=(c-r)/2,g=o*h,y=Pe(g),m=Re(g),x=-m*p-y*f,w=-m*f+y*p,b=i*i,v=n*n,B=w*w,k=x*x,C=b*v-b*B-v*k;let O=0;if(C<0){const t=Se(1-C/(b*v));i*=t,n*=t}else O=(a===d?-1:1)*Se(C/(b*B+v*k));const T=O*i*w/n,P=-O*n*x/i,R=Le((w-P)/n,(x-T)/i),S=Le((-w-P)/n,(-x-T)/i);let L=S-R;0===d&&L>0?L-=l:1===d&&L<0&&(L+=l);const E=s+p+m*T-y*P,I=r+f+y*T+m*P,M=L<0?1:0;_||t.ellipseToCurve?Ee(e,E,I,i,n,o,R/h,S/h,M):i!==n||o?e.push($t.G,E,I,i,n,o,R/h,S/h,M):e.push($t.O,E,I,i,R/h,S/h,M)}},{M:Me,m:Ae,L:We,l:Ne,H:Ye,h:De,V:Xe,v:ze,C:Fe,c:je,S:Ue,s:Ge,Q:He,q:qe,T:Ve,t:Qe,A:Ze,a:Je,Z:$e,z:Ke,N:ts,D:es,X:ss,G:rs,F:is,O:ns,P:os,U:as}=$t,{rect:hs,roundRect:ls,arcTo:ds,arc:us,ellipse:cs,quadraticCurveTo:_s}=ke,{ellipticalArc:ps}=Ie,fs=xt.get("PathConvert"),gs={},ys={current:{dot:0},stringify(t,e){let s,r,i,n=0,o=t.length,h="";for(;n<o;){r=t[n],s=ie[r],h+=r===i?" ":re[r];for(let r=1;r<s;r++)h+=a.float(t[n+r],e),r===s-1||(h+=" ");i=r,n+=s}return h},parse(t,e){let s,r,i,n="";const o=[],a=e?ee:te;for(let e=0,h=t.length;e<h;e++)r=t[e],mt[r]?("."===r&&(ms.dot&&(xs(o,n),n=""),ms.dot++),"0"===n&&"."!==r&&(xs(o,n),n=""),n+=r):$t[r]?(n&&(xs(o,n),n=""),ms.name=$t[r],ms.length=Kt[r],ms.index=0,xs(o,ms.name),!s&&a[r]&&(s=!0)):"-"===r||"+"===r?"e"===i||"E"===i?n+=r:(n&&xs(o,n),n=r):n&&(xs(o,n),n=""),i=r;return n&&xs(o,n),s?ys.toCanvasData(o,e):o},toCanvasData(t,e){let s,r,i,n,o,a=0,h=0,l=0,d=0,u=0,c=t.length;const _=[];for(;u<c;){switch(i=t[u],i){case Ae:t[u+1]+=a,t[u+2]+=h;case Me:a=t[u+1],h=t[u+2],_.push(Me,a,h),u+=3;break;case De:t[u+1]+=a;case Ye:a=t[u+1],_.push(We,a,h),u+=2;break;case ze:t[u+1]+=h;case Xe:h=t[u+1],_.push(We,a,h),u+=2;break;case Ne:t[u+1]+=a,t[u+2]+=h;case We:a=t[u+1],h=t[u+2],_.push(We,a,h),u+=3;break;case Ge:t[u+1]+=a,t[u+2]+=h,t[u+3]+=a,t[u+4]+=h,i=Ue;case Ue:o=n===Fe||n===Ue,l=o?2*a-s:t[u+1],d=o?2*h-r:t[u+2],s=t[u+1],r=t[u+2],a=t[u+3],h=t[u+4],_.push(Fe,l,d,s,r,a,h),u+=5;break;case je:t[u+1]+=a,t[u+2]+=h,t[u+3]+=a,t[u+4]+=h,t[u+5]+=a,t[u+6]+=h,i=Fe;case Fe:s=t[u+3],r=t[u+4],a=t[u+5],h=t[u+6],_.push(Fe,t[u+1],t[u+2],s,r,a,h),u+=7;break;case Qe:t[u+1]+=a,t[u+2]+=h,i=Ve;case Ve:o=n===He||n===Ve,s=o?2*a-s:t[u+1],r=o?2*h-r:t[u+2],e?_s(_,a,h,s,r,t[u+1],t[u+2]):_.push(He,s,r,t[u+1],t[u+2]),a=t[u+1],h=t[u+2],u+=3;break;case qe:t[u+1]+=a,t[u+2]+=h,t[u+3]+=a,t[u+4]+=h,i=He;case He:s=t[u+1],r=t[u+2],e?_s(_,a,h,s,r,t[u+3],t[u+4]):_.push(He,s,r,t[u+3],t[u+4]),a=t[u+3],h=t[u+4],u+=5;break;case Je:t[u+6]+=a,t[u+7]+=h;case Ze:ps(_,a,h,t[u+1],t[u+2],t[u+3],t[u+4],t[u+5],t[u+6],t[u+7],e),a=t[u+6],h=t[u+7],u+=8;break;case Ke:case $e:_.push($e),u++;break;case ts:a=t[u+1],h=t[u+2],e?hs(_,a,h,t[u+3],t[u+4]):ws(_,t,u,5),u+=5;break;case es:a=t[u+1],h=t[u+2],e?ls(_,a,h,t[u+3],t[u+4],[t[u+5],t[u+6],t[u+7],t[u+8]]):ws(_,t,u,9),u+=9;break;case ss:a=t[u+1],h=t[u+2],e?ls(_,a,h,t[u+3],t[u+4],t[u+5]):ws(_,t,u,6),u+=6;break;case rs:cs(e?_:ws(_,t,u,9),t[u+1],t[u+2],t[u+3],t[u+4],t[u+5],t[u+6],t[u+7],t[u+8],null,gs),a=gs.x,h=gs.y,u+=9;break;case is:e?cs(_,t[u+1],t[u+2],t[u+3],t[u+4],0,0,360,!1):ws(_,t,u,5),a=t[u+1]+t[u+3],h=t[u+2],u+=5;break;case ns:us(e?_:ws(_,t,u,7),t[u+1],t[u+2],t[u+3],t[u+4],t[u+5],t[u+6],null,gs),a=gs.x,h=gs.y,u+=7;break;case os:e?us(_,t[u+1],t[u+2],t[u+3],0,360,!1):ws(_,t,u,4),a=t[u+1]+t[u+3],h=t[u+2],u+=4;break;case as:ds(e?_:ws(_,t,u,6),a,h,t[u+1],t[u+2],t[u+3],t[u+4],t[u+5],null,gs),a=gs.x,h=gs.y,u+=6;break;default:return fs.error(`command: ${i} [index:${u}]`,t),_}n=i}return _},objectToCanvasData(t){const e=[];return t.forEach((t=>{switch(t.name){case"M":e.push(Me,t.x,t.y);break;case"L":e.push(We,t.x,t.y);break;case"C":e.push(Fe,t.x1,t.y1,t.x2,t.y2,t.x,t.y);break;case"Q":e.push(He,t.x1,t.y1,t.x,t.y);break;case"Z":e.push($e)}})),e},copyData(t,e,s,r){for(let i=s,n=s+r;i<n;i++)t.push(e[i])},pushData(t,e){ms.index===ms.length&&(ms.index=1,t.push(ms.name)),t.push(Number(e)),ms.index++,ms.dot=0}},{current:ms,pushData:xs,copyData:ws}=ys,{M:bs,L:vs,C:Bs,Q:ks,Z:Cs,N:Os,D:Ts,X:Ps,G:Rs,F:Ss,O:Ls,P:Es,U:Is}=$t,{getMinDistanceFrom:Ms,getRadianFrom:As}=E,{tan:Ws,min:Ns,abs:Ys}=Math,Ds={},Xs={beginPath(t){t.length=0},moveTo(t,e,s){t.push(bs,e,s)},lineTo(t,e,s){t.push(vs,e,s)},bezierCurveTo(t,e,s,r,i,n,o){t.push(Bs,e,s,r,i,n,o)},quadraticCurveTo(t,e,s,r,i){t.push(ks,e,s,r,i)},closePath(t){t.push(Cs)},rect(t,e,s,r,i){t.push(Os,e,s,r,i)},roundRect(t,e,s,r,i,n){if("number"==typeof n)t.push(Ps,e,s,r,i,n);else{const o=a.fourNumber(n);o?t.push(Ts,e,s,r,i,...o):t.push(Os,e,s,r,i)}},ellipse(t,e,s,r,i,n,o,a,h){void 0===n?t.push(Ss,e,s,r,i):(void 0===o&&(o=0),void 0===a&&(a=360),t.push(Rs,e,s,r,i,n,o,a,h?1:0))},arc(t,e,s,r,i,n,o){void 0===i?t.push(Es,e,s,r):(void 0===n&&(n=360),t.push(Ls,e,s,r,i,n,o?1:0))},arcTo(t,e,s,r,i,n,o,a){if(void 0!==o){const h=Ws(As(o,a,e,s,r,i)/2)*(Ms(o,a,e,s,r,i)/2);t.push(Is,e,s,r,i,Ns(n,Ys(h)))}else t.push(Is,e,s,r,i,n)},drawEllipse(t,e,s,r,i,n,o,a,h){ke.ellipse(null,e,s,r,i,void 0===n?0:n,void 0===o?0:o,void 0===a?360:a,h,null,null,Ds),t.push(bs,Ds.x,Ds.y),zs(t,e,s,r,i,n,o,a,h)},drawArc(t,e,s,r,i,n,o){ke.arc(null,e,s,r,void 0===i?0:i,void 0===n?360:n,o,null,null,Ds),t.push(bs,Ds.x,Ds.y),Fs(t,e,s,r,i,n,o)},drawPoints(t,e,s,r){ke.points(t,e,s,r)}},{ellipse:zs,arc:Fs}=Xs,{moveTo:js,lineTo:Us,quadraticCurveTo:Gs,bezierCurveTo:Hs,closePath:qs,beginPath:Vs,rect:Qs,roundRect:Zs,ellipse:Js,arc:$s,arcTo:Ks,drawEllipse:tr,drawArc:er,drawPoints:sr}=Xs;class rr{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?"string"==typeof t?Zt.parse(t):t:[],this}beginPath(){return Vs(this.__path),this.paint(),this}moveTo(t,e){return js(this.__path,t,e),this.paint(),this}lineTo(t,e){return Us(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,s,r,i,n){return Hs(this.__path,t,e,s,r,i,n),this.paint(),this}quadraticCurveTo(t,e,s,r){return Gs(this.__path,t,e,s,r),this.paint(),this}closePath(){return qs(this.__path),this.paint(),this}rect(t,e,s,r){return Qs(this.__path,t,e,s,r),this.paint(),this}roundRect(t,e,s,r,i){return Zs(this.__path,t,e,s,r,i),this.paint(),this}ellipse(t,e,s,r,i,n,o,a){return Js(this.__path,t,e,s,r,i,n,o,a),this.paint(),this}arc(t,e,s,r,i,n){return $s(this.__path,t,e,s,r,i,n),this.paint(),this}arcTo(t,e,s,r,i){return Ks(this.__path,t,e,s,r,i),this.paint(),this}drawEllipse(t,e,s,r,i,n,o,a){return tr(this.__path,t,e,s,r,i,n,o,a),this.paint(),this}drawArc(t,e,s,r,i,n){return er(this.__path,t,e,s,r,i,n),this.paint(),this}drawPoints(t,e,s){return sr(this.__path,t,e,s),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:ir,L:nr,C:or,Q:ar,Z:hr,N:lr,D:dr,X:ur,G:cr,F:_r,O:pr,P:fr,U:gr}=$t,yr=xt.get("PathDrawer"),mr={drawPathByData(t,e){if(!e)return;let s,r=0,i=e.length;for(;r<i;)switch(s=e[r],s){case ir:t.moveTo(e[r+1],e[r+2]),r+=3;break;case nr:t.lineTo(e[r+1],e[r+2]),r+=3;break;case or:t.bezierCurveTo(e[r+1],e[r+2],e[r+3],e[r+4],e[r+5],e[r+6]),r+=7;break;case ar:t.quadraticCurveTo(e[r+1],e[r+2],e[r+3],e[r+4]),r+=5;break;case hr:t.closePath(),r+=1;break;case lr:t.rect(e[r+1],e[r+2],e[r+3],e[r+4]),r+=5;break;case dr:t.roundRect(e[r+1],e[r+2],e[r+3],e[r+4],[e[r+5],e[r+6],e[r+7],e[r+8]]),r+=9;break;case ur:t.roundRect(e[r+1],e[r+2],e[r+3],e[r+4],e[r+5]),r+=6;break;case cr:t.ellipse(e[r+1],e[r+2],e[r+3],e[r+4],e[r+5]*h,e[r+6]*h,e[r+7]*h,e[r+8]),r+=9;break;case _r:t.ellipse(e[r+1],e[r+2],e[r+3],e[r+4],0,0,l,!1),r+=5;break;case pr:t.arc(e[r+1],e[r+2],e[r+3],e[r+4]*h,e[r+5]*h,e[r+6]),r+=7;break;case fr:t.arc(e[r+1],e[r+2],e[r+3],0,l,!1),r+=4;break;case gr:t.arcTo(e[r+1],e[r+2],e[r+3],e[r+4],e[r+5]),r+=6;break;default:return void yr.error(`command: ${s} [index:${r}]`,e)}}},{M:xr,L:wr,C:br,Q:vr,Z:Br,N:kr,D:Cr,X:Or,G:Tr,F:Pr,O:Rr,P:Sr,U:Lr}=$t,{toTwoPointBounds:Er,toTwoPointBoundsByQuadraticCurve:Ir,arcTo:Mr,arc:Ar,ellipse:Wr}=ke,{addPointBounds:Nr,copy:Yr,addPoint:Dr,setPoint:Xr,addBounds:zr,toBounds:Fr}=z,jr=xt.get("PathBounds");let Ur,Gr,Hr;const qr={},Vr={},Qr={},Zr={toBounds(t,e){Zr.toTwoPointBounds(t,Vr),Fr(Vr,e)},toTwoPointBounds(t,e){if(!t||!t.length)return Xr(e,0,0);let s,r,i,n,o,a=0,h=0,l=0;const d=t.length;for(;a<d;)switch(o=t[a],0===a&&(o===Br||o===br||o===vr?Xr(e,h,l):Xr(e,t[a+1],t[a+2])),o){case xr:case wr:h=t[a+1],l=t[a+2],Dr(e,h,l),a+=3;break;case br:i=t[a+5],n=t[a+6],Er(h,l,t[a+1],t[a+2],t[a+3],t[a+4],i,n,qr),Nr(e,qr),h=i,l=n,a+=7;break;case vr:s=t[a+1],r=t[a+2],i=t[a+3],n=t[a+4],Ir(h,l,s,r,i,n,qr),Nr(e,qr),h=i,l=n,a+=5;break;case Br:a+=1;break;case kr:h=t[a+1],l=t[a+2],zr(e,h,l,t[a+3],t[a+4]),a+=5;break;case Cr:case Or:h=t[a+1],l=t[a+2],zr(e,h,l,t[a+3],t[a+4]),a+=o===Cr?9:6;break;case Tr:Wr(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],qr,Qr),0===a?Yr(e,qr):Nr(e,qr),h=Qr.x,l=Qr.y,a+=9;break;case Pr:h=t[a+1],l=t[a+2],Gr=t[a+3],Hr=t[a+4],zr(e,h-Gr,l-Hr,2*Gr,2*Hr),h+=Gr,a+=5;break;case Rr:Ar(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],qr,Qr),0===a?Yr(e,qr):Nr(e,qr),h=Qr.x,l=Qr.y,a+=7;break;case Sr:h=t[a+1],l=t[a+2],Ur=t[a+3],zr(e,h-Ur,l-Ur,2*Ur,2*Ur),h+=Ur,a+=4;break;case Lr:Mr(null,h,l,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],qr,Qr),0===a?Yr(e,qr):Nr(e,qr),h=Qr.x,l=Qr.y,a+=6;break;default:return void jr.error(`command: ${o} [index:${a}]`,t)}}},{M:Jr,L:$r,C:Kr,Z:ti}=$t,{getCenterX:ei,getCenterY:si}=E,{arcTo:ri}=Xs,ii={smooth(t,e,s){let r,i=0,n=0,o=0,a=0,h=0,l=0,d=0,u=0,c=0;const _=t.length,p=[];for(;i<_;)switch(r=t[i],r){case Jr:a=u=t[i+1],h=c=t[i+2],i+=3,t[i]===$r?(l=t[i+1],d=t[i+2],p.push(Jr,ei(a,l),si(h,d))):p.push(Jr,a,h);break;case $r:switch(n=t[i+1],o=t[i+2],i+=3,t[i]){case $r:ri(p,n,o,t[i+1],t[i+2],e,u,c);break;case ti:ri(p,n,o,a,h,e,u,c);break;default:p.push($r,n,o)}u=n,c=o;break;case Kr:p.push(Kr,t[i+1],t[i+2],t[i+3],t[i+4],t[i+5],t[i+6]),i+=7;break;case ti:ri(p,a,h,l,d,e,u,c),p.push(ti),i+=1}return r!==ti&&(p[1]=a,p[2]=h),p}};Zt.creator=new rr,Zt.parse=ys.parse,Zt.convertToCanvasData=ys.toCanvasData;const ni=new rr,{drawRoundRect:oi}=ne;function ai(t){!function(t){t&&!t.roundRect&&(t.roundRect=function(t,e,s,r,i){oi(this,t,e,s,r,i)})}(t)}const hi={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:t=>!t||t.startsWith("image")?t:("jpg"===t&&(t="jpeg"),"image/"+t),fileType(t){const e=t.split(".");return e[e.length-1]},isOpaqueImage(t){const e=li.fileType(t);return["jpg","jpeg"].some((t=>t===e))},getExportOptions(t){switch(typeof t){case"object":return t;case"number":return{quality:t};case"boolean":return{blob:t};default:return{}}}},li=hi;li.opacityTypes.forEach((t=>li.upperCaseTypeMap[t]=t.toUpperCase()));const di=xt.get("TaskProcessor");class ui{constructor(t){this.parallel=!0,this.time=1,this.id=s.create(s.TASK),this.task=t}run(){return Xt(this,void 0,void 0,(function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){di.error(t)}}))}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class ci{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,s=0;for(let r=0;r<t;r++)r<=this.finishedIndex?(s+=this.list[r].time,r===this.finishedIndex&&(e=s)):e+=this.list[r].time;return this.isComplete?1:s/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&It.assign(this.config,t),this.empty()}add(t,e){let s,r,i,n;const o=new ui(t);return o.parent=this,"number"==typeof e?n=e:e&&(r=e.parallel,s=e.start,i=e.time,n=e.delay),i&&(o.time=i),!1===r&&(o.parallel=!1),void 0===n?this.push(o,s):(this.delayNumber++,setTimeout((()=>{this.delayNumber&&(this.delayNumber--,this.push(o,s))}),n)),this.isComplete=!1,o}push(t,e){this.list.push(t),!1===e||this.timer||(this.timer=setTimeout((()=>this.start())))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach((t=>{t.isComplete||t.cancel()})),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then((()=>{this.onTask(t),this.index++,this.nextTask()})).catch((t=>{this.onError(t)})):this.nextTask()}runParallelTasks(){this.parallelList.forEach((t=>this.runParallelTask(t)))}runParallelTask(t){t.run().then((()=>{this.onTask(t),this.fillParallelTask()})).catch((t=>{this.onParallelError(t)}))}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout((()=>this.run()))}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let s=this.index;s<e&&(t=this.list[s],t.parallel);s++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const s=e.length,r=this.finishedIndex+s;if(e.length){if(!this.running)return;r<this.total&&(t=this.list[r],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach((t=>{t.parallel=!1})),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const _i={map:{},recycledList:[],tasker:new ci,patternTasker:new ci,get isComplete(){return pi.tasker.isComplete},get(t){let s=pi.map[t.url];return s||(s=e.image(t),pi.map[t.url]=s),s.use++,s},recycle(t){t.use--,setTimeout((()=>{t.use||pi.recycledList.push(t)}))},clearRecycled(){const t=pi.recycledList;t.length>100&&(t.forEach((t=>{!t.use&&t.url&&(delete pi.map[t.url],t.destroy())})),t.length=0)},hasOpacityPixel:t=>hi.opacityTypes.some((e=>pi.isFormat(e,t))),isFormat(t,e){if(e.format===t)return!0;const{url:s}=e;if(s.startsWith("data:")){if(s.startsWith("data:"+hi.mineType(t)))return!0}else{if(s.includes("."+t)||s.includes("."+hi.upperCaseTypeMap[t]))return!0;if("png"===t&&!s.includes("."))return!0}return!1},destroy(){pi.map={},pi.recycledList=[]}},pi=_i,{IMAGE:fi,create:gi}=s;class yi{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=gi(fi),this.config=t||{url:""},this.isSVG=_i.isFormat("svg",t),this.hasOpacityPixel=_i.hasOpacityPixel(t)}load(e,s){return this.loading||(this.loading=!0,_i.tasker.add((()=>Xt(this,void 0,void 0,(function*(){return yield t.origin.loadImage(this.url).then((t=>{this.ready=!0,this.width=t.naturalWidth||t.width,this.height=t.naturalHeight||t.height,this.view=t,this.onComplete(!0)})).catch((t=>{this.error=t,this.onComplete(!1)}))}))))),this.waitComplete.push(e,s),this.waitComplete.length-2}unload(t,e){const s=this.waitComplete;if(e){const e=s[t+1];e&&e({type:"stop"})}s[t]=s[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach(((s,r)=>{e=r%2,s&&(t?e||s(this):e&&s(this.error))})),this.waitComplete.length=0,this.loading=!1}getCanvas(e,s,r,i){if(e||(e=this.width),s||(s=this.height),this.cache){let{params:t,data:e}=this.cache;for(let s in t)if(t[s]!==arguments[s]){e=null;break}if(e)return e}const n=t.origin.createCanvas(e,s),o=n.getContext("2d");return r&&(o.globalAlpha=r),o.drawImage(this.view,0,0,e,s),this.cache=this.use>1?{data:n,params:arguments}:null,n}getPattern(e,s,r,i){const n=t.canvas.createPattern(e,s);try{r&&n.setTransform&&(n.setTransform(r),r=null)}catch(t){}return i&&(i.transform=r),n}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function mi(t,e,s,r){r||(s.configurable=s.enumerable=!0),Object.defineProperty(t,e,s)}function xi(t,e){return Object.getOwnPropertyDescriptor(t,e)}function wi(t,e){return(s,r)=>vi(s,r,t,e&&e(r))}function bi(t){return t}function vi(t,e,s,r){const i={get(){return this.__getAttr(e)},set(t){this.__setAttr(e,t)}};mi(t,e,Object.assign(i,r||{})),Vi(t,e,s)}function Bi(t){return wi(t)}function ki(t,e){return wi(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}})))}function Ci(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal())}})))}function Oi(t,e){return wi(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}})))}function Ti(t,e){return wi(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}})))}function Pi(t,e){return wi(t,(t=>({set(s){this.__setAttr(t,s,e)&&Si(this)}})))}function Ri(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(Si(this),this.__.__removeNaturalSize())}})))}function Si(t){t.__layout.boxChanged||t.__layout.boxChange(),t.__hasAutoLayout&&(t.__layout.matrixChanged||t.__layout.matrixChange())}function Li(t){return wi(t,(t=>({set(e){const s=this.__;2!==s.__pathInputed&&(s.__pathInputed=e?1:0),e||(s.__pathForRender=void 0),this.__setAttr(t,e),Si(this)}})))}const Ei=Pi;function Ii(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&Mi(this)}})))}function Mi(t){t.__layout.strokeChanged||t.__layout.strokeChange(),t.__.__useArrow&&Si(t)}const Ai=Ii;function Wi(t){return wi(t,(t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}})))}function Ni(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}})))}function Yi(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}})))}function Di(t){return wi(t,(t=>({set(e){const s=this.visible;if(!0===s&&0===e){if(this.animationOut)return this.__runAnimation("out",(()=>Xi(this,t,e,s)))}else 0===s&&!0===e&&this.animation&&this.__runAnimation("in");Xi(this,t,e,s)}})))}function Xi(t,e,s,r){t.__setAttr(e,s)&&(t.__layout.opacityChanged||t.__layout.opacityChange(),0!==r&&0!==s||Si(t))}function zi(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent((()=>{this.parent.__layout.childrenSortChange()})))}})))}function Fi(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent((()=>{this.parent.__updateMask(e)})))}})))}function ji(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&this.waitParent((()=>{this.parent.__updateEraser(e)}))}})))}function Ui(t){return wi(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,xt.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}})))}function Gi(t){return wi(t,(t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}})))}function Hi(t){return(e,s)=>{mi(e,"__DataProcessor",{get:()=>t})}}function qi(t){return(e,s)=>{mi(e,"__LayoutProcessor",{get:()=>t})}}function Vi(t,e,s){const r=t.__DataProcessor.prototype,i="_"+e,n=function(t){return"set"+t.charAt(0).toUpperCase()+t.slice(1)}(e),o={get(){const t=this[i];return void 0===t?s:t},set(t){this[i]=t}};if(void 0===s)o.get=function(){return this[i]};else if("object"==typeof s){const{clone:t}=It;o.get=function(){let e=this[i];return void 0===e&&(this[i]=e=t(s)),e}}"width"===e?o.get=function(){const t=this[i];if(void 0===t){const t=this;return t._height&&t.__naturalWidth&&t.__useNaturalRatio?t._height*t.__naturalWidth/t.__naturalHeight:t.__naturalWidth||s}return t}:"height"===e&&(o.get=function(){const t=this[i];if(void 0===t){const t=this;return t._width&&t.__naturalHeight&&t.__useNaturalRatio?t._width*t.__naturalHeight/t.__naturalWidth:t.__naturalHeight||s}return t});let a,h=r;for(;!a&&h;)a=xi(h,e),h=h.__proto__;a&&a.set&&(o.set=a.set),r[n]&&(o.set=r[n],delete r[n]),mi(r,e,o)}const Qi=new xt("rewrite"),Zi=[],Ji=["destroy","constructor"];function $i(t){return(e,s)=>{Zi.push({name:e.constructor.name+"."+s,run:()=>{e[s]=t}})}}function Ki(){return t=>{tn()}}function tn(t){Zi.length&&(Zi.forEach((e=>{t&&Qi.error(e.name,"需在Class上装饰@rewriteAble()"),e.run()})),Zi.length=0)}function en(t,e){return s=>{var r;(t.prototype?(r=t.prototype,Object.getOwnPropertyNames(r)):Object.keys(t)).forEach((r=>{if(!(Ji.includes(r)||e&&e.includes(r)))if(t.prototype){xi(t.prototype,r).writable&&(s.prototype[r]=t.prototype[r])}else s.prototype[r]=t[r]}))}}function sn(){return t=>{Tt.register(t)}}function rn(){return t=>{St.register(t)}}setTimeout((()=>tn(!0)));const{copy:nn,toInnerPoint:on,toOuterPoint:an,scaleOfOuter:hn,rotateOfOuter:ln,skewOfOuter:dn,multiplyParent:un,divideParent:cn,getLayout:_n}=b,pn={},fn={updateAllMatrix(t,e,s){if(e&&t.__hasAutoLayout&&t.__layout.matrixChanged&&(s=!0),mn(t,e,s),t.isBranch){const{children:r}=t;for(let t=0,i=r.length;t<i;t++)yn(r[t],e,s)}},updateMatrix(t,e,s){const r=t.__layout;e?s&&(r.waitAutoLayout=!0,t.__hasAutoLayout&&(r.matrixChanged=!1)):r.waitAutoLayout&&(r.waitAutoLayout=!1),r.matrixChanged&&t.__updateLocalMatrix(),r.waitAutoLayout||t.__updateWorldMatrix()},updateBounds(t){const e=t.__layout;e.boundsChanged&&t.__updateLocalBounds(),e.waitAutoLayout||t.__updateWorldBounds()},updateAllWorldOpacity(t){if(t.__updateWorldOpacity(),t.isBranch){const{children:e}=t;for(let t=0,s=e.length;t<s;t++)xn(e[t])}},updateAllChange(t){if(xn(t),t.__updateChange(),t.isBranch){const{children:e}=t;for(let t=0,s=e.length;t<s;t++)wn(e[t])}},worldHittable(t){for(;t;){if(!t.__.hittable)return!1;t=t.parent}return!0},moveWorld(t,e,s=0,r){const i="object"==typeof e?Object.assign({},e):{x:e,y:s};r?an(t.localTransform,i,i,!0):t.parent&&on(t.parent.worldTransform,i,i,!0),gn.moveLocal(t,i.x,i.y)},moveLocal(t,e,s=0){"object"==typeof e?(t.x+=e.x,t.y+=e.y):(t.x+=e,t.y+=s)},zoomOfWorld(t,e,s,r,i){gn.zoomOfLocal(t,vn(t,e),s,r,i)},zoomOfLocal(t,e,s,r=s,i){nn(pn,t.__localMatrix),hn(pn,e,s,r),t.origin||t.around?gn.setTransform(t,pn,i):(bn(t,pn),t.scaleResize(s,r,!0!==i))},rotateOfWorld(t,e,s){gn.rotateOfLocal(t,vn(t,e),s)},rotateOfLocal(t,e,s){nn(pn,t.__localMatrix),ln(pn,e,s),t.origin||t.around?gn.setTransform(t,pn):(bn(t,pn),t.rotation=a.formatRotation(t.rotation+s))},skewOfWorld(t,e,s,r,i){gn.skewOfLocal(t,vn(t,e),s,r,i)},skewOfLocal(t,e,s,r=0,i){nn(pn,t.__localMatrix),dn(pn,e,s,r),gn.setTransform(t,pn,i)},transformWorld(t,e,s){nn(pn,t.worldTransform),un(pn,e),t.parent&&cn(pn,t.parent.worldTransform),gn.setTransform(t,pn,s)},transform(t,e,s){nn(pn,t.localTransform),un(pn,e),gn.setTransform(t,pn,s)},setTransform(t,e,s){const r=_n(e,t.origin&&gn.getInnerOrigin(t,t.origin),t.around&&gn.getInnerOrigin(t,t.around));if(s){const e=r.scaleX/t.scaleX,i=r.scaleY/t.scaleY;delete r.scaleX,delete r.scaleY,t.set(r),t.scaleResize(e,i,!0!==s)}else t.set(r)},getFlipTransform(t,e){const s={a:1,b:0,c:0,d:1,e:0,f:0},r="x"===e?1:-1;return hn(s,gn.getLocalOrigin(t,"center"),-1*r,1*r),s},getLocalOrigin:(t,e)=>E.tempToOuterOf(gn.getInnerOrigin(t,e),t.localTransform),getInnerOrigin(t,e){const s={};return pt.toPoint(e,t.boxBounds,s),s},getRelativeWorld:(t,e,s)=>(nn(pn,t.worldTransform),cn(pn,e.worldTransform),s?pn:Object.assign({},pn)),drop(t,e,s,r){t.setTransform(gn.getRelativeWorld(t,e,!0),r),e.add(t,s)},hasParent(t,e){if(!e)return!1;for(;t;){if(e===t)return!0;t=t.parent}}},gn=fn,{updateAllMatrix:yn,updateMatrix:mn,updateAllWorldOpacity:xn,updateAllChange:wn}=gn;function bn(t,e){const{e:s,f:r}=t.__localMatrix;t.x+=e.e-s,t.y+=e.f-r}function vn(t,e){return t.__layout.update(),t.parent?E.tempToInnerOf(e,t.parent.__world):e}const Bn={worldBounds:t=>t.__world,localBoxBounds:t=>t.__.eraser||0===t.__.visible?null:t.__local||t.__layout,localStrokeBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localStrokeBounds,localRenderBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localRenderBounds,maskLocalBoxBounds:t=>t.__.mask?t.__localBoxBounds:null,maskLocalStrokeBounds:t=>t.__.mask?t.__layout.localStrokeBounds:null,maskLocalRenderBounds:t=>t.__.mask?t.__layout.localRenderBounds:null,excludeRenderBounds:(t,e)=>!(!e.bounds||e.bounds.hit(t.__world,e.matrix))||!(!e.hideBounds||!e.hideBounds.includes(t.__world,e.matrix))},{updateBounds:kn}=fn,Cn={sort:(t,e)=>t.__.zIndex===e.__.zIndex?t.__tempNumber-e.__tempNumber:t.__.zIndex-e.__.zIndex,pushAllChildBranch(t,e){if(t.__tempNumber=1,t.__.__childBranchNumber){const{children:s}=t;for(let r=0,i=s.length;r<i;r++)(t=s[r]).isBranch&&(t.__tempNumber=1,e.add(t),On(t,e))}},pushAllParent(t,e){const{keys:s}=e;if(s)for(;t.parent&&void 0===s[t.parent.innerId];)e.add(t.parent),t=t.parent;else for(;t.parent;)e.add(t.parent),t=t.parent},pushAllBranchStack(t,e){let s=e.length;const{children:r}=t;for(let t=0,s=r.length;t<s;t++)r[t].isBranch&&e.push(r[t]);for(let t=s,r=e.length;t<r;t++)Tn(e[t],e)},updateBounds(t,e){const s=[t];Tn(t,s),Pn(s,e)},updateBoundsByBranchStack(t,e){let s,r;for(let i=t.length-1;i>-1;i--){s=t[i],r=s.children;for(let t=0,e=r.length;t<e;t++)kn(r[t]);e&&e===s||kn(s)}}},{pushAllChildBranch:On,pushAllBranchStack:Tn,updateBoundsByBranchStack:Pn}=Cn,Rn={run(t){if(t&&t.length){const e=t.length;for(let s=0;s<e;s++)t[s]();t.length===e?t.length=0:t.splice(0,e)}}},{getRelativeWorld:Sn}=fn,{toOuterOf:Ln,getPoints:En,copy:In}=it,Mn="_localContentBounds",An="_worldContentBounds",Wn="_worldBoxBounds",Nn="_worldStrokeBounds";class Yn{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return Ln(this.contentBounds,this.leaf.__localMatrix,this[Mn]||(this[Mn]={})),this[Mn]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Ln(this.contentBounds,this.leaf.__world,this[An]||(this[An]={})),this[An]}get worldBoxBounds(){return Ln(this.boxBounds,this.leaf.__world,this[Wn]||(this[Wn]={})),this[Wn]}get worldStrokeBounds(){return Ln(this.strokeBounds,this.leaf.__world,this[Nn]||(this[Nn]={})),this[Nn]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:e}=this.leaf;if(e)e.ready?e.watcher.changed&&e.layouter.layout():e.start();else{let e=this.leaf;for(;e.parent&&!e.parent.leafer;)e=e.parent;t.layout(e)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return b.defaultMatrix;case"page":t=e.zoomLayer;default:return Sn(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new ht(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",s){const{leaf:r}=this;let i,n,o,a=this.getInnerBounds(t);switch(e){case"world":i=r.getWorldPoint(a),n=r.__world;break;case"local":const{scaleX:t,scaleY:s,rotation:h,skewX:l,skewY:d}=r.__;o={scaleX:t,scaleY:s,rotation:h,skewX:l,skewY:d},i=r.getLocalPointByInner(a);break;case"inner":i=a,n=b.defaultMatrix;break;case"page":e=r.zoomLayer;default:i=r.getWorldPoint(a,e),n=Sn(r,e,!0)}if(o||(o=b.getLayout(n)),In(o,a),E.copy(o,i),s){const{scaleX:t,scaleY:e}=o,s=Math.abs(t),r=Math.abs(e);1===s&&1===r||(o.scaleX/=s,o.scaleY/=r,o.width*=s,o.height*=r)}return o}getLayoutPoints(t,e="world"){const{leaf:s}=this,r=En(this.getInnerBounds(t));let i;switch(e){case"world":i=null;break;case"local":i=s.parent;break;case"inner":break;case"page":e=s.zoomLayer;default:i=e}return void 0!==i&&r.forEach((t=>s.innerToWorld(t,null,!1,i))),r}shrinkContent(){const{x:t,y:e,width:s,height:r}=this.boxBounds;this._contentBounds={x:t,y:e,width:s,height:r}}spreadStroke(){const{x:t,y:e,width:s,height:r}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:s,height:r},this._localStrokeBounds={x:t,y:e,width:s,height:r},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:s,height:r}=this.renderBounds;this._renderBounds={x:t,y:e,width:s,height:r},this._localRenderBounds={x:t,y:e,width:s,height:r}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class Dn{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&t.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&t.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&t.event.stop(this.origin)}}class Xn extends Dn{constructor(t,e,s){super(t,e),this.parent=s,this.child=e}}Xn.ADD="child.add",Xn.REMOVE="child.remove",Xn.CREATED="created",Xn.MOUNTED="mounted",Xn.UNMOUNTED="unmounted",Xn.DESTROY="destroy";class zn extends Dn{constructor(t,e,s,r,i){super(t,e),this.attrName=s,this.oldValue=r,this.newValue=i}}zn.CHANGE="property.change",zn.LEAFER_CHANGE="property.leafer_change";class Fn extends Dn{constructor(t,e){super(t),Object.assign(this,e)}}Fn.LOAD="image.load",Fn.LOADED="image.loaded",Fn.ERROR="image.error";class jn extends Dn{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,e){"object"==typeof t?(super(jn.RESIZE),Object.assign(this,t)):super(t),this.old=e}}jn.RESIZE="resize";class Un extends Dn{constructor(t,e){super(t),this.data=e}}Un.REQUEST="watch.request",Un.DATA="watch.data";class Gn extends Dn{constructor(t,e,s){super(t),e&&(this.data=e,this.times=s)}}Gn.CHECK_UPDATE="layout.check_update",Gn.REQUEST="layout.request",Gn.START="layout.start",Gn.BEFORE="layout.before",Gn.LAYOUT="layout",Gn.AFTER="layout.after",Gn.AGAIN="layout.again",Gn.END="layout.end";class Hn extends Dn{constructor(t,e,s,r){super(t),e&&(this.times=e),s&&(this.renderBounds=s,this.renderOptions=r)}}Hn.REQUEST="render.request",Hn.CHILD_START="render.child_start",Hn.START="render.start",Hn.BEFORE="render.before",Hn.RENDER="render",Hn.AFTER="render.after",Hn.AGAIN="render.again",Hn.END="render.end",Hn.NEXT="render.next";class qn extends Dn{}qn.START="leafer.start",qn.BEFORE_READY="leafer.before_ready",qn.READY="leafer.ready",qn.AFTER_READY="leafer.after_ready",qn.VIEW_READY="leafer.view_ready",qn.VIEW_COMPLETED="leafer.view_completed",qn.STOP="leafer.stop",qn.RESTART="leafer.restart",qn.END="leafer.end";const Vn={};class Qn{set event(t){this.on(t)}on(t,e,s){if(!e){let e,s=t;for(let t in s)e=s[t],e instanceof Array?this.on(t,e[0],e[1]):this.on(t,e);return}let r,i,n;s&&("once"===s?i=!0:"boolean"==typeof s?r=s:(r=s.capture,i=s.once));const o=Zn(this,r,!0),a="string"==typeof t?t.split(" "):t,h=i?{listener:e,once:i}:{listener:e};a.forEach((t=>{t&&(n=o[t],n?-1===n.findIndex((t=>t.listener===e))&&n.push(h):o[t]=[h])}))}off(t,e,s){if(t){const r="string"==typeof t?t.split(" "):t;if(e){let t,i,n;s&&(t="boolean"==typeof s?s:"once"!==s&&s.capture);const o=Zn(this,t);r.forEach((t=>{t&&(i=o[t],i&&(n=i.findIndex((t=>t.listener===e)),n>-1&&i.splice(n,1),i.length||delete o[t]))}))}else{const{__bubbleMap:t,__captureMap:e}=this;r.forEach((s=>{t&&delete t[s],e&&delete e[s]}))}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,s,r){return s&&(e=e.bind(s)),this.on(t,e,r),{type:t,current:this,listener:e,options:r}}off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach((t=>t.current.off(t.type,t.listener,t.options))),e.length=0}once(t,e,s){this.on(t,e,{once:!0,capture:s})}emit(t,e,s){!e&&St.has(t)&&(e=St.get(t,{type:t,target:this,current:this}));const r=Zn(this,s)[t];if(r){let i;for(let n=0,o=r.length;n<o&&(i=r[n],i.listener(e),i.once&&(this.off(t,i.listener,s),n--,o--),!e||!e.isStopNow);n++);}this.syncEventer&&this.syncEventer.emitEvent(e,s)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:s,__captureMap:r}=this,i=s&&s[t],n=r&&r[t];return!!(void 0===e?i||n:e?n:i)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Zn(t,e,s){if(e){const{__captureMap:e}=t;return e||(s?t.__captureMap={}:Vn)}{const{__bubbleMap:e}=t;return e||(s?t.__bubbleMap={}:Vn)}}const{on:Jn,on_:$n,off:Kn,off_:to,once:eo,emit:so,emitEvent:ro,hasEvent:io,destroy:no}=Qn.prototype,oo={on:Jn,on_:$n,off:Kn,off_:to,once:eo,emit:so,emitEvent:ro,hasEvent:io,destroyEventer:no},{isFinite:ao}=Number,ho=xt.get("setAttr"),lo={__setAttr(t,e,s){if(this.leaferIsCreated){const r=this.__.__getInput(t);if(s&&!ao(e)&&void 0!==e&&(ho.warn(this.innerName,t,e),e=void 0),"object"==typeof e||r!==e){this.__realSetAttr(t,e);const{CHANGE:s}=zn,i=new zn(s,this,t,r,e);return this.isLeafer?this.emitEvent(new zn(zn.LEAFER_CHANGE,this,t,r,e)):this.hasEvent(s)&&this.emitEvent(i),this.leafer.emitEvent(i),!0}return!1}return this.__realSetAttr(t,e),!0},__realSetAttr(t,e){const s=this.__;s[t]=e,this.__proxyData&&this.setProxyAttr(t,e),s.normalStyle&&(this.lockNormalStyle||void 0===s.normalStyle[t]||(s.normalStyle[t]=e))},__getAttr(t){return this.__proxyData?this.getProxyAttr(t):this.__.__get(t)}},{setLayout:uo,multiplyParent:co,translateInner:_o,defaultWorld:po}=b,{toPoint:fo,tempPoint:go}=pt,yo={__updateWorldMatrix(){co(this.__local||this.__layout,this.parent?this.parent.__world:po,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const t=this.__layout,e=this.__local,s=this.__;t.affectScaleOrRotation&&(t.scaleChanged||t.rotationChanged)&&(uo(e,s,null,null,t.affectRotation),t.scaleChanged=t.rotationChanged=!1),e.e=s.x+s.offsetX,e.f=s.y+s.offsetY,(s.around||s.origin)&&(fo(s.around||s.origin,t.boxBounds,go),_o(e,-go.x,-go.y,!s.around))}this.__layout.matrixChanged=!1}},{updateMatrix:mo,updateAllMatrix:xo}=fn,{updateBounds:wo}=Cn,{toOuterOf:bo,copyAndSpread:vo,copy:Bo}=it,{toBounds:ko}=Zr,Co={__updateWorldBounds(){bo(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const t=this.__layout;t.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),t.resized=!0),t.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),t.localBoxChanged=!1,t.strokeSpread&&(t.strokeChanged=!0),t.renderSpread&&(t.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),t.boxChanged=!1,t.strokeChanged&&(t.strokeSpread=this.__updateStrokeSpread(),t.strokeSpread?(t.strokeBounds===t.boxBounds&&t.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):t.spreadStrokeCancel(),t.strokeChanged=!1,(t.renderSpread||t.strokeSpread!==t.strokeBoxSpread)&&(t.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),t.resized=!0),t.renderChanged&&(t.renderSpread=this.__updateRenderSpread(),t.renderSpread?(t.renderBounds!==t.boxBounds&&t.renderBounds!==t.strokeBounds||t.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):t.spreadRenderCancel(),t.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),t.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),bo(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){bo(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){bo(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const t=this.__layout.boxBounds,e=this.__;e.__pathInputed?ko(e.path,t):(t.x=0,t.y=0,t.width=e.width,t.height=e.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leaferIsReady&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),xo(this),wo(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(xo(this),wo(this,this))):mo(this)},__updateNaturalSize(){const{__:t,__layout:e}=this;t.__naturalWidth=e.boxBounds.width,t.__naturalHeight=e.boxBounds.height},__updateStrokeBounds(){const t=this.__layout;vo(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(){const t=this.__layout;t.renderSpread>0?vo(t.renderBounds,t.boxBounds,t.renderSpread):Bo(t.renderBounds,t.strokeBounds)}},Oo={__render(t,e){if(this.__worldOpacity)if(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),t.opacity=this.__.opacity,this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!0,!0);this.__draw(s,e),this.__worldFlipped?t.copyWorldByReset(s,this.__nowWorld,null,this.__.__blendMode,!0):t.copyWorldToInner(s,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),s.recycle(this.__nowWorld)}else this.__draw(t,e)},__clip(t,e){this.__worldOpacity&&(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),this.__drawRenderPath(t),this.windingRule?t.clip(this.windingRule):t.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:To}=Bn,Po={__updateChange(){const{__layout:t}=this;t.childrenSortChanged&&(this.__updateSortChildren(),t.childrenSortChanged=!1),this.__.__checkSingle()},__render(t,e){if(this.__nowWorld=this.__getNowWorld(e),this.__worldOpacity)if(this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!1,!0);this.__renderBranch(s,e);const r=this.__nowWorld;t.opacity=this.__.opacity,t.copyWorldByReset(s,r,r,this.__.__blendMode,!0),s.recycle(r)}else this.__renderBranch(t,e)},__renderBranch(t,e){if(this.__hasMask)this.__renderMask(t,e);else{const{children:s}=this;for(let r=0,i=s.length;r<i;r++)To(s[r],e)||s[r].__render(t,e)}},__clip(t,e){if(this.__worldOpacity){const{children:s}=this;for(let r=0,i=s.length;r<i;r++)To(s[r],e)||s[r].__clip(t,e)}}},{LEAF:Ro,create:So}=s,{toInnerPoint:Lo,toOuterPoint:Eo,multiplyParent:Io}=b,{toOuterOf:Mo}=it,{copy:Ao,move:Wo}=E,{moveLocal:No,zoomOfLocal:Yo,rotateOfLocal:Do,skewOfLocal:Xo,moveWorld:zo,zoomOfWorld:Fo,rotateOfWorld:jo,skewOfWorld:Uo,transform:Go,transformWorld:Ho,setTransform:qo,getFlipTransform:Vo,getLocalOrigin:Qo,getRelativeWorld:Zo,drop:Jo}=fn;let $o=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return At}get __LayoutProcessor(){return Yn}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=So(Ro),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(Xn.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},null!==t&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(Xn.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(Xn.MOUNTED,t,"once")}nextRender(t,e,s){this.leafer?this.leafer.nextRender(t,e,s):this.waitLeafer((()=>this.leafer.nextRender(t,e,s)))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&null!==t&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(Xn.MOUNTED)):this.__emitLifeEvent(Xn.UNMOUNTED),this.isBranch){const{children:e}=this;for(let s=0,r=e.length;s<r;s++)e[s].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){void 0===t?t="width":"surface"===t&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=void 0===e?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=!!t||this.children.some((t=>t.__.eraser))}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:s}=this.__layout;t.clearRect(s.x,s.y,s.width,s.height),t.restore()}__updateMask(t){this.__hasMask=!!t||this.children.some((t=>t.__.mask))}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return Io(this.__world,t.matrix,e,void 0,this.__world),Mo(this.__layout.renderBounds,e,e),e}return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,s){return this.__layout.getLayoutBounds(t,e,s)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,s){const r=e?Zo(this,e):this.worldTransform,i=s?t:{};return Mo(t,r,i),i}worldToLocal(t,e,s,r){this.parent?this.parent.worldToInner(t,e,s,r):e&&Ao(e,t)}localToWorld(t,e,s,r){this.parent?this.parent.innerToWorld(t,e,s,r):e&&Ao(e,t)}worldToInner(t,e,s,r){r&&(r.innerToWorld(t,e,s),t=e||t),Lo(this.worldTransform,t,e,s)}innerToWorld(t,e,s,r){Eo(this.worldTransform,t,e,s),r&&r.worldToInner(e||t,null,s)}getBoxPoint(t,e,s,r){return this.getBoxPointByInner(this.getInnerPoint(t,e,s,r),null,null,!0)}getBoxPointByInner(t,e,s,r){const i=r?t:Object.assign({},t),{x:n,y:o}=this.boxBounds;return Wo(i,-n,-o),i}getInnerPoint(t,e,s,r){const i=r?t:{};return this.worldToInner(t,i,s,e),i}getInnerPointByBox(t,e,s,r){const i=r?t:Object.assign({},t),{x:n,y:o}=this.boxBounds;return Wo(i,n,o),i}getInnerPointByLocal(t,e,s,r){return this.getInnerPoint(t,this.parent,s,r)}getLocalPoint(t,e,s,r){const i=r?t:{};return this.worldToLocal(t,i,s,e),i}getLocalPointByInner(t,e,s,r){return this.getWorldPoint(t,this.parent,s,r)}getPagePoint(t,e,s,r){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,s,r)}getWorldPoint(t,e,s,r){const i=r?t:{};return this.innerToWorld(t,i,s,e),i}getWorldPointByBox(t,e,s,r){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,r),e,s,!0)}getWorldPointByLocal(t,e,s,r){const i=r?t:{};return this.localToWorld(t,i,s,e),i}getWorldPointByPage(t,e,s,r){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,s,r)}setTransform(t,e){qo(this,t,e)}transform(t,e){Go(this,t,e)}move(t,e){No(this,t,e)}moveInner(t,e){zo(this,t,e,!0)}scaleOf(t,e,s,r){Yo(this,Qo(this,t),e,s,r)}rotateOf(t,e){Do(this,Qo(this,t),e)}skewOf(t,e,s,r){Xo(this,Qo(this,t),e,s,r)}transformWorld(t,e){Ho(this,t,e)}moveWorld(t,e){zo(this,t,e)}scaleOfWorld(t,e,s,r){Fo(this,t,e,s,r)}rotateOfWorld(t,e){jo(this,t,e)}skewOfWorld(t,e,s,r){Uo(this,t,e,s,r)}flip(t){Go(this,Vo(this,t))}scaleResize(t,e=t,s){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,s,r){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Ct("path")}getMotionPoint(t){return Ct("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,s){Jo(this,t,e,s)}on(t,e,s){}off(t,e,s){}on_(t,e,s,r){}off_(t){}once(t,e,s){}emit(t,e,s){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,s){s?this.addAttr(t,e,s):Vi(this.prototype,t,e)}static addAttr(t,e,s){s||(s=Pi),s(e)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new Xn(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(Xn.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}};$o=Dt([en(lo),en(yo),en(Co),en(oo),en(Oo)],$o);const{setListWithFn:Ko}=it,{sort:ta}=Cn,{localBoxBounds:ea,localStrokeBounds:sa,localRenderBounds:ra,maskLocalBoxBounds:ia,maskLocalStrokeBounds:na,maskLocalRenderBounds:oa}=Bn;let aa=class extends $o{__updateStrokeSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){Ko(this.__layout.boxBounds,this.children,this.__hasMask?ia:ea)}__updateStrokeBounds(){Ko(this.__layout.strokeBounds,this.children,this.__hasMask?na:sa)}__updateRenderBounds(){Ko(this.__layout.renderBounds,this.children,this.__hasMask?oa:ra)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let s=0,r=e.length;s<r;s++)e[s].__tempNumber=s,e[s].__.zIndex&&(t=!0);e.sort(ta),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this)return;const s=void 0===e;if(!t.__){if(t instanceof Array)return t.forEach((t=>{this.add(t,e),s||e++}));t=Tt.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,s?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(Xn.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(Xn.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",(()=>this.__remove(t,e))):this.__remove(t,e):this.find(t).forEach((t=>this.remove(t,e))):void 0===t&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach((e=>{this.__realRemoveChild(e),t&&e.destroy()})))}clear(){this.removeAll(!0)}__remove(t,e){const s=this.children.indexOf(t);s>-1&&(this.children.splice(s,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(Xn.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(Xn.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const s=new Xn(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(s),this.leafer.emitEvent(s)}};aa=Dt([en(Po)],aa);class ha{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&void 0!==this.keys[t.innerId]}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return void 0===e?-1:e}add(t){const{list:e,keys:s}=this;void 0===s[t.innerId]&&(e.push(t),s[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:s}=this;if(void 0===s[t.innerId]){const{list:r}=this;for(let t=e,i=r.length;t<i;t++)s[r[t].innerId]++;0===e?r.unshift(t):(e>r.length&&(e=r.length),r.splice(e,0,t)),s[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let s;for(let r=0,i=e.length;r<i;r++)void 0!==s?this.keys[e[r].innerId]=r-1:e[r].innerId===t.innerId&&(s=r,delete this.keys[t.innerId]);void 0!==s&&e.splice(s,1)}sort(t){const{list:e}=this;t?e.sort(((t,e)=>e.__level-t.__level)):e.sort(((t,e)=>t.__level-e.__level))}forEach(t){this.list.forEach(t)}clone(){const t=new ha;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let s=0,r=t.length;s<r;s++)e[t[s].innerId]=s}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class la{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return void 0!==this.keys[t.innerId]}without(t){return void 0===this.keys[t.innerId]}sort(t){const{levels:e}=this;t?e.sort(((t,e)=>e-t)):e.sort(((t,e)=>t-e))}addList(t){t.forEach((t=>{this.add(t)}))}add(t){const{keys:e,levelMap:s}=this;e[t.innerId]||(e[t.innerId]=1,s[t.__level]?s[t.__level].push(t):(s[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach((s=>{e=this.levelMap[s];for(let s=0,r=e.length;s<r;s++)t(e[s])}))}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}const da="1.0.10";export{yt as AlignHelper,Wt as Answer,pt as AroundHelper,dt as AutoBounds,ke as BezierHelper,ht as Bounds,it as BoundsHelper,aa as Branch,Cn as BranchHelper,Po as BranchRender,Et as CanvasManager,Xn as ChildEvent,e as Creator,It as DataHelper,xt as Debug,ut as Direction4,ct as Direction9,Ie as EllipseHelper,Dn as Event,St as EventCreator,Qn as Eventer,hi as FileHelper,Fn as ImageEvent,_i as ImageManager,s as IncrementId,Gn as LayoutEvent,$o as Leaf,Co as LeafBounds,Bn as LeafBoundsHelper,At as LeafData,lo as LeafDataProxy,oo as LeafEventer,fn as LeafHelper,Yn as LeafLayout,la as LeafLevelList,ha as LeafList,yo as LeafMatrix,Oo as LeafRender,Qt as LeaferCanvasBase,qn as LeaferEvent,yi as LeaferImage,a as MathHelper,D as Matrix,b as MatrixHelper,te as NeedConvertToCanvasCommandMap,h as OneRadian,l as PI2,d as PI_2,Zr as PathBounds,Xs as PathCommandDataHelper,$t as PathCommandMap,ys as PathConvert,ii as PathCorner,rr as PathCreator,mr as PathDrawer,Zt as PathHelper,ie as PathNumberCommandLengthMap,re as PathNumberCommandMap,t as Platform,N as Point,E as PointHelper,zn as PropertyEvent,ne as RectHelper,Hn as RenderEvent,jn as ResizeEvent,Bt as Run,mt as StringNumberMap,ui as TaskItem,ci as TaskProcessor,z as TwoPointBoundsHelper,Tt as UICreator,Rn as WaitHelper,Un as WatchEvent,Wi as affectRenderBoundsType,Ii as affectStrokeBoundsType,bi as attr,Ci as autoLayoutType,Pi as boundsType,ai as canvasPatch,Vt as canvasSizeAttrs,Gi as cursorType,Hi as dataProcessor,Bi as dataType,wi as decorateLeafAttr,Vi as defineDataProcessor,mi as defineKey,vi as defineLeafAttr,Si as doBoundsType,Mi as doStrokeType,Nt as emptyData,ji as eraserType,c as getBoundsData,xi as getDescriptor,_ as getMatrixData,u as getPointData,Ui as hitType,Yt as isNull,qi as layoutProcessor,Fi as maskType,Ri as naturalBoundsType,Ct as needPlugin,Yi as opacityType,Li as pathInputType,Ei as pathType,ni as pen,ki as positionType,sn as registerUI,rn as registerUIEvent,$i as rewrite,Ki as rewriteAble,Ti as rotationType,Oi as scaleType,zi as sortType,Ai as strokeType,Ni as surfaceType,lt as tempBounds,X as tempMatrix,Y as tempPoint,en as useModule,da as version,Di as visibleType};
