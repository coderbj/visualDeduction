var LeaferUI=function(t){"use strict";const e={toURL(t,e){let s=encodeURIComponent(t);return"text"===e?s="data:text/plain;charset=utf-8,"+s:"svg"===e&&(s="data:image/svg+xml,"+s),s},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:"anonymous",getRealURL(t){const{prefix:s,suffix:i}=e.image;return!i||t.startsWith("data:")||t.startsWith("blob:")||(t+=(t.includes("?")?"&":"?")+i),s&&"/"===t[0]&&(t=s+t),t}}},s={},i={RUNTIME:"runtime",LEAF:"leaf",TASK:"task",CNAVAS:"canvas",IMAGE:"image",types:{},create(t){const{types:e}=r;return e[t]?e[t]++:(e[t]=1,0)}},r=i,{round:o,pow:n,PI:a}=Math,h={within:(t,e,s)=>("object"==typeof e&&(s=e.max,e=e.min),void 0!==e&&t<e&&(t=e),void 0!==s&&t>s&&(t=s),t),fourNumber(t,e){let s;if(t instanceof Array)switch(t.length){case 4:s=void 0===e?t:[...t];break;case 2:s=[t[0],t[1],t[0],t[1]];break;case 3:s=[t[0],t[1],t[2],t[1]];break;case 1:t=t[0];break;default:t=0}if(s||(s=[t,t,t,t]),e)for(let t=0;t<4;t++)s[t]>e&&(s[t]=e);return s},formatRotation:(t,e)=>(t%=360,e?t<0&&(t+=360):(t>180&&(t-=360),t<-180&&(t+=360)),h.float(t)),getGapRotation(t,e,s=0){let i=t+s;if(e>1){const t=Math.abs(i%e);(t<1||t>e-1)&&(i=Math.round(i/e)*e)}return i-s},float(t,e){const s=e?n(10,e):1e12;return-0===(t=o(t*s)/s)?0:t},getScaleData:(t,e,s,i)=>(i||(i={}),e?(i.scaleX=("number"==typeof e?e:e.width)/s.width,i.scaleY=("number"==typeof e?e:e.height)/s.height):t&&h.assignScale(i,t),i),assignScale(t,e){"number"==typeof e?t.scaleX=t.scaleY=e:(t.scaleX=e.x,t.scaleY=e.y)}},l=a/180,d=2*a,c=a/2;function u(){return{x:0,y:0}}function _(){return{x:0,y:0,width:0,height:0}}function p(){return{a:1,b:0,c:0,d:1,e:0,f:0}}const{sin:g,cos:f,acos:y,sqrt:m}=Math,{float:w}=h,x={};function v(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}const b={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:v(),tempMatrix:{},set(t,e=1,s=0,i=0,r=1,o=0,n=0){t.a=e,t.b=s,t.c=i,t.d=r,t.e=o,t.f=n},get:p,getWorld:v,copy(t,e){t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.e=e.e,t.f=e.f},translate(t,e,s){t.e+=e,t.f+=s},translateInner(t,e,s,i){t.e+=t.a*e+t.c*s,t.f+=t.b*e+t.d*s,i&&(t.e-=e,t.f-=s)},scale(t,e,s=e){t.a*=e,t.b*=e,t.c*=s,t.d*=s},scaleOfOuter(t,e,s,i){B.toInnerPoint(t,e,x),B.scaleOfInner(t,x,s,i)},scaleOfInner(t,e,s,i=s){B.translateInner(t,e.x,e.y),B.scale(t,s,i),B.translateInner(t,-e.x,-e.y)},rotate(t,e){const{a:s,b:i,c:r,d:o}=t,n=f(e*=l),a=g(e);t.a=s*n-i*a,t.b=s*a+i*n,t.c=r*n-o*a,t.d=r*a+o*n},rotateOfOuter(t,e,s){B.toInnerPoint(t,e,x),B.rotateOfInner(t,x,s)},rotateOfInner(t,e,s){B.translateInner(t,e.x,e.y),B.rotate(t,s),B.translateInner(t,-e.x,-e.y)},skew(t,e,s){const{a:i,b:r,c:o,d:n}=t;s&&(s*=l,t.a=i+o*s,t.b=r+n*s),e&&(e*=l,t.c=o+i*e,t.d=n+r*e)},skewOfOuter(t,e,s,i){B.toInnerPoint(t,e,x),B.skewOfInner(t,x,s,i)},skewOfInner(t,e,s,i=0){B.translateInner(t,e.x,e.y),B.skew(t,s,i),B.translateInner(t,-e.x,-e.y)},multiply(t,e){const{a:s,b:i,c:r,d:o,e:n,f:a}=t;t.a=e.a*s+e.b*r,t.b=e.a*i+e.b*o,t.c=e.c*s+e.d*r,t.d=e.c*i+e.d*o,t.e=e.e*s+e.f*r+n,t.f=e.e*i+e.f*o+a},multiplyParent(t,e,s,i,r,o){let{e:n,f:a}=t;if(o&&(n+=o.scrollX,a+=o.scrollY),s||(s=t),void 0===i&&(i=1!==t.a||t.b||t.c||1!==t.d),i){const{a:i,b:o,c:n,d:a}=t;s.a=i*e.a+o*e.c,s.b=i*e.b+o*e.d,s.c=n*e.a+a*e.c,s.d=n*e.b+a*e.d,r&&(s.scaleX=e.scaleX*r.scaleX,s.scaleY=e.scaleY*r.scaleY)}else s.a=e.a,s.b=e.b,s.c=e.c,s.d=e.d,r&&(s.scaleX=e.scaleX,s.scaleY=e.scaleY);s.e=n*e.a+a*e.c+e.e,s.f=n*e.b+a*e.d+e.f},divide(t,e){B.multiply(t,B.tempInvert(e))},divideParent(t,e){B.multiplyParent(t,B.tempInvert(e))},tempInvert(t){const{tempMatrix:e}=B;return B.copy(e,t),B.invert(e),e},invert(t){const{a:e,b:s,c:i,d:r,e:o,f:n}=t;if(s||i){const a=1/(e*r-s*i);t.a=r*a,t.b=-s*a,t.c=-i*a,t.d=e*a,t.e=-(o*r-n*i)*a,t.f=-(n*e-o*s)*a}else if(1===e&&1===r)t.e=-o,t.f=-n;else{const s=1/(e*r);t.a=r*s,t.d=e*s,t.e=-o*r*s,t.f=-n*e*s}},toOuterPoint(t,e,s,i){const{x:r,y:o}=e;s||(s=e),s.x=r*t.a+o*t.c,s.y=r*t.b+o*t.d,i||(s.x+=t.e,s.y+=t.f)},toInnerPoint(t,e,s,i){const{a:r,b:o,c:n,d:a}=t,h=1/(r*a-o*n),{x:l,y:d}=e;if(s||(s=e),s.x=(l*a-d*n)*h,s.y=(d*r-l*o)*h,!i){const{e:e,f:i}=t;s.x-=(e*a-i*n)*h,s.y-=(i*r-e*o)*h}},setLayout(t,e,s,i,r){const{x:o,y:n,scaleX:a,scaleY:h}=e;if(void 0===r&&(r=e.rotation||e.skewX||e.skewY),r){const{rotation:s,skewX:i,skewY:r}=e,o=s*l,n=f(o),d=g(o);if(i||r){const e=i*l,s=r*l;t.a=(n+s*-d)*a,t.b=(d+s*n)*a,t.c=(e*n-d)*h,t.d=(n+e*d)*h}else t.a=n*a,t.b=d*a,t.c=-d*h,t.d=n*h}else t.a=a,t.b=0,t.c=0,t.d=h;t.e=o,t.f=n,(s=s||i)&&B.translateInner(t,-s.x,-s.y,!i)},getLayout(t,e,s,i){const{a:r,b:o,c:n,d:a,e:h,f:d}=t;let u,_,p,x,v,b=h,B=d;if(o||n){const t=r*a-o*n;if(n&&!i){u=m(r*r+o*o),_=t/u;const e=r/u;p=o>0?y(e):-y(e)}else{_=m(n*n+a*a),u=t/_;const e=n/_;p=c-(a>0?y(-e):-y(e))}const e=w(f(p)),s=g(p);u=w(u),_=w(_),x=e?w((n/_+s)/e/l,9):0,v=e?w((o/u-s)/e/l,9):0,p=w(p/l)}else u=r,_=a,p=x=v=0;return(e=s||e)&&(b+=e.x*r+e.y*n,B+=e.x*o+e.y*a,s||(b-=e.x,B-=e.y)),{x:b,y:B,scaleX:u,scaleY:_,rotation:p,skewX:x,skewY:v}},withScale(t,e,s=e){const i=t;if(!e||!s){const{a:i,b:r,c:o,d:n}=t;r||o?s=(i*n-r*o)/(e=m(i*i+r*r)):(e=i,s=n)}return i.scaleX=e,i.scaleY=s,i},reset(t){B.set(t)}},B=b,{toInnerPoint:k,toOuterPoint:R}=b,{sin:C,cos:S,abs:T,sqrt:P,atan2:L,min:I,PI:O}=Math,E={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(t,e=0,s=0){t.x=e,t.y=s},setRadius(t,e,s){t.radiusX=e,t.radiusY=void 0===s?e:s},copy(t,e){t.x=e.x,t.y=e.y},copyFrom(t,e,s){t.x=e,t.y=s},move(t,e,s){t.x+=e,t.y+=s},scale(t,e,s=e){t.x&&(t.x*=e),t.y&&(t.y*=s)},scaleOf(t,e,s,i=s){t.x+=(t.x-e.x)*(s-1),t.y+=(t.y-e.y)*(i-1)},rotate(t,e,s){s||(s=A.defaultPoint);const i=S(e*=l),r=C(e),o=t.x-s.x,n=t.y-s.y;t.x=s.x+o*i-n*r,t.y=s.y+o*r+n*i},tempToInnerOf(t,e){const{tempPoint:s}=A;return W(s,t),k(e,s,s),s},tempToOuterOf(t,e){const{tempPoint:s}=A;return W(s,t),R(e,s,s),s},tempToInnerRadiusPointOf(t,e){const{tempRadiusPoint:s}=A;return W(s,t),A.toInnerRadiusPointOf(t,e,s),s},toInnerRadiusPointOf(t,e,s){s||(s=t),k(e,t,s),s.radiusX=Math.abs(t.radiusX/e.scaleX),s.radiusY=Math.abs(t.radiusY/e.scaleY)},toInnerOf(t,e,s){k(e,t,s)},toOuterOf(t,e,s){R(e,t,s)},getCenter:(t,e)=>({x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}),getCenterX:(t,e)=>t+(e-t)/2,getCenterY:(t,e)=>t+(e-t)/2,getDistance:(t,e)=>M(t.x,t.y,e.x,e.y),getDistanceFrom(t,e,s,i){const r=T(s-t),o=T(i-e);return P(r*r+o*o)},getMinDistanceFrom:(t,e,s,i,r,o)=>I(M(t,e,s,i),M(s,i,r,o)),getAngle:(t,e)=>D(t,e)/l,getRotation:(t,e,s,i)=>(i||(i=e),A.getRadianFrom(t.x,t.y,e.x,e.y,s.x,s.y,i.x,i.y)/l),getRadianFrom(t,e,s,i,r,o,n,a){void 0===n&&(n=s,a=i);let h=L(e-i,t-s);const l=L(o-a,r-n)-h;return l<-O?l+d:l},getAtan2:(t,e)=>L(e.y-t.y,e.x-t.x),getDistancePoint(t,e,s,i){const r=D(t,e);return(e=i?e:{}).x=t.x+S(r)*s,e.y=t.y+C(r)*s,e},toNumberPoints(t){let e=t;return"object"==typeof t[0]&&(e=[],t.forEach((t=>e.push(t.x,t.y)))),e},reset(t){A.reset(t)}},A=E,{getDistanceFrom:M,copy:W,getAtan2:D}=A;class F{constructor(t,e){this.set(t,e)}set(t,e){return"object"==typeof t?E.copy(this,t):E.set(this,t,e),this}get(){const{x:t,y:e}=this;return{x:t,y:e}}clone(){return new F(this)}move(t,e){return E.move(this,t,e),this}scale(t,e){return E.scale(this,t,e),this}scaleOf(t,e,s){return E.scaleOf(this,t,e,s),this}rotate(t,e){return E.rotate(this,t,e),this}rotateOf(t,e){return E.rotate(this,e,t),this}getRotation(t,e,s){return E.getRotation(this,t,e,s)}toInnerOf(t,e){return E.toInnerOf(this,t,e),this}toOuterOf(t,e){return E.toOuterOf(this,t,e),this}getCenter(t){return new F(E.getCenter(this,t))}getDistance(t){return E.getDistance(this,t)}getDistancePoint(t,e,s){return new F(E.getDistancePoint(this,t,e,s))}getAngle(t){return E.getAngle(this,t)}getAtan2(t){return E.getAtan2(this,t)}reset(){return E.reset(this),this}}const z=new F;class U{constructor(t,e,s,i,r,o){this.set(t,e,s,i,r,o)}set(t,e,s,i,r,o){return"object"==typeof t?b.copy(this,t):b.set(this,t,e,s,i,r,o),this}setWith(t){return b.copy(this,t),this.scaleX=t.scaleX,this.scaleY=t.scaleY,this}get(){const{a:t,b:e,c:s,d:i,e:r,f:o}=this;return{a:t,b:e,c:s,d:i,e:r,f:o}}clone(){return new U(this)}translate(t,e){return b.translate(this,t,e),this}translateInner(t,e){return b.translateInner(this,t,e),this}scale(t,e){return b.scale(this,t,e),this}scaleWith(t,e){return b.scale(this,t,e),this.scaleX*=t,this.scaleY*=e||t,this}scaleOfOuter(t,e,s){return b.scaleOfOuter(this,t,e,s),this}scaleOfInner(t,e,s){return b.scaleOfInner(this,t,e,s),this}rotate(t){return b.rotate(this,t),this}rotateOfOuter(t,e){return b.rotateOfOuter(this,t,e),this}rotateOfInner(t,e){return b.rotateOfInner(this,t,e),this}skew(t,e){return b.skew(this,t,e),this}skewOfOuter(t,e,s){return b.skewOfOuter(this,t,e,s),this}skewOfInner(t,e,s){return b.skewOfInner(this,t,e,s),this}multiply(t){return b.multiply(this,t),this}multiplyParent(t){return b.multiplyParent(this,t),this}divide(t){return b.divide(this,t),this}divideParent(t){return b.divideParent(this,t),this}invert(){return b.invert(this),this}invertWith(){return b.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(t,e,s){b.toOuterPoint(this,t,e,s)}toInnerPoint(t,e,s){b.toInnerPoint(this,t,e,s)}setLayout(t,e,s){return b.setLayout(this,t,e,s),this}getLayout(t,e,s){return b.getLayout(this,t,e,s)}withScale(t,e){return b.withScale(this,t,e)}reset(){b.reset(this)}}const N=new U,Y={tempPointBounds:{},setPoint(t,e,s){t.minX=t.maxX=e,t.minY=t.maxY=s},addPoint(t,e,s){t.minX=e<t.minX?e:t.minX,t.minY=s<t.minY?s:t.minY,t.maxX=e>t.maxX?e:t.maxX,t.maxY=s>t.maxY?s:t.maxY},addBounds(t,e,s,i,r){X(t,e,s),X(t,e+i,s+r)},copy(t,e){t.minX=e.minX,t.minY=e.minY,t.maxX=e.maxX,t.maxY=e.maxY},addPointBounds(t,e){t.minX=e.minX<t.minX?e.minX:t.minX,t.minY=e.minY<t.minY?e.minY:t.minY,t.maxX=e.maxX>t.maxX?e.maxX:t.maxX,t.maxY=e.maxY>t.maxY?e.maxY:t.maxY},toBounds(t,e){e.x=t.minX,e.y=t.minY,e.width=t.maxX-t.minX,e.height=t.maxY-t.minY}},{addPoint:X}=Y,{tempPointBounds:j,setPoint:H,addPoint:V,toBounds:G}=Y,{toOuterPoint:q}=b,{float:Q,fourNumber:J}=h,{floor:$,ceil:Z}=Math;let K,tt,et,st;const it={},rt={},ot={tempBounds:{},set(t,e=0,s=0,i=0,r=0){t.x=e,t.y=s,t.width=i,t.height=r},copy(t,e){t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},copyAndSpread(t,e,s,i,r){const{x:o,y:n,width:a,height:h}=e;if(s instanceof Array){const e=J(s);i?nt.set(t,o+e[3],n+e[0],a-e[1]-e[3],h-e[2]-e[0]):nt.set(t,o-e[3],n-e[0],a+e[1]+e[3],h+e[2]+e[0])}else i&&(s=-s),nt.set(t,o-s,n-s,a+2*s,h+2*s);r&&("width"===r?(t.y=n,t.height=h):(t.x=o,t.width=a))},minX:t=>t.width>0?t.x:t.x+t.width,minY:t=>t.height>0?t.y:t.y+t.height,maxX:t=>t.width>0?t.x+t.width:t.x,maxY:t=>t.height>0?t.y+t.height:t.y,move(t,e,s){t.x+=e,t.y+=s},getByMove:(t,e,s)=>(t=Object.assign({},t),nt.move(t,e,s),t),toOffsetOutBounds(t,e,s){e?ht(e,t):e=t,s?(e.offsetX=-(nt.maxX(s)-t.x),e.offsetY=-(nt.maxY(s)-t.y)):(e.offsetX=t.x+t.width,e.offsetY=t.y+t.height),nt.move(e,-e.offsetX,-e.offsetY)},scale(t,e,s=e){E.scale(t,e,s),t.width*=e,t.height*=s},scaleOf(t,e,s,i=s){E.scaleOf(t,e,s,i),t.width*=s,t.height*=i},tempToOuterOf:(t,e)=>(nt.copy(nt.tempBounds,t),nt.toOuterOf(nt.tempBounds,e),nt.tempBounds),getOuterOf:(t,e)=>(t=Object.assign({},t),nt.toOuterOf(t,e),t),toOuterOf(t,e,s){if(s||(s=t),0===e.b&&0===e.c){const{a:i,d:r}=e;i>0?(s.width=t.width*i,s.x=e.e+t.x*i):(s.width=t.width*-i,s.x=e.e+t.x*i-s.width),r>0?(s.height=t.height*r,s.y=e.f+t.y*r):(s.height=t.height*-r,s.y=e.f+t.y*r-s.height)}else it.x=t.x,it.y=t.y,q(e,it,rt),H(j,rt.x,rt.y),it.x=t.x+t.width,q(e,it,rt),V(j,rt.x,rt.y),it.y=t.y+t.height,q(e,it,rt),V(j,rt.x,rt.y),it.x=t.x,q(e,it,rt),V(j,rt.x,rt.y),G(j,s)},toInnerOf(t,e,s){s||(s=t),nt.move(s,-e.e,-e.f),nt.scale(s,1/e.a,1/e.d)},getFitMatrix(t,e,s=1){const i=Math.min(s,Math.min(t.width/e.width,t.height/e.height));return new U(i,0,0,i,-e.x*i,-e.y*i)},getSpread(t,e,s){const i={};return nt.copyAndSpread(i,t,e,!1,s),i},spread(t,e,s){nt.copyAndSpread(t,t,e,!1,s)},shrink(t,e,s){nt.copyAndSpread(t,t,e,!0,s)},ceil(t){const{x:e,y:s}=t;t.x=$(t.x),t.y=$(t.y),t.width=e>t.x?Z(t.width+e-t.x):Z(t.width),t.height=s>t.y?Z(t.height+s-t.y):Z(t.height)},unsign(t){t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height)},float(t,e){t.x=Q(t.x,e),t.y=Q(t.y,e),t.width=Q(t.width,e),t.height=Q(t.height,e)},add(t,e,s){K=t.x+t.width,tt=t.y+t.height,et=e.x,st=e.y,s||(et+=e.width,st+=e.height),K=K>et?K:et,tt=tt>st?tt:st,t.x=t.x<e.x?t.x:e.x,t.y=t.y<e.y?t.y:e.y,t.width=K-t.x,t.height=tt-t.y},addList(t,e){nt.setListWithFn(t,e,void 0,!0)},setList(t,e,s=!1){nt.setListWithFn(t,e,void 0,s)},addListWithFn(t,e,s){nt.setListWithFn(t,e,s,!0)},setListWithFn(t,e,s,i=!1){let r,o=!0;for(let n=0,a=e.length;n<a;n++)r=s?s(e[n]):e[n],r&&(r.width||r.height)&&(o?(o=!1,i||ht(t,r)):at(t,r));o&&nt.reset(t)},setPoints(t,e){e.forEach(((t,e)=>0===e?H(j,t.x,t.y):V(j,t.x,t.y))),G(j,t)},setPoint(t,e){nt.set(t,e.x,e.y)},addPoint(t,e){at(t,e,!0)},getPoints(t){const{x:e,y:s,width:i,height:r}=t;return[{x:e,y:s},{x:e+i,y:s},{x:e+i,y:s+r},{x:e,y:s+r}]},hitRadiusPoint:(t,e,s)=>(s&&(e=E.tempToInnerRadiusPointOf(e,s)),e.x>=t.x-e.radiusX&&e.x<=t.x+t.width+e.radiusX&&e.y>=t.y-e.radiusY&&e.y<=t.y+t.height+e.radiusY),hitPoint:(t,e,s)=>(s&&(e=E.tempToInnerOf(e,s)),e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height),hit:(t,e,s)=>(s&&(e=nt.tempToOuterOf(e,s)),!(t.y+t.height<e.y||e.y+e.height<t.y||t.x+t.width<e.x||e.x+e.width<t.x)),includes:(t,e,s)=>(s&&(e=nt.tempToOuterOf(e,s)),t.x<=e.x&&t.y<=e.y&&t.x+t.width>=e.x+e.width&&t.y+t.height>=e.y+e.height),getIntersectData(t,e,s){if(s&&(e=nt.tempToOuterOf(e,s)),!nt.hit(t,e))return{x:0,y:0,width:0,height:0};let{x:i,y:r,width:o,height:n}=e;return K=i+o,tt=r+n,et=t.x+t.width,st=t.y+t.height,i=i>t.x?i:t.x,r=r>t.y?r:t.y,K=K<et?K:et,tt=tt<st?tt:st,o=K-i,n=tt-r,{x:i,y:r,width:o,height:n}},intersect(t,e,s){nt.copy(t,nt.getIntersectData(t,e,s))},isSame:(t,e)=>t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height,isEmpty:t=>0===t.x&&0===t.y&&0===t.width&&0===t.height,reset(t){nt.set(t)}},nt=ot,{add:at,copy:ht}=nt;class lt{get minX(){return ot.minX(this)}get minY(){return ot.minY(this)}get maxX(){return ot.maxX(this)}get maxY(){return ot.maxY(this)}constructor(t,e,s,i){this.set(t,e,s,i)}set(t,e,s,i){return"object"==typeof t?ot.copy(this,t):ot.set(this,t,e,s,i),this}get(){const{x:t,y:e,width:s,height:i}=this;return{x:t,y:e,width:s,height:i}}clone(){return new lt(this)}move(t,e){return ot.move(this,t,e),this}scale(t,e){return ot.scale(this,t,e),this}scaleOf(t,e,s){return ot.scaleOf(this,t,e,s),this}toOuterOf(t,e){return ot.toOuterOf(this,t,e),this}toInnerOf(t,e){return ot.toInnerOf(this,t,e),this}getFitMatrix(t,e){return ot.getFitMatrix(this,t,e)}spread(t,e){return ot.spread(this,t,e),this}shrink(t,e){return ot.shrink(this,t,e),this}ceil(){return ot.ceil(this),this}unsign(){return ot.unsign(this),this}float(t){return ot.float(this,t),this}add(t){return ot.add(this,t),this}addList(t){return ot.setList(this,t,!0),this}setList(t){return ot.setList(this,t),this}addListWithFn(t,e){return ot.setListWithFn(this,t,e,!0),this}setListWithFn(t,e){return ot.setListWithFn(this,t,e),this}setPoint(t){return ot.setPoint(this,t),this}setPoints(t){return ot.setPoints(this,t),this}addPoint(t){return ot.addPoint(this,t),this}getPoints(){return ot.getPoints(this)}hitPoint(t,e){return ot.hitPoint(this,t,e)}hitRadiusPoint(t,e){return ot.hitRadiusPoint(this,t,e)}hit(t,e){return ot.hit(this,t,e)}includes(t,e){return ot.includes(this,t,e)}intersect(t,e){return ot.intersect(this,t,e),this}getIntersect(t,e){return new lt(ot.getIntersectData(this,t,e))}isSame(t){return ot.isSame(this,t)}isEmpty(){return ot.isEmpty(this)}reset(){ot.reset(this)}}const dt=new lt;class ct{constructor(t,e,s,i,r,o){"object"==typeof t?this.copy(t):this.set(t,e,s,i,r,o)}set(t=0,e=0,s=0,i=0,r=0,o=0){this.top=t,this.right=e,this.bottom=s,this.left=i,this.width=r,this.height=o}copy(t){const{top:e,right:s,bottom:i,left:r,width:o,height:n}=t;this.set(e,s,i,r,o,n)}getBoundsFrom(t){const{top:e,right:s,bottom:i,left:r,width:o,height:n}=this;return new lt(r,e,o||t.width-r-s,n||t.height-e-i)}}var ut,_t;t.Direction4=void 0,(ut=t.Direction4||(t.Direction4={}))[ut.top=0]="top",ut[ut.right=1]="right",ut[ut.bottom=2]="bottom",ut[ut.left=3]="left",t.Direction9=void 0,(_t=t.Direction9||(t.Direction9={}))[_t.topLeft=0]="topLeft",_t[_t.top=1]="top",_t[_t.topRight=2]="topRight",_t[_t.right=3]="right",_t[_t.bottomRight=4]="bottomRight",_t[_t.bottom=5]="bottom",_t[_t.bottomLeft=6]="bottomLeft",_t[_t.left=7]="left",_t[_t.center=8]="center",_t[_t["top-left"]=0]="top-left",_t[_t["top-right"]=2]="top-right",_t[_t["bottom-right"]=4]="bottom-right",_t[_t["bottom-left"]=6]="bottom-left";const pt=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];pt.forEach((t=>t.type="percent"));const gt={directionData:pt,tempPoint:{},get:ft,toPoint(t,e,s,i,r){const o=ft(t);s.x=o.x,s.y=o.y,"percent"===o.type&&(s.x*=e.width,s.y*=e.height,r&&(s.x-=r.x,s.y-=r.y,o.x&&(s.x-=1===o.x?r.width:.5===o.x?o.x*r.width:0),o.y&&(s.y-=1===o.y?r.height:.5===o.y?o.y*r.height:0))),i||(s.x+=e.x,s.y+=e.y)}};function ft(e){return"string"==typeof e?pt[t.Direction9[e]]:e}const{toPoint:yt}=gt,mt={toPoint(t,e,s,i,r){yt(t,s,i,r,e)}},wt={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1};class xt{constructor(t){this.repeatMap={},this.name=t}static get(t){return new xt(t)}static set filter(t){this.filterList=vt(t)}static set exclude(t){this.excludeList=vt(t)}log(...t){if(bt.enable){if(bt.filterList.length&&bt.filterList.every((t=>t!==this.name)))return;if(bt.excludeList.length&&bt.excludeList.some((t=>t===this.name)))return;console.log("%c"+this.name,"color:#21ae62",...t)}}tip(...t){bt.enable&&this.warn(...t)}warn(...t){bt.showWarn&&console.warn(this.name,...t)}repeat(t,...e){this.repeatMap[t]||(this.warn("repeat:"+t,...e),this.repeatMap[t]=!0)}error(...t){try{throw new Error}catch(e){console.error(this.name,...t,e)}}}function vt(t){return t?"string"==typeof t&&(t=[t]):t=[],t}xt.filterList=[],xt.excludeList=[],xt.showWarn=!0;const bt=xt,Bt=xt.get("RunTime"),kt={currentId:0,currentName:"",idMap:{},nameMap:{},nameToIdMap:{},start(t,e){const s=i.create(i.RUNTIME);return Rt.currentId=Rt.idMap[s]=e?performance.now():Date.now(),Rt.currentName=Rt.nameMap[s]=t,Rt.nameToIdMap[t]=s,s},end(t,e){const s=Rt.idMap[t],i=Rt.nameMap[t],r=e?(performance.now()-s)/1e3:Date.now()-s;Rt.idMap[t]=Rt.nameMap[t]=Rt.nameToIdMap[i]=void 0,Bt.log(i,r,"ms")},endOfName(t,e){const s=Rt.nameToIdMap[t];void 0!==s&&Rt.end(s,e)}},Rt=kt;function Ct(t){console.error("need plugin: @leafer-in/"+t)}const St=xt.get("UICreator"),Tt={list:{},register(t){const{__tag:e}=t.prototype;Pt[e]&&St.repeat(e),Pt[e]=t},get(t,e,s,i,r,o){Pt[t]||St.error("not register "+t);const n=new Pt[t](e);return void 0!==s&&(n.x=s,i&&(n.y=i),r&&(n.width=r),o&&(n.height=o)),n}},{list:Pt}=Tt,Lt=xt.get("EventCreator"),It={nameList:{},register(t){let e;Object.keys(t).forEach((s=>{e=t[s],"string"==typeof e&&(Ot[e]&&Lt.repeat(e),Ot[e]=t)}))},changeName(t,e){const s=Ot[t];if(s){const i=Object.keys(s).find((e=>s[e]===t));i&&(s[i]=e,Ot[e]=s)}},has(t){return!!this.nameList[t]},get:(t,...e)=>new Ot[t](...e)},{nameList:Ot}=It;class Et{constructor(){this.list=[]}add(t){t.manager=this,this.list.push(t)}get(t){let e;const{list:i}=this;for(let s=0,r=i.length;s<r;s++)if(e=i[s],e.recycled&&e.isSameSize(t))return e.recycled=!1,e.manager||(e.manager=this),e;const r=s.canvas(t);return this.add(r),r}recycle(t){t.recycled=!0}clearRecycled(){let t;const e=[];for(let s=0,i=this.list.length;s<i;s++)t=this.list[s],t.recycled?t.destroy():e.push(t);this.list=e}clear(){this.list.forEach((t=>{t.destroy()})),this.list.length=0}destroy(){this.clear()}}const At={default:(t,e)=>(Mt(e,t),Mt(t,e),t),assign(t,e){let s;Object.keys(e).forEach((i=>{var r;s=e[i],(null==s?void 0:s.constructor)===Object&&(null===(r=t[i])||void 0===r?void 0:r.constructor)===Object?Mt(t[i],e[i]):t[i]=e[i]}))},copyAttrs:(t,e,s)=>(s.forEach((s=>{void 0!==e[s]&&(t[s]=e[s])})),t),clone:t=>JSON.parse(JSON.stringify(t)),toMap(t){const e={};for(let s=0,i=t.length;s<i;s++)e[t[s]]=!0;return e}},{assign:Mt}=At;class Wt{get __useNaturalRatio(){return!0}get __isLinePath(){const{path:t}=this;return t&&6===t.length&&1===t[0]}get __blendMode(){if(this.eraser&&"path"!==this.eraser)return"destination-out";const{blendMode:t}=this;return"pass-through"===t?null:t}constructor(t){this.__leaf=t}__get(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}return this[t]}__getData(){const t={tag:this.__leaf.tag},{__input:e}=this;let s;for(let i in this)"_"!==i[0]&&(s=e?e[i]:void 0,t[i]=void 0===s?this[i]:s);return t}__setInput(t,e){this.__input||(this.__input={}),this.__input[t]=e}__getInput(t){if(this.__input){const e=this.__input[t];if(void 0!==e)return e}if("path"!==t||this.__pathInputed)return this["_"+t]}__removeInput(t){this.__input&&void 0!==this.__input[t]&&(this.__input[t]=void 0)}__getInputData(t,e){const s={};if(t)if(t instanceof Array)for(let e of t)s[e]=this.__getInput(e);else for(let e in t)s[e]=this.__getInput(e);else{let t,e,{__input:i}=this;s.tag=this.__leaf.tag;for(let r in this)if("_"!==r[0]&&(t=this["_"+r],void 0!==t)){if("path"===r&&!this.__pathInputed)continue;e=i?i[r]:void 0,s[r]=void 0===e?t:e}}if(e&&e.matrix){const{a:t,b:e,c:i,d:r,e:o,f:n}=this.__leaf.__localMatrix;s.matrix={a:t,b:e,c:i,d:r,e:o,f:n}}return s}__setMiddle(t,e){this.__middle||(this.__middle={}),this.__middle[t]=e}__getMiddle(t){return this.__middle&&this.__middle[t]}__checkSingle(){const t=this;if("pass-through"===t.blendMode){const e=this.__leaf;t.opacity<1&&(e.isBranch||t.__hasMultiPaint)||e.__hasEraser||t.eraser?t.__single=!0:t.__single&&(t.__single=!1)}else t.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}}var Dt;t.Answer=void 0,(Dt=t.Answer||(t.Answer={}))[Dt.No=0]="No",Dt[Dt.Yes=1]="Yes",Dt[Dt.NoAndSkip=2]="NoAndSkip",Dt[Dt.YesAndSkip=3]="YesAndSkip";function Ft(t,e,s,i){var r,o=arguments.length,n=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,s,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(n=(o<3?r(n):o>3?r(e,s,n):r(e,s))||n);return o>3&&n&&Object.defineProperty(e,s,n),n}function zt(t,e,s,i){return new(s||(s=Promise))((function(r,o){function n(t){try{h(i.next(t))}catch(t){o(t)}}function a(t){try{h(i.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(n,a)}h((i=i.apply(t,e||[])).next())}))}function Ut(t){return(e,s)=>{t||(t=s),Object.defineProperty(e,s,{get(){return this.context[t]},set(e){this.context[t]=e}})}}"function"==typeof SuppressedError&&SuppressedError;const Nt=[];function Yt(){return(t,e)=>{Nt.push(e)}}const Xt=[];class jt{set blendMode(t){"normal"===t&&(t="source-over"),this.context.globalCompositeOperation=t}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(t){this.context.setLineDash(t||Xt)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let t;Nt.forEach((e=>{t=this.context[e],t&&(this[e]=t.bind(this.context))})),this.textBaseline="alphabetic"}setTransform(t,e,s,i,r,o){}resetTransform(){}getTransform(){}save(){}restore(){}transform(t,e,s,i,r,o){"object"==typeof t?this.context.transform(t.a,t.b,t.c,t.d,t.e,t.f):this.context.transform(t,e,s,i,r,o)}translate(t,e){}scale(t,e){}rotate(t){}fill(t,e){}stroke(t){}clip(t,e){}fillRect(t,e,s,i){}strokeRect(t,e,s,i){}clearRect(t,e,s,i){}drawImage(t,e,s,i,r,o,n,a,h){switch(arguments.length){case 9:if(e<0){const t=-e/i*a;i+=e,e=0,o+=t,a-=t}if(s<0){const t=-s/r*h;r+=s,s=0,n+=t,h-=t}this.context.drawImage(t,e,s,i,r,o,n,a,h);break;case 5:this.context.drawImage(t,e,s,i,r);break;case 3:this.context.drawImage(t,e,s)}}beginPath(){}moveTo(t,e){}lineTo(t,e){}bezierCurveTo(t,e,s,i,r,o){}quadraticCurveTo(t,e,s,i){}closePath(){}arc(t,e,s,i,r,o){}arcTo(t,e,s,i,r){}ellipse(t,e,s,i,r,o,n,a){}rect(t,e,s,i){}roundRect(t,e,s,i,r){}createConicGradient(t,e,s){}createLinearGradient(t,e,s,i){}createPattern(t,e){}createRadialGradient(t,e,s,i,r,o){}fillText(t,e,s,i){}measureText(t){}strokeText(t,e,s,i){}destroy(){this.context=null}}Ft([Ut("imageSmoothingEnabled")],jt.prototype,"smooth",void 0),Ft([Ut("imageSmoothingQuality")],jt.prototype,"smoothLevel",void 0),Ft([Ut("globalAlpha")],jt.prototype,"opacity",void 0),Ft([Ut()],jt.prototype,"fillStyle",void 0),Ft([Ut()],jt.prototype,"strokeStyle",void 0),Ft([Ut("lineWidth")],jt.prototype,"strokeWidth",void 0),Ft([Ut("lineCap")],jt.prototype,"strokeCap",void 0),Ft([Ut("lineJoin")],jt.prototype,"strokeJoin",void 0),Ft([Ut("lineDashOffset")],jt.prototype,"dashOffset",void 0),Ft([Ut()],jt.prototype,"miterLimit",void 0),Ft([Ut()],jt.prototype,"shadowBlur",void 0),Ft([Ut()],jt.prototype,"shadowColor",void 0),Ft([Ut()],jt.prototype,"shadowOffsetX",void 0),Ft([Ut()],jt.prototype,"shadowOffsetY",void 0),Ft([Ut()],jt.prototype,"filter",void 0),Ft([Ut()],jt.prototype,"font",void 0),Ft([Ut()],jt.prototype,"fontKerning",void 0),Ft([Ut()],jt.prototype,"fontStretch",void 0),Ft([Ut()],jt.prototype,"fontVariantCaps",void 0),Ft([Ut()],jt.prototype,"textAlign",void 0),Ft([Ut()],jt.prototype,"textBaseline",void 0),Ft([Ut()],jt.prototype,"textRendering",void 0),Ft([Ut()],jt.prototype,"wordSpacing",void 0),Ft([Ut()],jt.prototype,"letterSpacing",void 0),Ft([Ut()],jt.prototype,"direction",void 0),Ft([Yt()],jt.prototype,"setTransform",null),Ft([Yt()],jt.prototype,"resetTransform",null),Ft([Yt()],jt.prototype,"getTransform",null),Ft([Yt()],jt.prototype,"save",null),Ft([Yt()],jt.prototype,"restore",null),Ft([Yt()],jt.prototype,"translate",null),Ft([Yt()],jt.prototype,"scale",null),Ft([Yt()],jt.prototype,"rotate",null),Ft([Yt()],jt.prototype,"fill",null),Ft([Yt()],jt.prototype,"stroke",null),Ft([Yt()],jt.prototype,"clip",null),Ft([Yt()],jt.prototype,"fillRect",null),Ft([Yt()],jt.prototype,"strokeRect",null),Ft([Yt()],jt.prototype,"clearRect",null),Ft([Yt()],jt.prototype,"beginPath",null),Ft([Yt()],jt.prototype,"moveTo",null),Ft([Yt()],jt.prototype,"lineTo",null),Ft([Yt()],jt.prototype,"bezierCurveTo",null),Ft([Yt()],jt.prototype,"quadraticCurveTo",null),Ft([Yt()],jt.prototype,"closePath",null),Ft([Yt()],jt.prototype,"arc",null),Ft([Yt()],jt.prototype,"arcTo",null),Ft([Yt()],jt.prototype,"ellipse",null),Ft([Yt()],jt.prototype,"rect",null),Ft([Yt()],jt.prototype,"roundRect",null),Ft([Yt()],jt.prototype,"createConicGradient",null),Ft([Yt()],jt.prototype,"createLinearGradient",null),Ft([Yt()],jt.prototype,"createPattern",null),Ft([Yt()],jt.prototype,"createRadialGradient",null),Ft([Yt()],jt.prototype,"fillText",null),Ft([Yt()],jt.prototype,"measureText",null),Ft([Yt()],jt.prototype,"strokeText",null);const{copy:Ht}=b,Vt={width:1,height:1,pixelRatio:1},Gt=["width","height","pixelRatio"];class qt extends jt{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio}get pixelHeight(){return this.height*this.pixelRatio}get allowBackgroundColor(){return this.view&&this.parentView}constructor(t,s){super(),this.size={},this.worldTransform={},t||(t=Vt),t.pixelRatio||(t.pixelRatio=e.devicePixelRatio),this.manager=s,this.innerId=i.create(i.CNAVAS);const{width:r,height:o,pixelRatio:n}=t;this.autoLayout=!r||!o,this.size.pixelRatio=n,this.config=t,this.init()}init(){}__createContext(){const{view:t}=this,{contextSettings:e}=this.config;this.context=e?t.getContext("2d",e):t.getContext("2d"),this.__bindContext()}export(t,e){}toBlob(t,e){}toDataURL(t,e){}saveAs(t,e){}resize(t){if(this.isSameSize(t))return;let e;this.context&&!this.unreal&&this.width&&(e=this.getSameCanvas(),e.copyWorld(this));const s=this.size;At.copyAttrs(s,t,Gt),Gt.forEach((t=>s[t]||(s[t]=1))),this.bounds=new lt(0,0,this.width,this.height),this.context&&!this.unreal&&(this.updateViewSize(),this.smooth=this.config.smooth),this.updateClientBounds(),this.context&&!this.unreal&&e&&(this.clearWorld(e.bounds),this.copyWorld(e),e.recycle())}updateViewSize(){}updateClientBounds(){}getClientBounds(t){return t&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(t,e){}stopAutoLayout(){}setCursor(t){}setWorld(t,e){const{pixelRatio:s}=this,i=this.worldTransform;if(e){const{a:r,b:o,c:n,d:a,e:h,f:l}=e;this.setTransform(i.a=(t.a*r+t.b*n)*s,i.b=(t.a*o+t.b*a)*s,i.c=(t.c*r+t.d*n)*s,i.d=(t.c*o+t.d*a)*s,i.e=(t.e*r+t.f*n+h)*s,i.f=(t.e*o+t.f*a+l)*s)}else this.setTransform(i.a=t.a*s,i.b=t.b*s,i.c=t.c*s,i.d=t.d*s,i.e=t.e*s,i.f=t.f*s)}useWorldTransform(t){t&&(this.worldTransform=t);const e=this.worldTransform;e&&this.setTransform(e.a,e.b,e.c,e.d,e.e,e.f)}setStroke(t,e,s){e&&(this.strokeWidth=e),t&&(this.strokeStyle=t),s&&this.setStrokeOptions(s)}setStrokeOptions(t){this.strokeCap="none"===t.strokeCap?"butt":t.strokeCap,this.strokeJoin=t.strokeJoin,this.dashPattern=t.dashPattern,this.dashOffset=t.dashOffset,this.miterLimit=t.miterLimit}saveBlendMode(t){this.savedBlendMode=this.blendMode,this.blendMode=t}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(t,e){return!0}hitStroke(t,e){return!0}hitPixel(t,e,s=1){return!0}setWorldShadow(t,e,s,i){const{pixelRatio:r}=this;this.shadowOffsetX=t*r,this.shadowOffsetY=e*r,this.shadowBlur=s*r,this.shadowColor=i||"black"}setWorldBlur(t){const{pixelRatio:e}=this;this.filter=`blur(${t*e}px)`}copyWorld(t,e,s,i){if(i&&(this.blendMode=i),e){const{pixelRatio:i}=this;s||(s=e),this.drawImage(t.view,e.x*i,e.y*i,e.width*i,e.height*i,s.x*i,s.y*i,s.width*i,s.height*i)}else this.drawImage(t.view,0,0);i&&(this.blendMode="source-over")}copyWorldToInner(t,e,s,i){if(i&&(this.blendMode=i),e.b||e.c)this.save(),this.resetTransform(),this.copyWorld(t,e,ot.tempToOuterOf(s,e)),this.restore();else{const{pixelRatio:i}=this;this.drawImage(t.view,e.x*i,e.y*i,e.width*i,e.height*i,s.x,s.y,s.width,s.height)}i&&(this.blendMode="source-over")}copyWorldByReset(t,e,s,i,r){this.resetTransform(),this.copyWorld(t,e,s,i),r||this.useWorldTransform()}useGrayscaleAlpha(t){let e,s;this.setTempBounds(t,!0,!0);const{context:i}=this,r=i.getImageData(dt.x,dt.y,dt.width,dt.height),{data:o}=r;for(let t=0,i=o.length;t<i;t+=4)s=.299*o[t]+.587*o[t+1]+.114*o[t+2],(e=o[t+3])&&(o[t+3]=255===e?s:e*(s/255));i.putImageData(r,dt.x,dt.y)}useMask(t,e,s){this.copyWorld(t,e,s,"destination-in")}useEraser(t,e,s){this.copyWorld(t,e,s,"destination-out")}fillWorld(t,e,s){s&&(this.blendMode=s),this.fillStyle=e,this.setTempBounds(t),this.fillRect(dt.x,dt.y,dt.width,dt.height),s&&(this.blendMode="source-over")}strokeWorld(t,e,s){s&&(this.blendMode=s),this.strokeStyle=e,this.setTempBounds(t),this.strokeRect(dt.x,dt.y,dt.width,dt.height),s&&(this.blendMode="source-over")}clearWorld(t,e){this.setTempBounds(t,e),this.clearRect(dt.x,dt.y,dt.width,dt.height)}clipWorld(t,e){this.beginPath(),this.setTempBounds(t,e),this.rect(dt.x,dt.y,dt.width,dt.height),this.clip()}clear(){const{pixelRatio:t}=this;this.clearRect(0,0,this.width*t+2,this.height*t+2)}setTempBounds(t,e,s){dt.set(t),s&&dt.intersect(this.bounds),dt.scale(this.pixelRatio),e&&dt.ceil()}isSameSize(t){return this.width===t.width&&this.height===t.height&&this.pixelRatio===t.pixelRatio}getSameCanvas(t,e){const i=this.manager?this.manager.get(this.size):s.canvas(Object.assign({},this.size));return i.save(),t&&(Ht(i.worldTransform,this.worldTransform),i.useWorldTransform()),e&&(i.smooth=this.smooth),i}recycle(t){this.recycled||(this.restore(),t?this.clearWorld(t,!0):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(t){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}}const Qt={creator:{},parse(t,e){},convertToCanvasData(t,e){}},Jt={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},$t=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},Jt),Zt={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},Kt={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},te=Object.assign(Object.assign({},Kt),Jt),ee=$t,se={};for(let t in ee)se[ee[t]]=t;const ie={};for(let t in ee)ie[ee[t]]=Zt[t];const re={drawRoundRect(t,e,s,i,r,o){const n=h.fourNumber(o,Math.min(i/2,r/2)),a=e+i,l=s+r;n[0]?t.moveTo(e+n[0],s):t.moveTo(e,s),n[1]?t.arcTo(a,s,a,l,n[1]):t.lineTo(a,s),n[2]?t.arcTo(a,l,e,l,n[2]):t.lineTo(a,l),n[3]?t.arcTo(e,l,e,s,n[3]):t.lineTo(e,l),n[0]?t.arcTo(e,s,a,s,n[0]):t.lineTo(e,s)}},{sin:oe,cos:ne,atan2:ae,ceil:he,abs:le,PI:de,sqrt:ce,pow:ue}=Math,{setPoint:_e,addPoint:pe}=Y,{set:ge,toNumberPoints:fe}=E,{M:ye,L:me,C:we,Q:xe,Z:ve}=$t,be={},Be={points(t,e,s,i){let r=fe(e);if(t.push(ye,r[0],r[1]),s&&r.length>5){let e,o,n,a,h,l,d,c,u,_,p,g,f,y=r.length;const m=!0===s?.5:s;i&&(r=[r[y-2],r[y-1],...r,r[0],r[1],r[2],r[3]],y=r.length);for(let s=2;s<y-2;s+=2)e=r[s-2],o=r[s-1],n=r[s],a=r[s+1],h=r[s+2],l=r[s+3],p=ce(ue(n-e,2)+ue(a-o,2)),g=ce(ue(h-n,2)+ue(l-a,2)),f=p+g,p=m*p/f,g=m*g/f,h-=e,l-=o,d=n-p*h,c=a-p*l,2===s?i||t.push(xe,d,c,n,a):t.push(we,u,_,d,c,n,a),u=n+g*h,_=a+g*l;i||t.push(xe,u,_,r[y-2],r[y-1])}else for(let e=2,s=r.length;e<s;e+=2)t.push(me,r[e],r[e+1]);i&&t.push(ve)},rect(t,e,s,i,r){Qt.creator.path=t,Qt.creator.moveTo(e,s).lineTo(e+i,s).lineTo(e+i,s+r).lineTo(e,s+r).lineTo(e,s)},roundRect(t,e,s,i,r,o){Qt.creator.path=[],re.drawRoundRect(Qt.creator,e,s,i,r,o),t.push(...Qt.convertToCanvasData(Qt.creator.path,!0))},arcTo(t,e,s,i,r,o,n,a,h,u,_){const p=i-e,g=r-s,f=o-i,y=n-r;let m=ae(g,p),w=ae(y,f),x=w-m;if(x<0&&(x+=d),x===de||le(p+g)<1e-12||le(f+y)<1e-12)return t&&t.push(me,i,r),h&&(_e(h,e,s),pe(h,i,r)),_&&ge(_,e,s),void(u&&ge(u,i,r));const v=p*y-f*g<0,b=v?-1:1,B=a/ne(x/2),k=i+B*ne(m+x/2+c*b),R=r+B*oe(m+x/2+c*b);return m-=c*b,w-=c*b,Ce(t,k,R,a,a,0,m/l,w/l,v,h,u,_)},arc:(t,e,s,i,r,o,n,a,h,l)=>Ce(t,e,s,i,i,0,r,o,n,a,h,l),ellipse(t,e,s,i,r,o,n,a,h,u,_,p){const g=o*l,f=oe(g),y=ne(g);let m=n*l,w=a*l;m>de&&(m-=d),w<0&&(w+=d);let x=w-m;x<0?x+=d:x>d&&(x-=d),h&&(x-=d);const v=he(le(x/c)),b=x/v,B=oe(b/4),k=8/3*B*B/oe(b/2);w=m+b;let R,C,S,T,P,L,I,O,E=ne(m),A=oe(m),M=S=y*i*E-f*r*A,W=T=f*i*E+y*r*A,D=e+S,F=s+T;t&&t.push(t.length?me:ye,D,F),u&&_e(u,D,F),p&&ge(p,D,F);for(let o=0;o<v;o++)R=ne(w),C=oe(w),S=y*i*R-f*r*C,T=f*i*R+y*r*C,P=e+M-k*(y*i*A+f*r*E),L=s+W-k*(f*i*A-y*r*E),I=e+S+k*(y*i*C+f*r*R),O=s+T+k*(f*i*C-y*r*R),t&&t.push(we,P,L,I,O,e+S,s+T),u&&Re(e+M,s+W,P,L,I,O,e+S,s+T,u,!0),M=S,W=T,E=R,A=C,m=w,w+=b;_&&ge(_,e+S,s+T)},quadraticCurveTo(t,e,s,i,r,o,n){t.push(we,(e+2*i)/3,(s+2*r)/3,(o+2*i)/3,(n+2*r)/3,o,n)},toTwoPointBoundsByQuadraticCurve(t,e,s,i,r,o,n,a){Re(t,e,(t+2*s)/3,(e+2*i)/3,(r+2*s)/3,(o+2*i)/3,r,o,n,a)},toTwoPointBounds(t,e,s,i,r,o,n,a,h,l){const d=[];let c,u,_,p,g,f,y,m,w=t,x=s,v=r,b=n;for(let t=0;t<2;++t)if(1==t&&(w=e,x=i,v=o,b=a),c=-3*w+9*x-9*v+3*b,u=6*w-12*x+6*v,_=3*x-3*w,Math.abs(c)<1e-12){if(Math.abs(u)<1e-12)continue;p=-_/u,0<p&&p<1&&d.push(p)}else y=u*u-4*_*c,m=Math.sqrt(y),y<0||(g=(-u+m)/(2*c),0<g&&g<1&&d.push(g),f=(-u-m)/(2*c),0<f&&f<1&&d.push(f));l?pe(h,t,e):_e(h,t,e),pe(h,n,a);for(let l=0,c=d.length;l<c;l++)ke(d[l],t,e,s,i,r,o,n,a,be),pe(h,be.x,be.y)},getPointAndSet(t,e,s,i,r,o,n,a,h,l){const d=1-t,c=d*d*d,u=3*d*d*t,_=3*d*t*t,p=t*t*t;l.x=c*e+u*i+_*o+p*a,l.y=c*s+u*r+_*n+p*h},getPoint(t,e,s,i,r,o,n,a,h){const l={};return ke(t,e,s,i,r,o,n,a,h,l),l}},{getPointAndSet:ke,toTwoPointBounds:Re,ellipse:Ce}=Be,{sin:Se,cos:Te,sqrt:Pe,atan2:Le}=Math,{ellipse:Ie}=Be,Oe={ellipticalArc(t,s,i,r,o,n,a,h,c,u,_){const p=(c-s)/2,g=(u-i)/2,f=n*l,y=Se(f),m=Te(f),w=-m*p-y*g,x=-m*g+y*p,v=r*r,b=o*o,B=x*x,k=w*w,R=v*b-v*B-b*k;let C=0;if(R<0){const t=Pe(1-R/(v*b));r*=t,o*=t}else C=(a===h?-1:1)*Pe(R/(v*B+b*k));const S=C*r*x/o,T=-C*o*w/r,P=Le((x-T)/o,(w-S)/r),L=Le((-x-T)/o,(-w-S)/r);let I=L-P;0===h&&I>0?I-=d:1===h&&I<0&&(I+=d);const O=s+p+m*S-y*T,E=i+g+y*S+m*T,A=I<0?1:0;_||e.ellipseToCurve?Ie(t,O,E,r,o,n,P/l,L/l,A):r!==o||n?t.push($t.G,O,E,r,o,n,P/l,L/l,A):t.push($t.O,O,E,r,P/l,L/l,A)}},{M:Ee,m:Ae,L:Me,l:We,H:De,h:Fe,V:ze,v:Ue,C:Ne,c:Ye,S:Xe,s:je,Q:He,q:Ve,T:Ge,t:qe,A:Qe,a:Je,Z:$e,z:Ze,N:Ke,D:ts,X:es,G:ss,F:is,O:rs,P:os,U:ns}=$t,{rect:as,roundRect:hs,arcTo:ls,arc:ds,ellipse:cs,quadraticCurveTo:us}=Be,{ellipticalArc:_s}=Oe,ps=xt.get("PathConvert"),gs={},fs={current:{dot:0},stringify(t,e){let s,i,r,o=0,n=t.length,a="";for(;o<n;){i=t[o],s=ie[i],a+=i===r?" ":se[i];for(let i=1;i<s;i++)a+=h.float(t[o+i],e),i===s-1||(a+=" ");r=i,o+=s}return a},parse(t,e){let s,i,r,o="";const n=[],a=e?te:Kt;for(let e=0,h=t.length;e<h;e++)i=t[e],wt[i]?("."===i&&(ys.dot&&(ms(n,o),o=""),ys.dot++),"0"===o&&"."!==i&&(ms(n,o),o=""),o+=i):$t[i]?(o&&(ms(n,o),o=""),ys.name=$t[i],ys.length=Zt[i],ys.index=0,ms(n,ys.name),!s&&a[i]&&(s=!0)):"-"===i||"+"===i?"e"===r||"E"===r?o+=i:(o&&ms(n,o),o=i):o&&(ms(n,o),o=""),r=i;return o&&ms(n,o),s?fs.toCanvasData(n,e):n},toCanvasData(t,e){let s,i,r,o,n,a=0,h=0,l=0,d=0,c=0,u=t.length;const _=[];for(;c<u;){switch(r=t[c],r){case Ae:t[c+1]+=a,t[c+2]+=h;case Ee:a=t[c+1],h=t[c+2],_.push(Ee,a,h),c+=3;break;case Fe:t[c+1]+=a;case De:a=t[c+1],_.push(Me,a,h),c+=2;break;case Ue:t[c+1]+=h;case ze:h=t[c+1],_.push(Me,a,h),c+=2;break;case We:t[c+1]+=a,t[c+2]+=h;case Me:a=t[c+1],h=t[c+2],_.push(Me,a,h),c+=3;break;case je:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=Xe;case Xe:n=o===Ne||o===Xe,l=n?2*a-s:t[c+1],d=n?2*h-i:t[c+2],s=t[c+1],i=t[c+2],a=t[c+3],h=t[c+4],_.push(Ne,l,d,s,i,a,h),c+=5;break;case Ye:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,t[c+5]+=a,t[c+6]+=h,r=Ne;case Ne:s=t[c+3],i=t[c+4],a=t[c+5],h=t[c+6],_.push(Ne,t[c+1],t[c+2],s,i,a,h),c+=7;break;case qe:t[c+1]+=a,t[c+2]+=h,r=Ge;case Ge:n=o===He||o===Ge,s=n?2*a-s:t[c+1],i=n?2*h-i:t[c+2],e?us(_,a,h,s,i,t[c+1],t[c+2]):_.push(He,s,i,t[c+1],t[c+2]),a=t[c+1],h=t[c+2],c+=3;break;case Ve:t[c+1]+=a,t[c+2]+=h,t[c+3]+=a,t[c+4]+=h,r=He;case He:s=t[c+1],i=t[c+2],e?us(_,a,h,s,i,t[c+3],t[c+4]):_.push(He,s,i,t[c+3],t[c+4]),a=t[c+3],h=t[c+4],c+=5;break;case Je:t[c+6]+=a,t[c+7]+=h;case Qe:_s(_,a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],e),a=t[c+6],h=t[c+7],c+=8;break;case Ze:case $e:_.push($e),c++;break;case Ke:a=t[c+1],h=t[c+2],e?as(_,a,h,t[c+3],t[c+4]):ws(_,t,c,5),c+=5;break;case ts:a=t[c+1],h=t[c+2],e?hs(_,a,h,t[c+3],t[c+4],[t[c+5],t[c+6],t[c+7],t[c+8]]):ws(_,t,c,9),c+=9;break;case es:a=t[c+1],h=t[c+2],e?hs(_,a,h,t[c+3],t[c+4],t[c+5]):ws(_,t,c,6),c+=6;break;case ss:cs(e?_:ws(_,t,c,9),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],t[c+7],t[c+8],null,gs),a=gs.x,h=gs.y,c+=9;break;case is:e?cs(_,t[c+1],t[c+2],t[c+3],t[c+4],0,0,360,!1):ws(_,t,c,5),a=t[c+1]+t[c+3],h=t[c+2],c+=5;break;case rs:ds(e?_:ws(_,t,c,7),t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],t[c+6],null,gs),a=gs.x,h=gs.y,c+=7;break;case os:e?ds(_,t[c+1],t[c+2],t[c+3],0,360,!1):ws(_,t,c,4),a=t[c+1]+t[c+3],h=t[c+2],c+=4;break;case ns:ls(e?_:ws(_,t,c,6),a,h,t[c+1],t[c+2],t[c+3],t[c+4],t[c+5],null,gs),a=gs.x,h=gs.y,c+=6;break;default:return ps.error(`command: ${r} [index:${c}]`,t),_}o=r}return _},objectToCanvasData(t){const e=[];return t.forEach((t=>{switch(t.name){case"M":e.push(Ee,t.x,t.y);break;case"L":e.push(Me,t.x,t.y);break;case"C":e.push(Ne,t.x1,t.y1,t.x2,t.y2,t.x,t.y);break;case"Q":e.push(He,t.x1,t.y1,t.x,t.y);break;case"Z":e.push($e)}})),e},copyData(t,e,s,i){for(let r=s,o=s+i;r<o;r++)t.push(e[r])},pushData(t,e){ys.index===ys.length&&(ys.index=1,t.push(ys.name)),t.push(Number(e)),ys.index++,ys.dot=0}},{current:ys,pushData:ms,copyData:ws}=fs,{M:xs,L:vs,C:bs,Q:Bs,Z:ks,N:Rs,D:Cs,X:Ss,G:Ts,F:Ps,O:Ls,P:Is,U:Os}=$t,{getMinDistanceFrom:Es,getRadianFrom:As}=E,{tan:Ms,min:Ws,abs:Ds}=Math,Fs={},zs={beginPath(t){t.length=0},moveTo(t,e,s){t.push(xs,e,s)},lineTo(t,e,s){t.push(vs,e,s)},bezierCurveTo(t,e,s,i,r,o,n){t.push(bs,e,s,i,r,o,n)},quadraticCurveTo(t,e,s,i,r){t.push(Bs,e,s,i,r)},closePath(t){t.push(ks)},rect(t,e,s,i,r){t.push(Rs,e,s,i,r)},roundRect(t,e,s,i,r,o){if("number"==typeof o)t.push(Ss,e,s,i,r,o);else{const n=h.fourNumber(o);n?t.push(Cs,e,s,i,r,...n):t.push(Rs,e,s,i,r)}},ellipse(t,e,s,i,r,o,n,a,h){void 0===o?t.push(Ps,e,s,i,r):(void 0===n&&(n=0),void 0===a&&(a=360),t.push(Ts,e,s,i,r,o,n,a,h?1:0))},arc(t,e,s,i,r,o,n){void 0===r?t.push(Is,e,s,i):(void 0===o&&(o=360),t.push(Ls,e,s,i,r,o,n?1:0))},arcTo(t,e,s,i,r,o,n,a){if(void 0!==n){const h=Ms(As(n,a,e,s,i,r)/2)*(Es(n,a,e,s,i,r)/2);t.push(Os,e,s,i,r,Ws(o,Ds(h)))}else t.push(Os,e,s,i,r,o)},drawEllipse(t,e,s,i,r,o,n,a,h){Be.ellipse(null,e,s,i,r,void 0===o?0:o,void 0===n?0:n,void 0===a?360:a,h,null,null,Fs),t.push(xs,Fs.x,Fs.y),Us(t,e,s,i,r,o,n,a,h)},drawArc(t,e,s,i,r,o,n){Be.arc(null,e,s,i,void 0===r?0:r,void 0===o?360:o,n,null,null,Fs),t.push(xs,Fs.x,Fs.y),Ns(t,e,s,i,r,o,n)},drawPoints(t,e,s,i){Be.points(t,e,s,i)}},{ellipse:Us,arc:Ns}=zs,{moveTo:Ys,lineTo:Xs,quadraticCurveTo:js,bezierCurveTo:Hs,closePath:Vs,beginPath:Gs,rect:qs,roundRect:Qs,ellipse:Js,arc:$s,arcTo:Zs,drawEllipse:Ks,drawArc:ti,drawPoints:ei}=zs;class si{set path(t){this.__path=t}get path(){return this.__path}constructor(t){this.set(t)}set(t){return this.__path=t?"string"==typeof t?Qt.parse(t):t:[],this}beginPath(){return Gs(this.__path),this.paint(),this}moveTo(t,e){return Ys(this.__path,t,e),this.paint(),this}lineTo(t,e){return Xs(this.__path,t,e),this.paint(),this}bezierCurveTo(t,e,s,i,r,o){return Hs(this.__path,t,e,s,i,r,o),this.paint(),this}quadraticCurveTo(t,e,s,i){return js(this.__path,t,e,s,i),this.paint(),this}closePath(){return Vs(this.__path),this.paint(),this}rect(t,e,s,i){return qs(this.__path,t,e,s,i),this.paint(),this}roundRect(t,e,s,i,r){return Qs(this.__path,t,e,s,i,r),this.paint(),this}ellipse(t,e,s,i,r,o,n,a){return Js(this.__path,t,e,s,i,r,o,n,a),this.paint(),this}arc(t,e,s,i,r,o){return $s(this.__path,t,e,s,i,r,o),this.paint(),this}arcTo(t,e,s,i,r){return Zs(this.__path,t,e,s,i,r),this.paint(),this}drawEllipse(t,e,s,i,r,o,n,a){return Ks(this.__path,t,e,s,i,r,o,n,a),this.paint(),this}drawArc(t,e,s,i,r,o){return ti(this.__path,t,e,s,i,r,o),this.paint(),this}drawPoints(t,e,s){return ei(this.__path,t,e,s),this.paint(),this}clearPath(){return this.beginPath()}paint(){}}const{M:ii,L:ri,C:oi,Q:ni,Z:ai,N:hi,D:li,X:di,G:ci,F:ui,O:_i,P:pi,U:gi}=$t,fi=xt.get("PathDrawer"),yi={drawPathByData(t,e){if(!e)return;let s,i=0,r=e.length;for(;i<r;)switch(s=e[i],s){case ii:t.moveTo(e[i+1],e[i+2]),i+=3;break;case ri:t.lineTo(e[i+1],e[i+2]),i+=3;break;case oi:t.bezierCurveTo(e[i+1],e[i+2],e[i+3],e[i+4],e[i+5],e[i+6]),i+=7;break;case ni:t.quadraticCurveTo(e[i+1],e[i+2],e[i+3],e[i+4]),i+=5;break;case ai:t.closePath(),i+=1;break;case hi:t.rect(e[i+1],e[i+2],e[i+3],e[i+4]),i+=5;break;case li:t.roundRect(e[i+1],e[i+2],e[i+3],e[i+4],[e[i+5],e[i+6],e[i+7],e[i+8]]),i+=9;break;case di:t.roundRect(e[i+1],e[i+2],e[i+3],e[i+4],e[i+5]),i+=6;break;case ci:t.ellipse(e[i+1],e[i+2],e[i+3],e[i+4],e[i+5]*l,e[i+6]*l,e[i+7]*l,e[i+8]),i+=9;break;case ui:t.ellipse(e[i+1],e[i+2],e[i+3],e[i+4],0,0,d,!1),i+=5;break;case _i:t.arc(e[i+1],e[i+2],e[i+3],e[i+4]*l,e[i+5]*l,e[i+6]),i+=7;break;case pi:t.arc(e[i+1],e[i+2],e[i+3],0,d,!1),i+=4;break;case gi:t.arcTo(e[i+1],e[i+2],e[i+3],e[i+4],e[i+5]),i+=6;break;default:return void fi.error(`command: ${s} [index:${i}]`,e)}}},{M:mi,L:wi,C:xi,Q:vi,Z:bi,N:Bi,D:ki,X:Ri,G:Ci,F:Si,O:Ti,P:Pi,U:Li}=$t,{toTwoPointBounds:Ii,toTwoPointBoundsByQuadraticCurve:Oi,arcTo:Ei,arc:Ai,ellipse:Mi}=Be,{addPointBounds:Wi,copy:Di,addPoint:Fi,setPoint:zi,addBounds:Ui,toBounds:Ni}=Y,Yi=xt.get("PathBounds");let Xi,ji,Hi;const Vi={},Gi={},qi={},Qi={toBounds(t,e){Qi.toTwoPointBounds(t,Gi),Ni(Gi,e)},toTwoPointBounds(t,e){if(!t||!t.length)return zi(e,0,0);let s,i,r,o,n,a=0,h=0,l=0;const d=t.length;for(;a<d;)switch(n=t[a],0===a&&(n===bi||n===xi||n===vi?zi(e,h,l):zi(e,t[a+1],t[a+2])),n){case mi:case wi:h=t[a+1],l=t[a+2],Fi(e,h,l),a+=3;break;case xi:r=t[a+5],o=t[a+6],Ii(h,l,t[a+1],t[a+2],t[a+3],t[a+4],r,o,Vi),Wi(e,Vi),h=r,l=o,a+=7;break;case vi:s=t[a+1],i=t[a+2],r=t[a+3],o=t[a+4],Oi(h,l,s,i,r,o,Vi),Wi(e,Vi),h=r,l=o,a+=5;break;case bi:a+=1;break;case Bi:h=t[a+1],l=t[a+2],Ui(e,h,l,t[a+3],t[a+4]),a+=5;break;case ki:case Ri:h=t[a+1],l=t[a+2],Ui(e,h,l,t[a+3],t[a+4]),a+=n===ki?9:6;break;case Ci:Mi(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],Vi,qi),0===a?Di(e,Vi):Wi(e,Vi),h=qi.x,l=qi.y,a+=9;break;case Si:h=t[a+1],l=t[a+2],ji=t[a+3],Hi=t[a+4],Ui(e,h-ji,l-Hi,2*ji,2*Hi),h+=ji,a+=5;break;case Ti:Ai(null,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],Vi,qi),0===a?Di(e,Vi):Wi(e,Vi),h=qi.x,l=qi.y,a+=7;break;case Pi:h=t[a+1],l=t[a+2],Xi=t[a+3],Ui(e,h-Xi,l-Xi,2*Xi,2*Xi),h+=Xi,a+=4;break;case Li:Ei(null,h,l,t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],Vi,qi),0===a?Di(e,Vi):Wi(e,Vi),h=qi.x,l=qi.y,a+=6;break;default:return void Yi.error(`command: ${n} [index:${a}]`,t)}}},{M:Ji,L:$i,C:Zi,Z:Ki}=$t,{getCenterX:tr,getCenterY:er}=E,{arcTo:sr}=zs,ir={smooth(t,e,s){let i,r=0,o=0,n=0,a=0,h=0,l=0,d=0,c=0,u=0;const _=t.length,p=[];for(;r<_;)switch(i=t[r],i){case Ji:a=c=t[r+1],h=u=t[r+2],r+=3,t[r]===$i?(l=t[r+1],d=t[r+2],p.push(Ji,tr(a,l),er(h,d))):p.push(Ji,a,h);break;case $i:switch(o=t[r+1],n=t[r+2],r+=3,t[r]){case $i:sr(p,o,n,t[r+1],t[r+2],e,c,u);break;case Ki:sr(p,o,n,a,h,e,c,u);break;default:p.push($i,o,n)}c=o,u=n;break;case Zi:p.push(Zi,t[r+1],t[r+2],t[r+3],t[r+4],t[r+5],t[r+6]),r+=7;break;case Ki:sr(p,a,h,l,d,e,c,u),p.push(Ki),r+=1}return i!==Ki&&(p[1]=a,p[2]=h),p}};Qt.creator=new si,Qt.parse=fs.parse,Qt.convertToCanvasData=fs.toCanvasData;const rr=new si,{drawRoundRect:or}=re;function nr(t){!function(t){t&&!t.roundRect&&(t.roundRect=function(t,e,s,i,r){or(this,t,e,s,i,r)})}(t)}const ar={opacityTypes:["png","webp","svg"],upperCaseTypeMap:{},mineType:t=>!t||t.startsWith("image")?t:("jpg"===t&&(t="jpeg"),"image/"+t),fileType(t){const e=t.split(".");return e[e.length-1]},isOpaqueImage(t){const e=hr.fileType(t);return["jpg","jpeg"].some((t=>t===e))},getExportOptions(t){switch(typeof t){case"object":return t;case"number":return{quality:t};case"boolean":return{blob:t};default:return{}}}},hr=ar;hr.opacityTypes.forEach((t=>hr.upperCaseTypeMap[t]=t.toUpperCase()));const lr=xt.get("TaskProcessor");class dr{constructor(t){this.parallel=!0,this.time=1,this.id=i.create(i.TASK),this.task=t}run(){return zt(this,void 0,void 0,(function*(){try{this.task&&!this.isComplete&&this.parent.running&&(yield this.task())}catch(t){lr.error(t)}}))}complete(){this.isComplete=!0,this.parent=null,this.task=null}cancel(){this.isCancel=!0,this.complete()}}class cr{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){const{total:t}=this;let e=0,s=0;for(let i=0;i<t;i++)i<=this.finishedIndex?(s+=this.list[i].time,i===this.finishedIndex&&(e=s)):e+=this.list[i].time;return this.isComplete?1:s/e}constructor(t){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,t&&At.assign(this.config,t),this.empty()}add(t,e){let s,i,r,o;const n=new dr(t);return n.parent=this,"number"==typeof e?o=e:e&&(i=e.parallel,s=e.start,r=e.time,o=e.delay),r&&(n.time=r),!1===i&&(n.parallel=!1),void 0===o?this.push(n,s):(this.delayNumber++,setTimeout((()=>{this.delayNumber&&(this.delayNumber--,this.push(n,s))}),o)),this.isComplete=!1,n}push(t,e){this.list.push(t),!1===e||this.timer||(this.timer=setTimeout((()=>this.start())))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach((t=>{t.isComplete||t.cancel()})),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){const t=this.list[this.index];t?t.run().then((()=>{this.onTask(t),this.index++,this.nextTask()})).catch((t=>{this.onError(t)})):this.nextTask()}runParallelTasks(){this.parallelList.forEach((t=>this.runParallelTask(t)))}runParallelTask(t){t.run().then((()=>{this.onTask(t),this.fillParallelTask()})).catch((t=>{this.onParallelError(t)}))}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout((()=>this.run()))}setParallelList(){let t;this.parallelList=[],this.parallelSuccessNumber=0;let e=this.index+this.config.parallel;e>this.list.length&&(e=this.list.length);for(let s=this.index;s<e&&(t=this.list[s],t.parallel);s++)this.parallelList.push(t)}fillParallelTask(){let t;const e=this.parallelList;this.parallelSuccessNumber++,e.pop();const s=e.length,i=this.finishedIndex+s;if(e.length){if(!this.running)return;i<this.total&&(t=this.list[i],t&&t.parallel&&(e.push(t),this.runParallelTask(t)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(t){t.complete(),this.config.onTask&&this.config.onTask()}onParallelError(t){this.parallelList.forEach((t=>{t.parallel=!1})),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(t)}onError(t){this.pause(),this.config.onError&&this.config.onError(t)}destroy(){this.stop()}}const ur={map:{},recycledList:[],tasker:new cr,patternTasker:new cr,get isComplete(){return _r.tasker.isComplete},get(t){let e=_r.map[t.url];return e||(e=s.image(t),_r.map[t.url]=e),e.use++,e},recycle(t){t.use--,setTimeout((()=>{t.use||_r.recycledList.push(t)}))},clearRecycled(){const t=_r.recycledList;t.length>100&&(t.forEach((t=>{!t.use&&t.url&&(delete _r.map[t.url],t.destroy())})),t.length=0)},hasOpacityPixel:t=>ar.opacityTypes.some((e=>_r.isFormat(e,t))),isFormat(t,e){if(e.format===t)return!0;const{url:s}=e;if(s.startsWith("data:")){if(s.startsWith("data:"+ar.mineType(t)))return!0}else{if(s.includes("."+t)||s.includes("."+ar.upperCaseTypeMap[t]))return!0;if("png"===t&&!s.includes("."))return!0}return!1},destroy(){_r.map={},_r.recycledList=[]}},_r=ur,{IMAGE:pr,create:gr}=i;class fr{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(t){this.use=0,this.waitComplete=[],this.innerId=gr(pr),this.config=t||{url:""},this.isSVG=ur.isFormat("svg",t),this.hasOpacityPixel=ur.hasOpacityPixel(t)}load(t,s){return this.loading||(this.loading=!0,ur.tasker.add((()=>zt(this,void 0,void 0,(function*(){return yield e.origin.loadImage(this.url).then((t=>{this.ready=!0,this.width=t.naturalWidth||t.width,this.height=t.naturalHeight||t.height,this.view=t,this.onComplete(!0)})).catch((t=>{this.error=t,this.onComplete(!1)}))}))))),this.waitComplete.push(t,s),this.waitComplete.length-2}unload(t,e){const s=this.waitComplete;if(e){const e=s[t+1];e&&e({type:"stop"})}s[t]=s[t+1]=void 0}onComplete(t){let e;this.waitComplete.forEach(((s,i)=>{e=i%2,s&&(t?e||s(this):e&&s(this.error))})),this.waitComplete.length=0,this.loading=!1}getCanvas(t,s,i,r){if(t||(t=this.width),s||(s=this.height),this.cache){let{params:t,data:e}=this.cache;for(let s in t)if(t[s]!==arguments[s]){e=null;break}if(e)return e}const o=e.origin.createCanvas(t,s),n=o.getContext("2d");return i&&(n.globalAlpha=i),n.drawImage(this.view,0,0,t,s),this.cache=this.use>1?{data:o,params:arguments}:null,o}getPattern(t,s,i,r){const o=e.canvas.createPattern(t,s);try{i&&o.setTransform&&(o.setTransform(i),i=null)}catch(t){}return r&&(r.transform=i),o}destroy(){this.config={url:""},this.cache=null,this.waitComplete.length=0}}function yr(t,e,s,i){i||(s.configurable=s.enumerable=!0),Object.defineProperty(t,e,s)}function mr(t,e){return Object.getOwnPropertyDescriptor(t,e)}function wr(t,e){return(s,i)=>vr(s,i,t,e&&e(i))}function xr(t){return t}function vr(t,e,s,i){const r={get(){return this.__getAttr(e)},set(t){this.__setAttr(e,t)}};yr(t,e,Object.assign(r,i||{})),Vr(t,e,s)}function br(t){return wr(t)}function Br(t,e){return wr(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}})))}function kr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal())}})))}function Rr(t,e){return wr(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}})))}function Cr(t,e){return wr(t,(t=>({set(s){this.__setAttr(t,s,e)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}})))}function Sr(t,e){return wr(t,(t=>({set(s){this.__setAttr(t,s,e)&&Pr(this)}})))}function Tr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(Pr(this),this.__.__removeNaturalSize())}})))}function Pr(t){t.__layout.boxChanged||t.__layout.boxChange(),t.__hasAutoLayout&&(t.__layout.matrixChanged||t.__layout.matrixChange())}function Lr(t){return wr(t,(t=>({set(e){const s=this.__;2!==s.__pathInputed&&(s.__pathInputed=e?1:0),e||(s.__pathForRender=void 0),this.__setAttr(t,e),Pr(this)}})))}const Ir=Sr;function Or(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&Er(this)}})))}function Er(t){t.__layout.strokeChanged||t.__layout.strokeChange(),t.__.__useArrow&&Pr(t)}const Ar=Or;function Mr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e),this.__layout.renderChanged||this.__layout.renderChange()}})))}function Wr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}})))}function Dr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.opacityChanged||this.__layout.opacityChange())}})))}function Fr(t){return wr(t,(t=>({set(e){const s=this.visible;if(!0===s&&0===e){if(this.animationOut)return this.__runAnimation("out",(()=>zr(this,t,e,s)))}else 0===s&&!0===e&&this.animation&&this.__runAnimation("in");zr(this,t,e,s)}})))}function zr(t,e,s,i){t.__setAttr(e,s)&&(t.__layout.opacityChanged||t.__layout.opacityChange(),0!==i&&0!==s||Pr(t))}function Ur(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange(),this.waitParent((()=>{this.parent.__layout.childrenSortChange()})))}})))}function Nr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent((()=>{this.parent.__updateMask(e)})))}})))}function Yr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&this.waitParent((()=>{this.parent.__updateEraser(e)}))}})))}function Xr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e)&&(this.__layout.hitCanvasChanged=!0,xt.showHitView&&(this.__layout.surfaceChanged||this.__layout.surfaceChange()),this.leafer&&this.leafer.updateCursor())}})))}function jr(t){return wr(t,(t=>({set(e){this.__setAttr(t,e),this.leafer&&this.leafer.updateCursor()}})))}function Hr(t){return(e,s)=>{yr(e,"__DataProcessor",{get:()=>t})}}function Vr(t,e,s){const i=t.__DataProcessor.prototype,r="_"+e,o=function(t){return"set"+t.charAt(0).toUpperCase()+t.slice(1)}(e),n={get(){const t=this[r];return void 0===t?s:t},set(t){this[r]=t}};if(void 0===s)n.get=function(){return this[r]};else if("object"==typeof s){const{clone:t}=At;n.get=function(){let e=this[r];return void 0===e&&(this[r]=e=t(s)),e}}"width"===e?n.get=function(){const t=this[r];if(void 0===t){const t=this;return t._height&&t.__naturalWidth&&t.__useNaturalRatio?t._height*t.__naturalWidth/t.__naturalHeight:t.__naturalWidth||s}return t}:"height"===e&&(n.get=function(){const t=this[r];if(void 0===t){const t=this;return t._width&&t.__naturalHeight&&t.__useNaturalRatio?t._width*t.__naturalHeight/t.__naturalWidth:t.__naturalHeight||s}return t});let a,h=i;for(;!a&&h;)a=mr(h,e),h=h.__proto__;a&&a.set&&(n.set=a.set),i[o]&&(n.set=i[o],delete i[o]),yr(i,e,n)}const Gr=new xt("rewrite"),qr=[],Qr=["destroy","constructor"];function Jr(t){return(e,s)=>{qr.push({name:e.constructor.name+"."+s,run:()=>{e[s]=t}})}}function $r(){return t=>{Zr()}}function Zr(t){qr.length&&(qr.forEach((e=>{t&&Gr.error(e.name,"Class@rewriteAble()"),e.run()})),qr.length=0)}function Kr(t,e){return s=>{var i;(t.prototype?(i=t.prototype,Object.getOwnPropertyNames(i)):Object.keys(t)).forEach((i=>{if(!(Qr.includes(i)||e&&e.includes(i)))if(t.prototype){mr(t.prototype,i).writable&&(s.prototype[i]=t.prototype[i])}else s.prototype[i]=t[i]}))}}function to(){return t=>{Tt.register(t)}}setTimeout((()=>Zr(!0)));const{copy:eo,toInnerPoint:so,toOuterPoint:io,scaleOfOuter:ro,rotateOfOuter:oo,skewOfOuter:no,multiplyParent:ao,divideParent:ho,getLayout:lo}=b,co={},uo={updateAllMatrix(t,e,s){if(e&&t.__hasAutoLayout&&t.__layout.matrixChanged&&(s=!0),go(t,e,s),t.isBranch){const{children:i}=t;for(let t=0,r=i.length;t<r;t++)po(i[t],e,s)}},updateMatrix(t,e,s){const i=t.__layout;e?s&&(i.waitAutoLayout=!0,t.__hasAutoLayout&&(i.matrixChanged=!1)):i.waitAutoLayout&&(i.waitAutoLayout=!1),i.matrixChanged&&t.__updateLocalMatrix(),i.waitAutoLayout||t.__updateWorldMatrix()},updateBounds(t){const e=t.__layout;e.boundsChanged&&t.__updateLocalBounds(),e.waitAutoLayout||t.__updateWorldBounds()},updateAllWorldOpacity(t){if(t.__updateWorldOpacity(),t.isBranch){const{children:e}=t;for(let t=0,s=e.length;t<s;t++)fo(e[t])}},updateAllChange(t){if(fo(t),t.__updateChange(),t.isBranch){const{children:e}=t;for(let t=0,s=e.length;t<s;t++)yo(e[t])}},worldHittable(t){for(;t;){if(!t.__.hittable)return!1;t=t.parent}return!0},moveWorld(t,e,s=0,i){const r="object"==typeof e?Object.assign({},e):{x:e,y:s};i?io(t.localTransform,r,r,!0):t.parent&&so(t.parent.worldTransform,r,r,!0),_o.moveLocal(t,r.x,r.y)},moveLocal(t,e,s=0){"object"==typeof e?(t.x+=e.x,t.y+=e.y):(t.x+=e,t.y+=s)},zoomOfWorld(t,e,s,i,r){_o.zoomOfLocal(t,wo(t,e),s,i,r)},zoomOfLocal(t,e,s,i=s,r){eo(co,t.__localMatrix),ro(co,e,s,i),t.origin||t.around?_o.setTransform(t,co,r):(mo(t,co),t.scaleResize(s,i,!0!==r))},rotateOfWorld(t,e,s){_o.rotateOfLocal(t,wo(t,e),s)},rotateOfLocal(t,e,s){eo(co,t.__localMatrix),oo(co,e,s),t.origin||t.around?_o.setTransform(t,co):(mo(t,co),t.rotation=h.formatRotation(t.rotation+s))},skewOfWorld(t,e,s,i,r){_o.skewOfLocal(t,wo(t,e),s,i,r)},skewOfLocal(t,e,s,i=0,r){eo(co,t.__localMatrix),no(co,e,s,i),_o.setTransform(t,co,r)},transformWorld(t,e,s){eo(co,t.worldTransform),ao(co,e),t.parent&&ho(co,t.parent.worldTransform),_o.setTransform(t,co,s)},transform(t,e,s){eo(co,t.localTransform),ao(co,e),_o.setTransform(t,co,s)},setTransform(t,e,s){const i=lo(e,t.origin&&_o.getInnerOrigin(t,t.origin),t.around&&_o.getInnerOrigin(t,t.around));if(s){const e=i.scaleX/t.scaleX,r=i.scaleY/t.scaleY;delete i.scaleX,delete i.scaleY,t.set(i),t.scaleResize(e,r,!0!==s)}else t.set(i)},getFlipTransform(t,e){const s={a:1,b:0,c:0,d:1,e:0,f:0},i="x"===e?1:-1;return ro(s,_o.getLocalOrigin(t,"center"),-1*i,1*i),s},getLocalOrigin:(t,e)=>E.tempToOuterOf(_o.getInnerOrigin(t,e),t.localTransform),getInnerOrigin(t,e){const s={};return gt.toPoint(e,t.boxBounds,s),s},getRelativeWorld:(t,e,s)=>(eo(co,t.worldTransform),ho(co,e.worldTransform),s?co:Object.assign({},co)),drop(t,e,s,i){t.setTransform(_o.getRelativeWorld(t,e,!0),i),e.add(t,s)},hasParent(t,e){if(!e)return!1;for(;t;){if(e===t)return!0;t=t.parent}}},_o=uo,{updateAllMatrix:po,updateMatrix:go,updateAllWorldOpacity:fo,updateAllChange:yo}=_o;function mo(t,e){const{e:s,f:i}=t.__localMatrix;t.x+=e.e-s,t.y+=e.f-i}function wo(t,e){return t.__layout.update(),t.parent?E.tempToInnerOf(e,t.parent.__world):e}const xo={worldBounds:t=>t.__world,localBoxBounds:t=>t.__.eraser||0===t.__.visible?null:t.__local||t.__layout,localStrokeBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localStrokeBounds,localRenderBounds:t=>t.__.eraser||0===t.__.visible?null:t.__layout.localRenderBounds,maskLocalBoxBounds:t=>t.__.mask?t.__localBoxBounds:null,maskLocalStrokeBounds:t=>t.__.mask?t.__layout.localStrokeBounds:null,maskLocalRenderBounds:t=>t.__.mask?t.__layout.localRenderBounds:null,excludeRenderBounds:(t,e)=>!(!e.bounds||e.bounds.hit(t.__world,e.matrix))||!(!e.hideBounds||!e.hideBounds.includes(t.__world,e.matrix))},{updateBounds:vo}=uo,bo={sort:(t,e)=>t.__.zIndex===e.__.zIndex?t.__tempNumber-e.__tempNumber:t.__.zIndex-e.__.zIndex,pushAllChildBranch(t,e){if(t.__tempNumber=1,t.__.__childBranchNumber){const{children:s}=t;for(let i=0,r=s.length;i<r;i++)(t=s[i]).isBranch&&(t.__tempNumber=1,e.add(t),Bo(t,e))}},pushAllParent(t,e){const{keys:s}=e;if(s)for(;t.parent&&void 0===s[t.parent.innerId];)e.add(t.parent),t=t.parent;else for(;t.parent;)e.add(t.parent),t=t.parent},pushAllBranchStack(t,e){let s=e.length;const{children:i}=t;for(let t=0,s=i.length;t<s;t++)i[t].isBranch&&e.push(i[t]);for(let t=s,i=e.length;t<i;t++)ko(e[t],e)},updateBounds(t,e){const s=[t];ko(t,s),Ro(s,e)},updateBoundsByBranchStack(t,e){let s,i;for(let r=t.length-1;r>-1;r--){s=t[r],i=s.children;for(let t=0,e=i.length;t<e;t++)vo(i[t]);e&&e===s||vo(s)}}},{pushAllChildBranch:Bo,pushAllBranchStack:ko,updateBoundsByBranchStack:Ro}=bo,Co={run(t){if(t&&t.length){const e=t.length;for(let s=0;s<e;s++)t[s]();t.length===e?t.length=0:t.splice(0,e)}}},{getRelativeWorld:So}=uo,{toOuterOf:To,getPoints:Po,copy:Lo}=ot,Io="_localContentBounds",Oo="_worldContentBounds",Eo="_worldBoxBounds",Ao="_worldStrokeBounds";class Mo{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(t){this._contentBounds=t}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}get localContentBounds(){return To(this.contentBounds,this.leaf.__localMatrix,this[Io]||(this[Io]={})),this[Io]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return To(this.contentBounds,this.leaf.__world,this[Oo]||(this[Oo]={})),this[Oo]}get worldBoxBounds(){return To(this.boxBounds,this.leaf.__world,this[Eo]||(this[Eo]={})),this[Eo]}get worldStrokeBounds(){return To(this.strokeBounds,this.leaf.__world,this[Ao]||(this[Ao]={})),this[Ao]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(t){this.leaf=t,this.boxBounds={x:0,y:0,width:0,height:0},this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),this.boxChange(),this.matrixChange()}createLocal(){const t=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||(this._localStrokeBounds=t),this._localRenderBounds||(this._localRenderBounds=t)}update(){const{leafer:t}=this.leaf;if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let t=this.leaf;for(;t.parent&&!t.parent.leafer;)t=t.parent;e.layout(t)}}getTransform(t="world"){this.update();const{leaf:e}=this;switch(t){case"world":return e.__world;case"local":return e.__localMatrix;case"inner":return b.defaultMatrix;case"page":t=e.zoomLayer;default:return So(e,t)}}getBounds(t,e="world"){switch(this.update(),e){case"world":return this.getWorldBounds(t);case"local":return this.getLocalBounds(t);case"inner":return this.getInnerBounds(t);case"page":e=this.leaf.zoomLayer;default:return new lt(this.getInnerBounds(t)).toOuterOf(this.getTransform(e))}}getInnerBounds(t="box"){switch(t){case"render":return this.renderBounds;case"content":if(this.contentBounds)return this.contentBounds;case"box":return this.boxBounds;case"stroke":return this.strokeBounds}}getLocalBounds(t="box"){switch(t){case"render":return this.localRenderBounds;case"stroke":return this.localStrokeBounds;case"content":if(this.contentBounds)return this.localContentBounds;case"box":return this.leaf.__localBoxBounds}}getWorldBounds(t="box"){switch(t){case"render":return this.leaf.__world;case"stroke":return this.worldStrokeBounds;case"content":if(this.contentBounds)return this.worldContentBounds;case"box":return this.worldBoxBounds}}getLayoutBounds(t,e="world",s){const{leaf:i}=this;let r,o,n,a=this.getInnerBounds(t);switch(e){case"world":r=i.getWorldPoint(a),o=i.__world;break;case"local":const{scaleX:t,scaleY:s,rotation:h,skewX:l,skewY:d}=i.__;n={scaleX:t,scaleY:s,rotation:h,skewX:l,skewY:d},r=i.getLocalPointByInner(a);break;case"inner":r=a,o=b.defaultMatrix;break;case"page":e=i.zoomLayer;default:r=i.getWorldPoint(a,e),o=So(i,e,!0)}if(n||(n=b.getLayout(o)),Lo(n,a),E.copy(n,r),s){const{scaleX:t,scaleY:e}=n,s=Math.abs(t),i=Math.abs(e);1===s&&1===i||(n.scaleX/=s,n.scaleY/=i,n.width*=s,n.height*=i)}return n}getLayoutPoints(t,e="world"){const{leaf:s}=this,i=Po(this.getInnerBounds(t));let r;switch(e){case"world":r=null;break;case"local":r=s.parent;break;case"inner":break;case"page":e=s.zoomLayer;default:r=e}return void 0!==r&&i.forEach((t=>s.innerToWorld(t,null,!1,r))),i}shrinkContent(){const{x:t,y:e,width:s,height:i}=this.boxBounds;this._contentBounds={x:t,y:e,width:s,height:i}}spreadStroke(){const{x:t,y:e,width:s,height:i}=this.strokeBounds;this._strokeBounds={x:t,y:e,width:s,height:i},this._localStrokeBounds={x:t,y:e,width:s,height:i},this.renderSpread||this.spreadRenderCancel()}spreadRender(){const{x:t,y:e,width:s,height:i}=this.renderBounds;this._renderBounds={x:t,y:e,width:s,height:i},this._localRenderBounds={x:t,y:e,width:s,height:i}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){const t=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,t&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged||this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||(this.strokeSpread=1),this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||(this.renderSpread=1),this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged||this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=!0,this.leaf.forceUpdate("surface"))}destroy(){}}class Wo{constructor(t,e){this.bubbles=!1,this.type=t,e&&(this.target=e)}stopDefault(){this.isStopDefault=!0,this.origin&&e.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&e.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&e.event.stop(this.origin)}}class Do extends Wo{constructor(t,e,s){super(t,e),this.parent=s,this.child=e}}Do.ADD="child.add",Do.REMOVE="child.remove",Do.CREATED="created",Do.MOUNTED="mounted",Do.UNMOUNTED="unmounted",Do.DESTROY="destroy";class Fo extends Wo{constructor(t,e,s,i,r){super(t,e),this.attrName=s,this.oldValue=i,this.newValue=r}}Fo.CHANGE="property.change",Fo.LEAFER_CHANGE="property.leafer_change";class zo extends Wo{constructor(t,e){super(t),Object.assign(this,e)}}zo.LOAD="image.load",zo.LOADED="image.loaded",zo.ERROR="image.error";class Uo extends Wo{get bigger(){if(!this.old)return!0;const{width:t,height:e}=this.old;return this.width>=t&&this.height>=e}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,e){"object"==typeof t?(super(Uo.RESIZE),Object.assign(this,t)):super(t),this.old=e}}Uo.RESIZE="resize";class No extends Wo{constructor(t,e){super(t),this.data=e}}No.REQUEST="watch.request",No.DATA="watch.data";class Yo extends Wo{constructor(t,e,s){super(t),e&&(this.data=e,this.times=s)}}Yo.CHECK_UPDATE="layout.check_update",Yo.REQUEST="layout.request",Yo.START="layout.start",Yo.BEFORE="layout.before",Yo.LAYOUT="layout",Yo.AFTER="layout.after",Yo.AGAIN="layout.again",Yo.END="layout.end";class Xo extends Wo{constructor(t,e,s,i){super(t),e&&(this.times=e),s&&(this.renderBounds=s,this.renderOptions=i)}}Xo.REQUEST="render.request",Xo.CHILD_START="render.child_start",Xo.START="render.start",Xo.BEFORE="render.before",Xo.RENDER="render",Xo.AFTER="render.after",Xo.AGAIN="render.again",Xo.END="render.end",Xo.NEXT="render.next";class jo extends Wo{}jo.START="leafer.start",jo.BEFORE_READY="leafer.before_ready",jo.READY="leafer.ready",jo.AFTER_READY="leafer.after_ready",jo.VIEW_READY="leafer.view_ready",jo.VIEW_COMPLETED="leafer.view_completed",jo.STOP="leafer.stop",jo.RESTART="leafer.restart",jo.END="leafer.end";const Ho={};class Vo{set event(t){this.on(t)}on(t,e,s){if(!e){let e,s=t;for(let t in s)e=s[t],e instanceof Array?this.on(t,e[0],e[1]):this.on(t,e);return}let i,r,o;s&&("once"===s?r=!0:"boolean"==typeof s?i=s:(i=s.capture,r=s.once));const n=Go(this,i,!0),a="string"==typeof t?t.split(" "):t,h=r?{listener:e,once:r}:{listener:e};a.forEach((t=>{t&&(o=n[t],o?-1===o.findIndex((t=>t.listener===e))&&o.push(h):n[t]=[h])}))}off(t,e,s){if(t){const i="string"==typeof t?t.split(" "):t;if(e){let t,r,o;s&&(t="boolean"==typeof s?s:"once"!==s&&s.capture);const n=Go(this,t);i.forEach((t=>{t&&(r=n[t],r&&(o=r.findIndex((t=>t.listener===e)),o>-1&&r.splice(o,1),r.length||delete n[t]))}))}else{const{__bubbleMap:t,__captureMap:e}=this;i.forEach((s=>{t&&delete t[s],e&&delete e[s]}))}}else this.__bubbleMap=this.__captureMap=void 0}on_(t,e,s,i){return s&&(e=e.bind(s)),this.on(t,e,i),{type:t,current:this,listener:e,options:i}}off_(t){if(!t)return;const e=t instanceof Array?t:[t];e.forEach((t=>t.current.off(t.type,t.listener,t.options))),e.length=0}once(t,e,s){this.on(t,e,{once:!0,capture:s})}emit(t,e,s){!e&&It.has(t)&&(e=It.get(t,{type:t,target:this,current:this}));const i=Go(this,s)[t];if(i){let r;for(let o=0,n=i.length;o<n&&(r=i[o],r.listener(e),r.once&&(this.off(t,r.listener,s),o--,n--),!e||!e.isStopNow);o++);}this.syncEventer&&this.syncEventer.emitEvent(e,s)}emitEvent(t,e){t.current=this,this.emit(t.type,t,e)}hasEvent(t,e){if(this.syncEventer&&this.syncEventer.hasEvent(t,e))return!0;const{__bubbleMap:s,__captureMap:i}=this,r=s&&s[t],o=i&&i[t];return!!(void 0===e?r||o:e?o:r)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}}function Go(t,e,s){if(e){const{__captureMap:e}=t;return e||(s?t.__captureMap={}:Ho)}{const{__bubbleMap:e}=t;return e||(s?t.__bubbleMap={}:Ho)}}const{on:qo,on_:Qo,off:Jo,off_:$o,once:Zo,emit:Ko,emitEvent:tn,hasEvent:en,destroy:sn}=Vo.prototype,rn={on:qo,on_:Qo,off:Jo,off_:$o,once:Zo,emit:Ko,emitEvent:tn,hasEvent:en,destroyEventer:sn},{isFinite:on}=Number,nn=xt.get("setAttr"),an={__setAttr(t,e,s){if(this.leaferIsCreated){const i=this.__.__getInput(t);if(s&&!on(e)&&void 0!==e&&(nn.warn(this.innerName,t,e),e=void 0),"object"==typeof e||i!==e){this.__realSetAttr(t,e);const{CHANGE:s}=Fo,r=new Fo(s,this,t,i,e);return this.isLeafer?this.emitEvent(new Fo(Fo.LEAFER_CHANGE,this,t,i,e)):this.hasEvent(s)&&this.emitEvent(r),this.leafer.emitEvent(r),!0}return!1}return this.__realSetAttr(t,e),!0},__realSetAttr(t,e){const s=this.__;s[t]=e,this.__proxyData&&this.setProxyAttr(t,e),s.normalStyle&&(this.lockNormalStyle||void 0===s.normalStyle[t]||(s.normalStyle[t]=e))},__getAttr(t){return this.__proxyData?this.getProxyAttr(t):this.__.__get(t)}},{setLayout:hn,multiplyParent:ln,translateInner:dn,defaultWorld:cn}=b,{toPoint:un,tempPoint:_n}=gt,pn={__updateWorldMatrix(){ln(this.__local||this.__layout,this.parent?this.parent.__world:cn,this.__world,!!this.__layout.affectScaleOrRotation,this.__,this.parent&&this.parent.__)},__updateLocalMatrix(){if(this.__local){const t=this.__layout,e=this.__local,s=this.__;t.affectScaleOrRotation&&(t.scaleChanged||t.rotationChanged)&&(hn(e,s,null,null,t.affectRotation),t.scaleChanged=t.rotationChanged=!1),e.e=s.x+s.offsetX,e.f=s.y+s.offsetY,(s.around||s.origin)&&(un(s.around||s.origin,t.boxBounds,_n),dn(e,-_n.x,-_n.y,!s.around))}this.__layout.matrixChanged=!1}},{updateMatrix:gn,updateAllMatrix:fn}=uo,{updateBounds:yn}=bo,{toOuterOf:mn,copyAndSpread:wn,copy:xn}=ot,{toBounds:vn}=Qi,bn={__updateWorldBounds(){mn(this.__layout.renderBounds,this.__world,this.__world),this.__layout.resized&&(this.__onUpdateSize(),this.__layout.resized=!1)},__updateLocalBounds(){const t=this.__layout;t.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),t.resized=!0),t.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),t.localBoxChanged=!1,t.strokeSpread&&(t.strokeChanged=!0),t.renderSpread&&(t.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),t.boxChanged=!1,t.strokeChanged&&(t.strokeSpread=this.__updateStrokeSpread(),t.strokeSpread?(t.strokeBounds===t.boxBounds&&t.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):t.spreadStrokeCancel(),t.strokeChanged=!1,(t.renderSpread||t.strokeSpread!==t.strokeBoxSpread)&&(t.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),t.resized=!0),t.renderChanged&&(t.renderSpread=this.__updateRenderSpread(),t.renderSpread?(t.renderBounds!==t.boxBounds&&t.renderBounds!==t.strokeBounds||t.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):t.spreadRenderCancel(),t.renderChanged=!1,this.parent&&this.parent.__layout.renderChange()),t.boundsChanged=!1},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),mn(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){mn(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){mn(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(){const t=this.__layout.boxBounds,e=this.__;e.__pathInputed?vn(e.path,t):(t.x=0,t.y=0,t.width=e.width,t.height=e.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.leaferIsReady&&this.leafer.layouter.addExtra(this),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),fn(this),yn(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(fn(this),yn(this,this))):gn(this)},__updateNaturalSize(){const{__:t,__layout:e}=this;t.__naturalWidth=e.boxBounds.width,t.__naturalHeight=e.boxBounds.height},__updateStrokeBounds(){const t=this.__layout;wn(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(){const t=this.__layout;t.renderSpread>0?wn(t.renderBounds,t.boxBounds,t.renderSpread):xn(t.renderBounds,t.strokeBounds)}},Bn={__render(t,e){if(this.__worldOpacity)if(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),t.opacity=this.__.opacity,this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!0,!0);this.__draw(s,e),this.__worldFlipped?t.copyWorldByReset(s,this.__nowWorld,null,this.__.__blendMode,!0):t.copyWorldToInner(s,this.__nowWorld,this.__layout.renderBounds,this.__.__blendMode),s.recycle(this.__nowWorld)}else this.__draw(t,e)},__clip(t,e){this.__worldOpacity&&(t.setWorld(this.__nowWorld=this.__getNowWorld(e)),this.__drawRenderPath(t),this.windingRule?t.clip(this.windingRule):t.clip())},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:kn}=xo,Rn={__updateChange(){const{__layout:t}=this;t.childrenSortChanged&&(this.__updateSortChildren(),t.childrenSortChanged=!1),this.__.__checkSingle()},__render(t,e){if(this.__nowWorld=this.__getNowWorld(e),this.__worldOpacity)if(this.__.__single){if("path"===this.__.eraser)return this.__renderEraser(t,e);const s=t.getSameCanvas(!1,!0);this.__renderBranch(s,e);const i=this.__nowWorld;t.opacity=this.__.opacity,t.copyWorldByReset(s,i,i,this.__.__blendMode,!0),s.recycle(i)}else this.__renderBranch(t,e)},__renderBranch(t,e){if(this.__hasMask)this.__renderMask(t,e);else{const{children:s}=this;for(let i=0,r=s.length;i<r;i++)kn(s[i],e)||s[i].__render(t,e)}},__clip(t,e){if(this.__worldOpacity){const{children:s}=this;for(let i=0,r=s.length;i<r;i++)kn(s[i],e)||s[i].__clip(t,e)}}},{LEAF:Cn,create:Sn}=i,{toInnerPoint:Tn,toOuterPoint:Pn,multiplyParent:Ln}=b,{toOuterOf:In}=ot,{copy:On,move:En}=E,{moveLocal:An,zoomOfLocal:Mn,rotateOfLocal:Wn,skewOfLocal:Dn,moveWorld:Fn,zoomOfWorld:zn,rotateOfWorld:Un,skewOfWorld:Nn,transform:Yn,transformWorld:Xn,setTransform:jn,getFlipTransform:Hn,getLocalOrigin:Vn,getRelativeWorld:Gn,drop:qn}=uo;t.Leaf=class{get tag(){return this.__tag}set tag(t){}get __tag(){return"Leaf"}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return Wt}get __LayoutProcessor(){return Mo}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform("world")}get localTransform(){return this.__layout.getTransform("local")}get boxBounds(){return this.getBounds("box","inner")}get renderBounds(){return this.getBounds("render","inner")}get worldBoxBounds(){return this.getBounds("box")}get worldStrokeBounds(){return this.getBounds("stroke")}get worldRenderBounds(){return this.getBounds("render")}get worldOpacity(){return this.__layout.update(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){const{leafer:t}=this;return t&&t.created&&t.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(t){this.on(t)}constructor(t){this.innerId=Sn(Cn),this.reset(t),this.__bubbleMap&&this.__emitLifeEvent(Do.CREATED)}reset(t){this.leafer&&this.leafer.forceRender(this.__world),this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},null!==t&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0}),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),t&&(t.__&&(t=t.toJSON()),t.children?this.set(t):Object.assign(this,t))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(t,e){e&&(t=t.bind(e)),this.parent?t():this.on(Do.ADD,t,"once")}waitLeafer(t,e){e&&(t=t.bind(e)),this.leafer?t():this.on(Do.MOUNTED,t,"once")}nextRender(t,e,s){this.leafer?this.leafer.nextRender(t,e,s):this.waitLeafer((()=>this.leafer.nextRender(t,e,s)))}removeNextRender(t){this.nextRender(t,null,"off")}__bindLeafer(t){if(this.isLeafer&&null!==t&&(t=this),this.leafer&&!t&&this.leafer.leafs--,this.leafer=t,t?(t.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation("in"),this.__bubbleMap&&this.__emitLifeEvent(Do.MOUNTED)):this.__emitLifeEvent(Do.UNMOUNTED),this.isBranch){const{children:e}=this;for(let s=0,i=e.length;s<i;s++)e[s].__bindLeafer(t)}}set(t,e){}get(t){}setAttr(t,e){this[t]=e}getAttr(t){return this[t]}getComputedAttr(t){return this.__[t]}toJSON(t){return t&&this.__layout.update(),this.__.__getInputData(null,t)}toString(t){return JSON.stringify(this.toJSON(t))}toSVG(){}__SVG(t){}toHTML(){}__setAttr(t,e){return!0}__getAttr(t){}setProxyAttr(t,e){}getProxyAttr(t){}find(t,e){}findTag(t){}findOne(t,e){}findId(t){}focus(t){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(t){void 0===t?t="width":"surface"===t&&(t="blendMode");const e=this.__.__getInput(t);this.__[t]=void 0===e?null:void 0,this[t]=e}forceRender(t){this.forceUpdate("surface")}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(){}__updateContentBounds(){}__updateStrokeBounds(){}__updateRenderBounds(){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(t){this.__hasEraser=!!t||this.children.some((t=>t.__.eraser))}__renderEraser(t,e){t.save(),this.__clip(t,e);const{renderBounds:s}=this.__layout;t.clearRect(s.x,s.y,s.width,s.height),t.restore()}__updateMask(t){this.__hasMask=!!t||this.children.some((t=>t.__.mask))}__renderMask(t,e){}__getNowWorld(t){if(t.matrix){this.__cameraWorld||(this.__cameraWorld={});const e=this.__cameraWorld;return Ln(this.__world,t.matrix,e,void 0,this.__world),In(this.__layout.renderBounds,e,e),e}return this.__world}getTransform(t){return this.__layout.getTransform(t||"local")}getBounds(t,e){return this.__layout.getBounds(t,e)}getLayoutBounds(t,e,s){return this.__layout.getLayoutBounds(t,e,s)}getLayoutPoints(t,e){return this.__layout.getLayoutPoints(t,e)}getWorldBounds(t,e,s){const i=e?Gn(this,e):this.worldTransform,r=s?t:{};return In(t,i,r),r}worldToLocal(t,e,s,i){this.parent?this.parent.worldToInner(t,e,s,i):e&&On(e,t)}localToWorld(t,e,s,i){this.parent?this.parent.innerToWorld(t,e,s,i):e&&On(e,t)}worldToInner(t,e,s,i){i&&(i.innerToWorld(t,e,s),t=e||t),Tn(this.worldTransform,t,e,s)}innerToWorld(t,e,s,i){Pn(this.worldTransform,t,e,s),i&&i.worldToInner(e||t,null,s)}getBoxPoint(t,e,s,i){return this.getBoxPointByInner(this.getInnerPoint(t,e,s,i),null,null,!0)}getBoxPointByInner(t,e,s,i){const r=i?t:Object.assign({},t),{x:o,y:n}=this.boxBounds;return En(r,-o,-n),r}getInnerPoint(t,e,s,i){const r=i?t:{};return this.worldToInner(t,r,s,e),r}getInnerPointByBox(t,e,s,i){const r=i?t:Object.assign({},t),{x:o,y:n}=this.boxBounds;return En(r,o,n),r}getInnerPointByLocal(t,e,s,i){return this.getInnerPoint(t,this.parent,s,i)}getLocalPoint(t,e,s,i){const r=i?t:{};return this.worldToLocal(t,r,s,e),r}getLocalPointByInner(t,e,s,i){return this.getWorldPoint(t,this.parent,s,i)}getPagePoint(t,e,s,i){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(t,e,s,i)}getWorldPoint(t,e,s,i){const r=i?t:{};return this.innerToWorld(t,r,s,e),r}getWorldPointByBox(t,e,s,i){return this.getWorldPoint(this.getInnerPointByBox(t,null,null,i),e,s,!0)}getWorldPointByLocal(t,e,s,i){const r=i?t:{};return this.localToWorld(t,r,s,e),r}getWorldPointByPage(t,e,s,i){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(t,e,s,i)}setTransform(t,e){jn(this,t,e)}transform(t,e){Yn(this,t,e)}move(t,e){An(this,t,e)}moveInner(t,e){Fn(this,t,e,!0)}scaleOf(t,e,s,i){Mn(this,Vn(this,t),e,s,i)}rotateOf(t,e){Wn(this,Vn(this,t),e)}skewOf(t,e,s,i){Dn(this,Vn(this,t),e,s,i)}transformWorld(t,e){Xn(this,t,e)}moveWorld(t,e){Fn(this,t,e)}scaleOfWorld(t,e,s,i){zn(this,t,e,s,i)}rotateOfWorld(t,e){Un(this,t,e)}skewOfWorld(t,e,s,i){Nn(this,t,e,s,i)}flip(t){Yn(this,Hn(this,t))}scaleResize(t,e=t,s){this.scaleX*=t,this.scaleY*=e}__scaleResize(t,e){}resizeWidth(t){}resizeHeight(t){}__hitWorld(t){return!0}__hit(t){return!0}__hitFill(t){return!0}__hitStroke(t,e){return!0}__hitPixel(t){return!0}__drawHitPath(t){}__updateHitCanvas(){}__render(t,e){}__drawFast(t,e){}__draw(t,e){}__clip(t,e){}__renderShape(t,e,s,i){}__updateWorldOpacity(){}__updateChange(){}__drawPath(t){}__drawRenderPath(t){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Ct("path")}getMotionPoint(t){return Ct("path")}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(t,e){}__updateSortChildren(){}add(t,e){}remove(t,e){this.parent&&this.parent.remove(this,e)}dropTo(t,e,s){qn(this,t,e,s)}on(t,e,s){}off(t,e,s){}on_(t,e,s,i){}off_(t){}once(t,e,s){}emit(t,e,s){}emitEvent(t,e){}hasEvent(t,e){return!1}static changeAttr(t,e,s){s?this.addAttr(t,e,s):Vr(this.prototype,t,e)}static addAttr(t,e,s){s||(s=Sr),s(e)(this.prototype,t)}__emitLifeEvent(t){this.hasEvent(t)&&this.emitEvent(new Do(t,this,this.parent))}destroy(){this.destroyed||(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(Do.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),this.destroyed=!0)}},t.Leaf=Ft([Kr(an),Kr(pn),Kr(bn),Kr(rn),Kr(Bn)],t.Leaf);const{setListWithFn:Qn}=ot,{sort:Jn}=bo,{localBoxBounds:$n,localStrokeBounds:Zn,localRenderBounds:Kn,maskLocalBoxBounds:ta,maskLocalStrokeBounds:ea,maskLocalRenderBounds:sa}=xo;t.Branch=class extends t.Leaf{__updateStrokeSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){const{children:t}=this;for(let e=0,s=t.length;e<s;e++)if(t[e].__layout.renderSpread)return 1;return 0}__updateBoxBounds(){Qn(this.__layout.boxBounds,this.children,this.__hasMask?ta:$n)}__updateStrokeBounds(){Qn(this.__layout.strokeBounds,this.children,this.__hasMask?ea:Zn)}__updateRenderBounds(){Qn(this.__layout.renderBounds,this.children,this.__hasMask?sa:Kn)}__updateSortChildren(){let t;const{children:e}=this;if(e.length>1){for(let s=0,i=e.length;s<i;s++)e[s].__tempNumber=s,e[s].__.zIndex&&(t=!0);e.sort(Jn),this.__layout.affectChildrenSort=t}}add(t,e){if(t===this)return;const s=void 0===e;if(!t.__){if(t instanceof Array)return t.forEach((t=>{this.add(t,e),s||e++}));t=Tt.get(t.tag,t)}t.parent&&t.parent.remove(t),t.parent=this,s?this.children.push(t):this.children.splice(e,0,t),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1),t.__layout.boxChanged||t.__layout.boxChange(),t.__layout.matrixChanged||t.__layout.matrixChange(),t.__bubbleMap&&t.__emitLifeEvent(Do.ADD),this.leafer&&(t.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(Do.ADD,t)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...t){this.add(t)}remove(t,e){t?t.__?t.animationOut?t.__runAnimation("out",(()=>this.__remove(t,e))):this.__remove(t,e):this.find(t).forEach((t=>this.remove(t,e))):void 0===t&&super.remove(null,e)}removeAll(t){const{children:e}=this;e.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,e.forEach((e=>{this.__realRemoveChild(e),t&&e.destroy()})))}clear(){this.removeAll(!0)}__remove(t,e){const s=this.children.indexOf(t);s>-1&&(this.children.splice(s,1),t.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(t),e&&t.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(t){t.__emitLifeEvent(Do.REMOVE),t.parent=null,this.leafer&&(t.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(Do.REMOVE,t),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(t,e){const s=new Do(t,e,this);this.hasEvent(t)&&!this.isLeafer&&this.emitEvent(s),this.leafer.emitEvent(s)}},t.Branch=Ft([Kr(Rn)],t.Branch);class ia{get length(){return this.list.length}constructor(t){this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return t&&void 0!==this.keys[t.innerId]}indexAt(t){return this.list[t]}indexOf(t){const e=this.keys[t.innerId];return void 0===e?-1:e}add(t){const{list:e,keys:s}=this;void 0===s[t.innerId]&&(e.push(t),s[t.innerId]=e.length-1)}addAt(t,e=0){const{keys:s}=this;if(void 0===s[t.innerId]){const{list:i}=this;for(let t=e,r=i.length;t<r;t++)s[i[t].innerId]++;0===e?i.unshift(t):(e>i.length&&(e=i.length),i.splice(e,0,t)),s[t.innerId]=e}}addList(t){for(let e=0;e<t.length;e++)this.add(t[e])}remove(t){const{list:e}=this;let s;for(let i=0,r=e.length;i<r;i++)void 0!==s?this.keys[e[i].innerId]=i-1:e[i].innerId===t.innerId&&(s=i,delete this.keys[t.innerId]);void 0!==s&&e.splice(s,1)}sort(t){const{list:e}=this;t?e.sort(((t,e)=>e.__level-t.__level)):e.sort(((t,e)=>t.__level-e.__level))}forEach(t){this.list.forEach(t)}clone(){const t=new ia;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};const{list:t,keys:e}=this;for(let s=0,i=t.length;s<i;s++)e[t[s].innerId]=s}reset(){this.list=[],this.keys={}}destroy(){this.reset()}}class ra{get length(){return this._length}constructor(t){this._length=0,this.reset(),t&&(t instanceof Array?this.addList(t):this.add(t))}has(t){return void 0!==this.keys[t.innerId]}without(t){return void 0===this.keys[t.innerId]}sort(t){const{levels:e}=this;t?e.sort(((t,e)=>e-t)):e.sort(((t,e)=>t-e))}addList(t){t.forEach((t=>{this.add(t)}))}add(t){const{keys:e,levelMap:s}=this;e[t.innerId]||(e[t.innerId]=1,s[t.__level]?s[t.__level].push(t):(s[t.__level]=[t],this.levels.push(t.__level)),this._length++)}forEach(t){let e;this.levels.forEach((s=>{e=this.levelMap[s];for(let s=0,i=e.length;s<i;s++)t(e[s])}))}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}}const oa=xt.get("LeaferCanvas");class na extends qt{set zIndex(t){const{style:e}=this.view;e.zIndex=t,this.setAbsolute(this.view)}set childIndex(t){const{view:e,parentView:s}=this;if(e&&s){const i=s.children[t];i?(this.setAbsolute(i),s.insertBefore(e,i)):s.appendChild(i)}}init(){const{config:t}=this,s=t.view||t.canvas;s?this.__createViewFrom(s):this.__createView();const{style:i}=this.view;if(i.display||(i.display="block"),this.parentView=this.view.parentElement,this.parentView){const t=this.parentView.style;t.webkitUserSelect=t.userSelect="none"}e.syncDomFont&&!this.parentView&&(i.display="none",document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(t)}set backgroundColor(t){this.view.style.backgroundColor=t}get backgroundColor(){return this.view.style.backgroundColor}set hittable(t){this.view.style.pointerEvents=t?"auto":"none"}get hittable(){return"none"!==this.view.style.pointerEvents}__createView(){this.view=document.createElement("canvas")}__createViewFrom(t){let e="string"==typeof t?document.getElementById(t):t;if(e)if(e instanceof HTMLCanvasElement)this.view=e;else{let t=e;if(e===window||e===document){const e=document.createElement("div"),{style:s}=e;s.position="absolute",s.top=s.bottom=s.left=s.right="0px",document.body.appendChild(e),t=e}this.__createView();const s=this.view;t.hasChildNodes()&&(this.setAbsolute(s),t.style.position||(t.style.position="relative")),t.appendChild(s)}else oa.error(`no id: ${t}`),this.__createView()}setAbsolute(t){const{style:e}=t;e.position="absolute",e.top=e.left="0px"}updateViewSize(){const{width:t,height:e,pixelRatio:s}=this,{style:i}=this.view;i.width=t+"px",i.height=e+"px",this.view.width=Math.ceil(t*s),this.view.height=Math.ceil(e*s)}updateClientBounds(){this.clientBounds=this.view.getBoundingClientRect()}startAutoLayout(t,s){if(this.resizeListener=s,t){this.autoBounds=t;try{this.resizeObserver=new ResizeObserver((t=>{this.updateClientBounds();for(const e of t)this.checkAutoBounds(e.contentRect)}));const t=this.parentView;t?(this.resizeObserver.observe(t),this.checkAutoBounds(t.getBoundingClientRect())):(this.checkAutoBounds(this.view),oa.warn("no parent"))}catch(t){this.imitateResizeObserver()}}else window.addEventListener("resize",(()=>{const t=e.devicePixelRatio;if(this.pixelRatio!==t){const{width:e,height:s}=this;this.emitResize({width:e,height:s,pixelRatio:t})}}))}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),e.requestRender(this.imitateResizeObserver.bind(this)))}checkAutoBounds(t){const s=this.view,{x:i,y:r,width:o,height:n}=this.autoBounds.getBoundsFrom(t),a={width:o,height:n,pixelRatio:e.devicePixelRatio};if(!this.isSameSize(a)){const{style:t}=s;t.marginLeft=i+"px",t.marginTop=r+"px",this.emitResize(a)}}stopAutoLayout(){this.autoLayout=!1,this.resizeListener=null,this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}emitResize(t){const e={};At.copyAttrs(e,this,Gt),this.resize(t),this.resizeListener&&void 0!==this.width&&this.resizeListener(new Uo(t,e))}unrealCanvas(){if(!this.unreal&&this.parentView){const t=this.view;t&&t.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),!this.unreal){const t=this.view;t.parentElement&&t.remove()}super.destroy()}}}nr(CanvasRenderingContext2D.prototype),nr(Path2D.prototype);const{mineType:aa,fileType:ha}=ar;function la(t,i){e.origin={createCanvas(t,e){const s=document.createElement("canvas");return s.width=t,s.height=e,s},canvasToDataURL:(t,e,s)=>t.toDataURL(aa(e),s),canvasToBolb:(t,e,s)=>new Promise((i=>t.toBlob(i,aa(e),s))),canvasSaveAs:(t,s,i)=>{const r=t.toDataURL(aa(ha(s)),i);return e.origin.download(r,s)},download:(t,e)=>new Promise((s=>{let i=document.createElement("a");i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),s()})),loadImage:t=>new Promise(((s,i)=>{const r=new Image,{crossOrigin:o}=e.image;o&&(r.setAttribute("crossOrigin",o),r.crossOrigin=o),r.onload=()=>{s(r)},r.onerror=t=>{i(t)},r.src=e.image.getRealURL(t)}))},e.event={stopDefault(t){t.preventDefault()},stopNow(t){t.stopImmediatePropagation()},stop(t){t.stopPropagation()}},e.canvas=s.canvas(),e.conicGradientSupport=!!e.canvas.context.createConicGradient}Object.assign(s,{canvas:(t,e)=>new na(t,e),image:t=>new fr(t)}),e.name="web",e.isMobile="ontouchstart"in window,e.requestRender=function(t){window.requestAnimationFrame(t)},yr(e,"devicePixelRatio",{get:()=>Math.max(1,devicePixelRatio)});const{userAgent:da}=navigator;da.indexOf("Firefox")>-1?(e.conicGradientRotate90=!0,e.intWheelDeltaY=!0,e.syncDomFont=!0):da.indexOf("Safari")>-1&&-1===da.indexOf("Chrome")&&(e.fullImageShadow=!0),da.indexOf("Windows")>-1?(e.os="Windows",e.intWheelDeltaY=!0):da.indexOf("Mac")>-1?e.os="Mac":da.indexOf("Linux")>-1&&(e.os="Linux");class ca{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){const t=new ia;return this.__updatedList.list.forEach((e=>{e.leafer&&t.add(e)})),t}return this.__updatedList}constructor(t,e){this.totalTimes=0,this.config={},this.__updatedList=new ia,this.target=t,e&&(this.config=At.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(Xo.REQUEST)}__onAttrChange(t){this.__updatedList.add(t.target),this.update()}__onChildEvent(t){t.type===Do.ADD?(this.hasAdd=!0,this.__pushChild(t.child)):(this.hasRemove=!0,this.__updatedList.add(t.parent)),this.update()}__pushChild(t){this.__updatedList.add(t),t.isBranch&&this.__loopChildren(t)}__loopChildren(t){const{children:e}=t;for(let t=0,s=e.length;t<s;t++)this.__pushChild(e[t])}__onRquestData(){this.target.emitEvent(new No(No.DATA,{updatedList:this.updatedList})),this.__updatedList=new ia,this.totalTimes++,this.changed=!1,this.hasVisible=!1,this.hasRemove=!1,this.hasAdd=!1}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Fo.CHANGE,this.__onAttrChange,this),t.on_([Do.ADD,Do.REMOVE],this.__onChildEvent,this),t.on_(No.REQUEST,this.__onRquestData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=null,this.__updatedList=null)}}const{updateAllMatrix:ua,updateBounds:_a,updateAllWorldOpacity:pa}=uo,{pushAllChildBranch:ga,pushAllParent:fa}=bo;const{worldBounds:ya}=xo,ma={x:0,y:0,width:1e5,height:1e5};class wa{constructor(t){this.updatedBounds=new lt,this.beforeBounds=new lt,this.afterBounds=new lt,t instanceof Array&&(t=new ia(t)),this.updatedList=t}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,ya)}setAfter(){const{list:t}=this.updatedList;t.some((t=>t.noBounds))?this.afterBounds.set(ma):this.afterBounds.setListWithFn(t,ya),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(t){this.updatedList.addList(t.updatedList.list),this.beforeBounds.add(t.beforeBounds),this.afterBounds.add(t.afterBounds),this.updatedBounds.add(t.updatedBounds)}destroy(){this.updatedList=null}}const{updateAllMatrix:xa,updateAllChange:va}=uo,ba=xt.get("Layouter");class Ba{constructor(t,e){this.totalTimes=0,this.config={},this.__levelList=new ra,this.target=t,e&&(this.config=At.default(e,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(!this.running)return;const{target:t}=this;this.times=0;try{t.emit(Yo.START),this.layoutOnce(),t.emitEvent(new Yo(Yo.END,this.layoutedBlocks,this.times))}catch(t){ba.error(t)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?ba.warn("layouting"):this.times>3?ba.warn("layout max times"):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(No.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){var t;if(!(null===(t=this.__updatedList)||void 0===t?void 0:t.length))return;const e=kt.start("PartLayout"),{target:s,__updatedList:i}=this,{BEFORE:r,LAYOUT:o,AFTER:n}=Yo,a=this.getBlocks(i);a.forEach((t=>t.setBefore())),s.emitEvent(new Yo(r,a,this.times)),this.extraBlock=null,i.sort(),function(t,e){let s;t.list.forEach((t=>{s=t.__layout,e.without(t)&&!s.proxyZoom&&(s.matrixChanged?(ua(t,!0),e.add(t),t.isBranch&&ga(t,e),fa(t,e)):s.boundsChanged&&(e.add(t),t.isBranch&&(t.__tempNumber=0),fa(t,e)))}))}(i,this.__levelList),function(t){let e,s,i;t.sort(!0),t.levels.forEach((r=>{e=t.levelMap[r];for(let t=0,r=e.length;t<r;t++){if(s=e[t],s.isBranch&&s.__tempNumber){i=s.children;for(let t=0,e=i.length;t<e;t++)i[t].isBranch||_a(i[t])}_a(s)}}))}(this.__levelList),function(t){let e;t.list.forEach((t=>{e=t.__layout,e.opacityChanged&&pa(t),e.stateStyleChanged&&setTimeout((()=>e.stateStyleChanged&&t.updateState())),t.__updateChange()}))}(i),this.extraBlock&&a.push(this.extraBlock),a.forEach((t=>t.setAfter())),s.emitEvent(new Yo(o,a,this.times)),s.emitEvent(new Yo(n,a,this.times)),this.addBlocks(a),this.__levelList.reset(),this.__updatedList=null,kt.end(e)}fullLayout(){const t=kt.start("FullLayout"),{target:e}=this,{BEFORE:s,LAYOUT:i,AFTER:r}=Yo,o=this.getBlocks(new ia(e));e.emitEvent(new Yo(s,o,this.times)),Ba.fullLayout(e),o.forEach((t=>{t.setAfter()})),e.emitEvent(new Yo(i,o,this.times)),e.emitEvent(new Yo(r,o,this.times)),this.addBlocks(o),kt.end(t)}static fullLayout(t){xa(t,!0),t.isBranch?bo.updateBounds(t):uo.updateBounds(t),va(t)}addExtra(t){if(!this.__updatedList.has(t)){const{updatedList:e,beforeBounds:s}=this.extraBlock||(this.extraBlock=new wa([]));e.length?s.add(t.__world):s.set(t.__world),e.add(t)}}createBlock(t){return new wa(t)}getBlocks(t){return[this.createBlock(t)]}addBlocks(t){this.layoutedBlocks?this.layoutedBlocks.push(...t):this.layoutedBlocks=t}__onReceiveWatchData(t){this.__updatedList=t.data.updatedList}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Yo.REQUEST,this.layout,this),t.on_(Yo.AGAIN,this.layoutAgain,this),t.on_(No.DATA,this.__onReceiveWatchData,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.config=null)}}const ka=xt.get("Renderer");class Ra{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(t,e,s){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:60},this.target=t,this.canvas=e,s&&(this.config=At.default(s,this.config)),this.__listenEvents(),this.__requestRender()}start(){this.running=!0}stop(){this.running=!1}update(){this.changed=!0}requestLayout(){this.target.emit(Yo.REQUEST)}render(t){if(!this.running||!this.canvas.view)return void(this.changed=!0);const{target:e}=this;this.times=0,this.totalBounds=new lt,ka.log(e.innerName,"---\x3e");try{e.isApp||e.app.emit(Xo.CHILD_START,e),this.emitRender(Xo.START),this.renderOnce(t),this.emitRender(Xo.END,this.totalBounds),ur.clearRecycled()}catch(t){this.rendering=!1,ka.error(t)}ka.log("-------------|")}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(t){if(this.rendering)return ka.warn("rendering");if(this.times>3)return ka.warn("render max times");if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new lt,this.renderOptions={},t)this.emitRender(Xo.BEFORE),t();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(Xo.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(Xo.RENDER,this.renderBounds,this.renderOptions),this.emitRender(Xo.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){const{canvas:t,updateBlocks:e}=this;if(!e)return ka.warn("PartRender: need update attr");this.mergeBlocks(),e.forEach((e=>{t.bounds.hit(e)&&!e.isEmpty()&&this.clipRender(e)}))}clipRender(t){const e=kt.start("PartRender"),{canvas:s}=this,i=t.getIntersect(s.bounds),r=t.includes(this.target.__world),o=new lt(i);s.save(),r&&!xt.showRepaint?s.clear():(i.spread(10+1/this.canvas.pixelRatio).ceil(),s.clearWorld(i,!0),s.clipWorld(i,!0)),this.__render(i,r,o),s.restore(),kt.end(e)}fullRender(){const t=kt.start("FullRender"),{canvas:e}=this;e.save(),e.clear(),this.__render(e.bounds,!0),e.restore(),kt.end(t)}__render(t,e,s){const i=t.includes(this.target.__world)?{includes:e}:{bounds:t,includes:e};this.needFill&&this.canvas.fillWorld(t,this.config.fill),xt.showRepaint&&this.canvas.strokeWorld(t,"red"),this.target.__render(this.canvas,i),this.renderBounds=s=s||t,this.renderOptions=i,this.totalBounds.isEmpty()?this.totalBounds=s:this.totalBounds.add(s),xt.showHitView&&this.renderHitView(i),xt.showBoundsView&&this.renderBoundsView(i),this.canvas.updateRender(s)}renderHitView(t){}renderBoundsView(t){}addBlock(t){this.updateBlocks||(this.updateBlocks=[]),this.updateBlocks.push(t)}mergeBlocks(){const{updateBlocks:t}=this;if(t){const e=new lt;e.setList(t),t.length=0,t.push(e)}}__requestRender(){const t=Date.now();e.requestRender((()=>{this.FPS=Math.min(60,Math.ceil(1e3/(Date.now()-t))),this.running&&(this.changed&&this.canvas.view&&this.render(),this.target.emit(Xo.NEXT)),this.target&&this.__requestRender()}))}__onResize(t){if(!this.canvas.unreal){if(t.bigger||!t.samePixelRatio){const{width:e,height:s}=t.old;if(!new lt(0,0,e,s).includes(this.target.__world)||this.needFill||!t.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate("surface")}this.addBlock(new lt(0,0,1,1)),this.changed=!0}}__onLayoutEnd(t){t.data&&t.data.map((t=>{let e;t.updatedList&&t.updatedList.list.some((t=>(e=!t.__world.width||!t.__world.height,e&&(t.isLeafer||ka.tip(t.innerName,": empty"),e=!t.isBranch||t.isBranchLeaf),e))),this.addBlock(e?this.canvas.bounds:t.updatedBounds)}))}emitRender(t,e,s){this.target.emitEvent(new Xo(t,this.times,e,s))}__listenEvents(){const{target:t}=this;this.__eventIds=[t.on_(Xo.REQUEST,this.update,this),t.on_(Yo.END,this.__onLayoutEnd,this),t.on_(Xo.AGAIN,this.renderAgain,this),t.on_(Uo.RESIZE,this.__onResize,this)]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&(this.stop(),this.__removeListenEvents(),this.target=this.canvas=this.config=null)}}function Ca(t){return wr(t,(t=>({set(e){this.__setAttr(t,e),e&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}})))}function Sa(t){return wr(t,(t=>({set(e){this.__setAttr(t,e),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}})))}function Ta(){return(t,e)=>{const s="_"+e;yr(t,e,{set(t){this.isLeafer&&(this[s]=t)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[s]||this:this.leafer&&this.leafer.zoomLayer}})}}Object.assign(s,{watcher:(t,e)=>new ca(t,e),layouter:(t,e)=>new Ba(t,e),renderer:(t,e,s)=>new Ra(t,e,s),selector:(t,e)=>{},interaction:(t,e,s,i)=>{}}),e.layout=Ba.fullLayout;const Pa={},La={},Ia={number:(t,e)=>"object"==typeof t?"percent"===t.type?t.value*e:t.value:t},Oa={},Ea={},Aa={},Ma={},Wa={},Da={},Fa={setStyleName:(t,e,s)=>Ct("state"),set:(t,e)=>Ct("state")},za={list:{},register(t,e){za.list[t]=e},get:t=>za.list[t]},{parse:Ua,objectToCanvasData:Na}=fs,Ya={},Xa=xt.get("UIData");class ja extends Wt{get scale(){const{scaleX:t,scaleY:e}=this;return t!==e?{x:t,y:e}:t}get __strokeWidth(){const{strokeWidth:t,strokeWidthFixed:e}=this;if(e){const e=this.__leaf;let{scaleX:s}=e.__nowWorld||e.__world;return s<0&&(s=-s),s>1?t/s:t}return t}get __hasStroke(){return this.stroke&&this.strokeWidth}get __hasMultiPaint(){const t=this;return!!(t.__isFills&&t.fill.length>1||t.__isStrokes&&t.stroke.length>1||t.__useEffect)||t.fill&&this.__hasStroke}get __clipAfterFill(){return this.cornerRadius||this.__pathInputed}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(t){this._visible=t;const{leafer:e}=this.__leaf;e&&(e.watcher.hasVisible=!0)}setWidth(t){t<0?(this._width=-t,this.__leaf.scaleX*=-1,Xa.warn("width < 0, instead -scaleX ",this)):this._width=t}setHeight(t){t<0?(this._height=-t,this.__leaf.scaleY*=-1,Xa.warn("height < 0, instead -scaleY",this)):this._height=t}setFill(t){this.__naturalWidth&&this.__removeNaturalSize(),"string"!=typeof t&&t?"object"==typeof t&&(this.__setInput("fill",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isFills=!0,this._fill||(this._fill=Ya)):(this.__isFills&&(this.__removeInput("fill"),Aa.recycleImage("fill",this),this.__isFills=!1,this.__pixelFill&&(this.__pixelFill=!1)),this._fill=t)}setStroke(t){"string"!=typeof t&&t?"object"==typeof t&&(this.__setInput("stroke",t),this.__leaf.__layout.boxChanged||this.__leaf.__layout.boxChange(),this.__isStrokes=!0,this._stroke||(this._stroke=Ya)):(this.__isStrokes&&(this.__removeInput("stroke"),Aa.recycleImage("stroke",this),this.__isStrokes=!1,this.__pixelStroke&&(this.__pixelStroke=!1)),this._stroke=t)}setPath(t){const e="string"==typeof t;e||t&&"object"==typeof t[0]?(this.__setInput("path",t),this._path=e?Ua(t):Na(t)):(this.__input&&this.__removeInput("path"),this._path=t)}setShadow(t){this.__setInput("shadow",t),t instanceof Array?(t.some((t=>!1===t.visible))&&(t=t.filter((t=>!1!==t.visible))),this._shadow=t.length?t:null):this._shadow=t&&!1!==t.visible?[t]:null}setInnerShadow(t){this.__setInput("innerShadow",t),t instanceof Array?(t.some((t=>!1===t.visible))&&(t=t.filter((t=>!1!==t.visible))),this._innerShadow=t.length?t:null):this._innerShadow=t&&!1!==t.visible?[t]:null}__computePaint(){const{fill:t,stroke:e}=this.__input;t&&Ea.compute("fill",this.__leaf),e&&Ea.compute("stroke",this.__leaf),this.__needComputePaint=!1}}class Ha extends ja{}class Va extends Ha{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return"hide"===this.overflow&&this.__clipAfterFill&&this.__leaf.children.length}get __clipAfterFill(){return this.__leaf.isOverflow||super.__clipAfterFill}}class Ga extends Ha{__getInputData(t,e){const s=super.__getInputData(t,e);return Gt.forEach((t=>delete s[t])),s}}class qa extends Va{}class Qa extends ja{}class Ja extends ja{get __boxStroke(){return!this.__pathInputed}}class $a extends ja{get __boxStroke(){return!this.__pathInputed}}class Za extends ja{}class Ka extends ja{}class th extends ja{get __pathInputed(){return 2}}class eh extends Ha{}const sh={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900};class ih extends ja{get __useNaturalRatio(){return!1}setFontWeight(t){"string"==typeof t?(this.__setInput("fontWeight",t),this._fontWeight=sh[t]||400):(this.__input&&this.__removeInput("fontWeight"),this._fontWeight=t)}}class rh extends Ja{setUrl(t){this.__setImageFill(t),this._url=t}__setImageFill(t){this.__leaf.image&&(this.__leaf.image=null),this.fill=t?{type:"image",mode:"stretch",url:t}:void 0}__getData(){const t=super.__getData();return delete t.fill,t}__getInputData(t,e){const s=super.__getInputData(t,e);return delete s.fill,s}}class oh extends Ja{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(t,e){const s=super.__getInputData(t,e);return s.url=this.__leaf.canvas.toDataURL("image/png"),s}}const nh={__updateStrokeSpread(){let t=0,e=0;const s=this.__,{strokeAlign:i,strokeWidth:r}=s;if((s.stroke||"all"===s.hitStroke)&&r&&"inside"!==i&&(e=t="center"===i?r/2:r,!s.__boxStroke)){const e=s.__isLinePath?0:10*t,i="none"===s.strokeCap?0:r;t+=Math.max(e,i)}return s.__useArrow&&(t+=5*r),this.__layout.strokeBoxSpread=e,t},__updateRenderSpread(){let t=0;const{shadow:e,innerShadow:s,blur:i,backgroundBlur:r}=this.__;e&&e.forEach((e=>t=Math.max(t,Math.max(Math.abs(e.y),Math.abs(e.x))+(e.spread>0?e.spread:0)+1.5*e.blur))),i&&(t=Math.max(t,i));let o=t=Math.ceil(t);return s&&s.forEach((t=>o=Math.max(o,Math.max(Math.abs(t.y),Math.abs(t.x))+(t.spread<0?-t.spread:0)+1.5*t.blur))),r&&(o=Math.max(o,r)),this.__layout.renderShapeSpread=o,t+(this.__layout.strokeSpread||0)}},ah={__updateChange(){const t=this.__;if(t.__useEffect){const{shadow:e,innerShadow:s,blur:i,backgroundBlur:r}=this.__;t.__useEffect=!!(e||s||i||r)}t.__checkSingle();t.__isFills||t.__isStrokes||t.cornerRadius||t.__useEffect?t.__complex=!0:t.__complex&&(t.__complex=!1)},__drawFast(t,e){hh(this,t,e)},__draw(t,e){const s=this.__;if(s.__complex){s.__needComputePaint&&s.__computePaint();const{fill:i,stroke:r,__drawAfterFill:o}=s;if(this.__drawRenderPath(t),s.__useEffect){const n=Ea.shape(this,t,e);this.__nowWorld=this.__getNowWorld(e);const{shadow:a,innerShadow:h}=s;a&&Wa.shadow(this,t,n),i&&(s.__isFills?Ea.fills(i,this,t):Ea.fill(i,this,t)),o&&this.__drawAfterFill(t,e),h&&Wa.innerShadow(this,t,n),r&&(s.__isStrokes?Ea.strokes(r,this,t):Ea.stroke(r,this,t)),n.worldCanvas&&n.worldCanvas.recycle(),n.canvas.recycle()}else i&&(s.__isFills?Ea.fills(i,this,t):Ea.fill(i,this,t)),o&&this.__drawAfterFill(t,e),r&&(s.__isStrokes?Ea.strokes(r,this,t):Ea.stroke(r,this,t))}else s.__pathInputed?hh(this,t,e):this.__drawFast(t,e)},__renderShape(t,e,s,i){if(this.__worldOpacity){t.setWorld(this.__nowWorld=this.__getNowWorld(e));const{fill:r,stroke:o}=this.__;this.__drawRenderPath(t),r&&!s&&(this.__.__pixelFill?Ea.fills(r,this,t):Ea.fill("#000000",this,t)),this.__.__isCanvas&&this.__drawAfterFill(t,e),o&&!i&&(this.__.__pixelStroke?Ea.strokes(o,this,t):Ea.stroke("#000000",this,t))}},__drawAfterFill(t,e){this.__.__clipAfterFill?(t.save(),this.windingRule?t.clip(this.windingRule):t.clip(),this.__drawContent(t,e),t.restore()):this.__drawContent(t,e)}};function hh(t,e,s){const{fill:i,stroke:r,__drawAfterFill:o}=t.__;t.__drawRenderPath(e),i&&Ea.fill(i,t,e),o&&t.__drawAfterFill(e,s),r&&Ea.stroke(r,t,e)}const lh={__drawFast(t,e){let{width:s,height:i,fill:r,stroke:o,__drawAfterFill:n}=this.__;if(r&&(t.fillStyle=r,t.fillRect(0,0,s,i)),n&&this.__drawAfterFill(t,e),o){const{strokeAlign:r,__strokeWidth:n}=this.__;if(!n)return;t.setStroke(o,n,this.__);const a=n/2;switch(r){case"center":t.strokeRect(0,0,s,i);break;case"inside":s-=n,i-=n,s<0||i<0?(t.save(),this.__clip(t,e),t.strokeRect(a,a,s,i),t.restore()):t.strokeRect(a,a,s,i);break;case"outside":t.strokeRect(-a,-a,s+n,i+n)}}}};var dh,ch;t.UI=dh=class extends t.Leaf{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(t){h.assignScale(this,t)}get scale(){return this.__.scale}get pen(){const{path:t}=this.__;return rr.set(this.path=t||[]),t||this.__drawPathByBox(rr),rr}get editConfig(){}get editOuter(){return""}get editInner(){return""}constructor(t){super(t)}reset(t){}set(t,e){e?(this.lockNormalStyle=!0,Object.assign(this,t),this.lockNormalStyle=!1):Object.assign(this,t)}get(t){return"string"==typeof t?this.__.__getInput(t):this.__.__getInputData(t)}createProxyData(){}find(t,e){}findTag(t){return this.find({tag:t})}findOne(t,e){}findId(t){return this.findOne({id:t})}getPath(t,e){this.__layout.update();let s=e?this.__.__pathForRender:this.__.path;return s||(rr.set(s=[]),this.__drawPathByBox(rr)),t?fs.toCanvasData(s,!0):s}getPathString(t,e,s){return fs.stringify(this.getPath(t,e),s)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){const t=this.__;!t.lazy||this.__inLazyBounds||Da.running?t.__computePaint():t.__needComputePaint=!0}}__updateRenderPath(){if(this.__.path){const t=this.__;t.__pathForRender=t.cornerRadius?ir.smooth(t.path,t.cornerRadius,t.cornerSmoothing):t.path,t.__useArrow&&Oa.addArrows(this,!t.cornerRadius)}}__drawRenderPath(t){t.beginPath(),this.__drawPathByData(t,this.__.__pathForRender)}__drawPath(t){t.beginPath(),this.__drawPathByData(t,this.__.path)}__drawPathByData(t,e){e?yi.drawPathByData(t,e):this.__drawPathByBox(t)}__drawPathByBox(t){const{x:e,y:s,width:i,height:r}=this.__layout.boxBounds;if(this.__.cornerRadius){const{cornerRadius:o}=this.__;t.roundRect(e,s,i,r,"number"==typeof o?[o]:o)}else t.rect(e,s,i,r)}animate(t,e,s,i){return Ct("animate")}killAnimate(t){}export(t,e){return Da.export(this,t,e)}clone(t){const e=this.toJSON();return t&&Object.assign(e,t),dh.one(e)}static one(t,e,s,i,r){return Tt.get(t.tag||this.prototype.__tag,t,e,s,i,r)}static registerUI(){to()(this)}static registerData(t){Hr(t)(this.prototype)}static setEditConfig(t){}static setEditOuter(t){}static setEditInner(t){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}},Ft([Hr(ja)],t.UI.prototype,"__",void 0),Ft([Ta()],t.UI.prototype,"zoomLayer",void 0),Ft([br("")],t.UI.prototype,"id",void 0),Ft([br("")],t.UI.prototype,"name",void 0),Ft([br("")],t.UI.prototype,"className",void 0),Ft([Wr("pass-through")],t.UI.prototype,"blendMode",void 0),Ft([Dr(1)],t.UI.prototype,"opacity",void 0),Ft([Fr(!0)],t.UI.prototype,"visible",void 0),Ft([Wr(!1)],t.UI.prototype,"locked",void 0),Ft([Ur(0)],t.UI.prototype,"zIndex",void 0),Ft([Nr(!1)],t.UI.prototype,"mask",void 0),Ft([Yr(!1)],t.UI.prototype,"eraser",void 0),Ft([Br(0,!0)],t.UI.prototype,"x",void 0),Ft([Br(0,!0)],t.UI.prototype,"y",void 0),Ft([Sr(100,!0)],t.UI.prototype,"width",void 0),Ft([Sr(100,!0)],t.UI.prototype,"height",void 0),Ft([Rr(1,!0)],t.UI.prototype,"scaleX",void 0),Ft([Rr(1,!0)],t.UI.prototype,"scaleY",void 0),Ft([Cr(0,!0)],t.UI.prototype,"rotation",void 0),Ft([Cr(0,!0)],t.UI.prototype,"skewX",void 0),Ft([Cr(0,!0)],t.UI.prototype,"skewY",void 0),Ft([Br(0,!0)],t.UI.prototype,"offsetX",void 0),Ft([Br(0,!0)],t.UI.prototype,"offsetY",void 0),Ft([Br(0,!0)],t.UI.prototype,"scrollX",void 0),Ft([Br(0,!0)],t.UI.prototype,"scrollY",void 0),Ft([kr()],t.UI.prototype,"origin",void 0),Ft([kr()],t.UI.prototype,"around",void 0),Ft([br(!1)],t.UI.prototype,"lazy",void 0),Ft([Tr(1)],t.UI.prototype,"pixelRatio",void 0),Ft([Lr()],t.UI.prototype,"path",void 0),Ft([Ir()],t.UI.prototype,"windingRule",void 0),Ft([Ir(!0)],t.UI.prototype,"closed",void 0),Ft([Sr(0)],t.UI.prototype,"padding",void 0),Ft([Sr(!1)],t.UI.prototype,"lockRatio",void 0),Ft([Sr()],t.UI.prototype,"widthRange",void 0),Ft([Sr()],t.UI.prototype,"heightRange",void 0),Ft([br(!1)],t.UI.prototype,"draggable",void 0),Ft([br()],t.UI.prototype,"dragBounds",void 0),Ft([br(!1)],t.UI.prototype,"editable",void 0),Ft([Xr(!0)],t.UI.prototype,"hittable",void 0),Ft([Xr("path")],t.UI.prototype,"hitFill",void 0),Ft([Ar("path")],t.UI.prototype,"hitStroke",void 0),Ft([Xr(!1)],t.UI.prototype,"hitBox",void 0),Ft([Xr(!0)],t.UI.prototype,"hitChildren",void 0),Ft([Xr(!0)],t.UI.prototype,"hitSelf",void 0),Ft([Xr()],t.UI.prototype,"hitRadius",void 0),Ft([jr("")],t.UI.prototype,"cursor",void 0),Ft([Wr()],t.UI.prototype,"fill",void 0),Ft([Ar()],t.UI.prototype,"stroke",void 0),Ft([Ar("inside")],t.UI.prototype,"strokeAlign",void 0),Ft([Ar(1)],t.UI.prototype,"strokeWidth",void 0),Ft([Ar(!1)],t.UI.prototype,"strokeWidthFixed",void 0),Ft([Ar("none")],t.UI.prototype,"strokeCap",void 0),Ft([Ar("miter")],t.UI.prototype,"strokeJoin",void 0),Ft([Ar()],t.UI.prototype,"dashPattern",void 0),Ft([Ar()],t.UI.prototype,"dashOffset",void 0),Ft([Ar(10)],t.UI.prototype,"miterLimit",void 0),Ft([Ir(0)],t.UI.prototype,"cornerRadius",void 0),Ft([Ir()],t.UI.prototype,"cornerSmoothing",void 0),Ft([Ca()],t.UI.prototype,"shadow",void 0),Ft([Ca()],t.UI.prototype,"innerShadow",void 0),Ft([Ca()],t.UI.prototype,"blur",void 0),Ft([Ca()],t.UI.prototype,"backgroundBlur",void 0),Ft([Ca()],t.UI.prototype,"grayscale",void 0),Ft([br({})],t.UI.prototype,"data",void 0),Ft([Jr(t.Leaf.prototype.reset)],t.UI.prototype,"reset",null),t.UI=dh=Ft([Kr(nh),Kr(ah),$r()],t.UI),t.Group=class extends t.UI{get __tag(){return"Group"}get isBranch(){return!0}constructor(t){super(t)}reset(t){this.__setBranch(),super.reset(t)}__setBranch(){this.children||(this.children=[])}set(t,e){if(t.children){const{children:s}=t;delete t.children,this.children?this.clear():this.__setBranch(),super.set(t,e),s.forEach((t=>this.add(t))),t.children=s}else super.set(t,e)}toJSON(t){const e=super.toJSON(t);return e.children=this.children.map((e=>e.toJSON(t))),e}pick(t,e){}addAt(t,e){this.add(t,e)}addAfter(t,e){this.add(t,this.children.indexOf(e)+1)}addBefore(t,e){this.add(t,this.children.indexOf(e))}add(t,e){}addMany(...t){}remove(t,e){}removeAll(t){}clear(){}},Ft([Hr(Ha)],t.Group.prototype,"__",void 0),t.Group=Ft([Kr(t.Branch),to()],t.Group);const uh=xt.get("Leafer");t.Leafer=ch=class extends t.Group{get __tag(){return"Leafer"}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&ur.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds()}constructor(t,e){super(e),this.config={type:"design",start:!0,hittable:!0,smooth:!0,lazySpeard:100,zoom:{min:.01,max:256},move:{holdSpaceKey:!0,holdMiddleKey:!0,autoDistance:2}},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=t,t&&(t.view||t.width)&&this.init(t),ch.list.add(this)}init(t,e){if(this.canvas)return;let i;this.__setLeafer(this),t&&At.assign(this.config,t);const{config:r}=this;this.initType(r.type);const o=this.canvas=s.canvas(r);this.__controllers.push(this.renderer=s.renderer(this,o,r),this.watcher=s.watcher(this,r),this.layouter=s.layouter(this,r)),this.isApp&&this.__setApp(),this.__checkAutoLayout(r,e),this.view=o.view,e?(this.__bindApp(e),i=e.running):(this.selector=s.selector(this),this.interaction=s.interaction(this,o,this.selector,r),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=s.hitCanvasManager()),this.canvasManager=new Et,i=r.start),this.hittable=r.hittable,this.fill=r.fill,this.canvasManager.add(o),this.__listenEvents(),i&&(this.__startTimer=setTimeout(this.start.bind(this))),Co.run(this.__initWait),this.onInit()}onInit(){}initType(t){}set(t){this.waitInit((()=>{super.set(t)}))}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(jo.RESTART):this.emitLeafer(jo.START),this.__controllers.forEach((t=>t.start())),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach((t=>t.stop())),this.running=!1,this.emitLeafer(jo.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(t){const e=At.copyAttrs({},t,Gt);Object.keys(e).forEach((t=>this[t]=e[t]))}forceRender(t){this.renderer.addBlock(t?new lt(t):this.canvas.bounds),this.viewReady&&this.renderer.update()}updateCursor(t){const e=this.interaction;e&&(t?e.setCursor(t):e.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(t){const{canvas:e}=this;if(!e||e.isSameSize(t))return;const s=At.copyAttrs({},this.canvas,Gt);e.resize(t),this.updateLazyBounds(),this.__onResize(new Uo(t,s))}__onResize(t){this.emitEvent(t),At.copyAttrs(this.__,t,Gt),setTimeout((()=>{this.canvasManager&&this.canvasManager.clearRecycled()}),0)}__setApp(){}__bindApp(t){this.selector=t.selector,this.interaction=t.interaction,this.canvasManager=t.canvasManager,this.hitCanvasManager=t.hitCanvasManager}__setLeafer(t){this.leafer=t,this.__level=1}__checkAutoLayout(t,e){e||(t.width&&t.height||(this.autoLayout=new ct(t)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(t,e){return this.canvas&&(Gt.includes(t)?(e||uh.warn(t+" is 0"),this.__changeCanvasSize(t,e)):"fill"===t?this.__changeFill(e):"hittable"===t?this.parent||(this.canvas.hittable=e):"zIndex"===t&&(this.canvas.zIndex=e,setTimeout((()=>this.parent&&this.parent.__updateSortChildren())))),super.__setAttr(t,e)}__getAttr(t){return this.canvas&&Gt.includes(t)?this.canvas[t]:super.__getAttr(t)}__changeCanvasSize(t,e){const s=At.copyAttrs({},this.canvas,Gt);s[t]=this.config[t]=e,e&&this.canvas.stopAutoLayout(),this.__doResize(s)}__changeFill(t){this.config.fill=t,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=t:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready||(this.ready=!0,this.emitLeafer(jo.BEFORE_READY),this.emitLeafer(jo.READY),this.emitLeafer(jo.AFTER_READY),Co.run(this.__readyWait))}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(jo.VIEW_READY),Co.run(this.__viewReadyWait))}__onNextRender(){if(this.viewReady){Co.run(this.__nextRenderWait);const{imageReady:t}=this;t&&!this.viewCompleted&&this.__checkViewCompleted(),t||(this.viewCompleted=!1)}}__checkViewCompleted(t=!0){this.nextRender((()=>{this.imageReady&&(t&&this.emitLeafer(jo.VIEW_COMPLETED),Co.run(this.__viewCompletedWait),this.viewCompleted=!0)}))}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender((()=>this.interaction.updateCursor()))}waitInit(t,e){e&&(t=t.bind(e)),this.__initWait||(this.__initWait=[]),this.canvas?t():this.__initWait.push(t)}waitReady(t,e){e&&(t=t.bind(e)),this.ready?t():this.__readyWait.push(t)}waitViewReady(t,e){e&&(t=t.bind(e)),this.viewReady?t():this.__viewReadyWait.push(t)}waitViewCompleted(t,e){e&&(t=t.bind(e)),this.__viewCompletedWait.push(t),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(t,e,s){e&&(t=t.bind(e));const i=this.__nextRenderWait;if(s){for(let e=0;e<i.length;e++)if(i[e]===t){i.splice(e,1);break}}else i.push(t)}zoom(t,e,s){return Ct("view")}getValidMove(t,e){return{x:t,y:e}}getValidScale(t){return t}getWorldPointByClient(t,e){return this.interaction&&this.interaction.getLocal(t,e)}getPagePointByClient(t,e){return this.getPagePoint(this.getWorldPointByClient(t,e))}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(t){}__checkUpdateLayout(){this.__layout.update()}emitLeafer(t){this.emitEvent(new jo(t,this))}__listenEvents(){const t=kt.start("FirstCreate "+this.innerName);this.once(jo.START,(()=>kt.end(t))),this.once(Yo.START,(()=>this.updateLazyBounds())),this.once(Yo.END,(()=>this.__onReady())),this.once(Xo.START,(()=>this.__onCreated())),this.once(Xo.END,(()=>this.__onViewReady())),this.__eventIds.push(this.on_(No.DATA,this.__onWatchData,this),this.on_(Xo.NEXT,this.__onNextRender,this),this.on_(Yo.CHECK_UPDATE,this.__checkUpdateLayout,this))}__removeListenEvents(){this.off_(this.__eventIds),this.__eventIds.length=0}destroy(t){const e=()=>{if(!this.destroyed){ch.list.remove(this);try{this.stop(),this.emitEvent(new jo(jo.END,this)),this.__removeListenEvents(),this.__controllers.forEach((t=>!(this.parent&&t===this.interaction)&&t.destroy())),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager.destroy()),this.canvas.destroy(),this.config.view=this.view=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout((()=>{ur.clearRecycled()}),100)}catch(t){uh.error(t)}}};t?e():setTimeout(e)}},t.Leafer.list=new ia,Ft([Hr(Ga)],t.Leafer.prototype,"__",void 0),Ft([Sr()],t.Leafer.prototype,"pixelRatio",void 0),t.Leafer=ch=Ft([to()],t.Leafer),t.Rect=class extends t.UI{get __tag(){return"Rect"}constructor(t){super(t)}},Ft([Hr(Ja)],t.Rect.prototype,"__",void 0),t.Rect=Ft([Kr(lh),$r(),to()],t.Rect);const{copy:_h,add:ph,includes:gh}=ot,fh=t.Rect.prototype,yh=t.Group.prototype,mh={};t.Box=class extends t.Group{get __tag(){return"Box"}get isBranchLeaf(){return!0}constructor(t){super(t),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(t){const e=this.__;if(this.children.length)if(e.__autoSide){super.__updateBoxBounds();const{boxBounds:t}=this.__layout;e.__autoSize||(e.__autoWidth?(t.width+=t.x,t.x=0,t.height=e.height,t.y=0):(t.height+=t.y,t.y=0,t.width=e.width,t.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds();else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let t;const{renderBounds:e}=this.__layout;this.children.length?(super.__updateRenderBounds(),_h(mh,e),this.__updateRectRenderBounds(),t=!gh(e,mh),t&&"hide"!==this.__.overflow&&ph(e,mh)):this.__updateRectRenderBounds(),!this.isOverflow!=!t&&(this.isOverflow=t)}__updateRectRenderBounds(){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(t,e){}__renderGroup(t,e){}__render(t,e){this.__.__drawAfterFill?this.__renderRect(t,e):(this.__renderRect(t,e),this.children.length&&this.__renderGroup(t,e))}__drawContent(t,e){this.__renderGroup(t,e),this.__.__hasStroke&&(t.setWorld(this.__nowWorld),this.__drawRenderPath(t))}},Ft([Hr(Va)],t.Box.prototype,"__",void 0),Ft([br(!1)],t.Box.prototype,"resizeChildren",void 0),Ft([Mr("show")],t.Box.prototype,"overflow",void 0),Ft([Jr(fh.__updateStrokeSpread)],t.Box.prototype,"__updateStrokeSpread",null),Ft([Jr(fh.__updateRenderSpread)],t.Box.prototype,"__updateRectRenderSpread",null),Ft([Jr(fh.__updateBoxBounds)],t.Box.prototype,"__updateRectBoxBounds",null),Ft([Jr(fh.__updateStrokeBounds)],t.Box.prototype,"__updateStrokeBounds",null),Ft([Jr(fh.__updateRenderBounds)],t.Box.prototype,"__updateRectRenderBounds",null),Ft([Jr(fh.__updateChange)],t.Box.prototype,"__updateRectChange",null),Ft([Jr(fh.__render)],t.Box.prototype,"__renderRect",null),Ft([Jr(yh.__render)],t.Box.prototype,"__renderGroup",null),t.Box=Ft([$r(),to()],t.Box),t.Frame=class extends t.Box{get __tag(){return"Frame"}get isFrame(){return!0}constructor(t){super(t)}},Ft([Hr(qa)],t.Frame.prototype,"__",void 0),Ft([Wr("#FFFFFF")],t.Frame.prototype,"fill",void 0),Ft([Mr("hide")],t.Frame.prototype,"overflow",void 0),t.Frame=Ft([to()],t.Frame);const{moveTo:wh,closePath:xh,ellipse:vh}=zs;t.Ellipse=class extends t.UI{get __tag(){return"Ellipse"}constructor(t){super(t)}__updatePath(){const{width:t,height:s,innerRadius:i,startAngle:r,endAngle:o}=this.__,n=t/2,a=s/2,h=this.__.path=[];i?(r||o?(i<1&&vh(h,n,a,n*i,a*i,0,r,o,!1),vh(h,n,a,n,a,0,o,r,!0),i<1&&xh(h)):(i<1&&(vh(h,n,a,n*i,a*i),wh(h,t,a)),vh(h,n,a,n,a,0,360,0,!0)),e.ellipseToCurve&&(this.__.path=this.getPath(!0))):r||o?(wh(h,n,a),vh(h,n,a,n,a,0,r,o,!1),xh(h)):vh(h,n,a,n,a)}},Ft([Hr($a)],t.Ellipse.prototype,"__",void 0),Ft([Ir(0)],t.Ellipse.prototype,"innerRadius",void 0),Ft([Ir(0)],t.Ellipse.prototype,"startAngle",void 0),Ft([Ir(0)],t.Ellipse.prototype,"endAngle",void 0),t.Ellipse=Ft([to()],t.Ellipse);const{moveTo:bh,lineTo:Bh,drawPoints:kh}=zs,{rotate:Rh,getAngle:Ch,getDistance:Sh,defaultPoint:Th}=E,{toBounds:Ph}=Qi;t.Line=class extends t.UI{get __tag(){return"Line"}get toPoint(){const{width:t,rotation:e}=this.__,s={x:0,y:0};return t&&(s.x=t),e&&Rh(s,e),s}set toPoint(t){this.width=Sh(Th,t),this.rotation=Ch(Th,t),this.height&&(this.height=0)}constructor(t){super(t)}__updatePath(){const t=this.__,e=t.path=[];t.points?kh(e,t.points,!1,t.closed):(bh(e,0,0),Bh(e,this.width,0))}__updateRenderPath(){const t=this.__;!this.pathInputed&&t.points&&t.curve?(kh(t.__pathForRender=[],t.points,t.curve,t.closed),t.__useArrow&&Oa.addArrows(this,!1)):super.__updateRenderPath()}__updateBoxBounds(){this.points?Ph(this.__.__pathForRender,this.__layout.boxBounds):super.__updateBoxBounds()}},Ft([Hr(Qa)],t.Line.prototype,"__",void 0),Ft([Or("center")],t.Line.prototype,"strokeAlign",void 0),Ft([Sr(0)],t.Line.prototype,"height",void 0),Ft([Ir()],t.Line.prototype,"points",void 0),Ft([Ir(0)],t.Line.prototype,"curve",void 0),Ft([Ir(!1)],t.Line.prototype,"closed",void 0),t.Line=Ft([to()],t.Line);const{sin:Lh,cos:Ih,PI:Oh}=Math,{moveTo:Eh,lineTo:Ah,closePath:Mh,drawPoints:Wh}=zs,Dh=t.Line.prototype;t.Polygon=class extends t.UI{get __tag(){return"Polygon"}constructor(t){super(t)}__updatePath(){const t=this.__.path=[];if(this.__.points)Wh(t,this.__.points,!1,!0);else{const{width:e,height:s,sides:i}=this.__,r=e/2,o=s/2;Eh(t,r,0);for(let e=1;e<i;e++)Ah(t,r+r*Lh(2*e*Oh/i),o-o*Ih(2*e*Oh/i))}Mh(t)}__updateRenderPath(){}__updateBoxBounds(){}},Ft([Hr(Za)],t.Polygon.prototype,"__",void 0),Ft([Ir(3)],t.Polygon.prototype,"sides",void 0),Ft([Ir()],t.Polygon.prototype,"points",void 0),Ft([Ir(0)],t.Polygon.prototype,"curve",void 0),Ft([Jr(Dh.__updateRenderPath)],t.Polygon.prototype,"__updateRenderPath",null),Ft([Jr(Dh.__updateBoxBounds)],t.Polygon.prototype,"__updateBoxBounds",null),t.Polygon=Ft([$r(),to()],t.Polygon);const{sin:Fh,cos:zh,PI:Uh}=Math,{moveTo:Nh,lineTo:Yh,closePath:Xh}=zs;t.Star=class extends t.UI{get __tag(){return"Star"}constructor(t){super(t)}__updatePath(){const{width:t,height:e,corners:s,innerRadius:i}=this.__,r=t/2,o=e/2,n=this.__.path=[];Nh(n,r,0);for(let t=1;t<2*s;t++)Yh(n,r+(t%2==0?r:r*i)*Fh(t*Uh/s),o-(t%2==0?o:o*i)*zh(t*Uh/s));Xh(n)}},Ft([Hr(Ka)],t.Star.prototype,"__",void 0),Ft([Ir(5)],t.Star.prototype,"corners",void 0),Ft([Ir(.382)],t.Star.prototype,"innerRadius",void 0),t.Star=Ft([to()],t.Star),t.Image=class extends t.Rect{get __tag(){return"Image"}get ready(){return!!this.image&&this.image.ready}constructor(t){super(t),this.on(zo.LOADED,(t=>{"fill"===t.attrName&&t.attrValue.url===this.url&&(this.image=t.image)}))}destroy(){this.image=null,super.destroy()}},Ft([Hr(rh)],t.Image.prototype,"__",void 0),Ft([Sr("")],t.Image.prototype,"url",void 0),t.Image=Ft([to()],t.Image);const jh=t.Image;t.Canvas=class extends t.Rect{get __tag(){return"Canvas"}get ready(){return!this.url}constructor(t){super(t),this.canvas=s.canvas(this.__),this.context=this.canvas.context,t&&t.url&&this.drawImage(t.url)}drawImage(t){new fr({url:t}).load((t=>{this.context.drawImage(t.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new zo(zo.LOADED,{image:t}))}))}draw(t,e,s,i){const r=new U(t.worldTransform).invert(),o=new U;e&&o.translate(e.x,e.y),s&&("number"==typeof s?o.scale(s):o.scale(s.x,s.y)),i&&o.rotate(i),r.multiplyParent(o),t.__render(this.canvas,{matrix:r.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(t,e){const{width:s,height:i}=this.__,{view:r}=this.canvas;t.drawImage(r,0,0,r.width,r.height,0,0,s,i)}__updateSize(){const{canvas:t}=this;if(t){const{smooth:e}=this.__;t.smooth!==e&&(t.smooth=e),t.resize(this.__)}}destroy(){this.canvas&&(this.canvas.destroy(),this.canvas=this.context=null),super.destroy()}},Ft([Hr(oh)],t.Canvas.prototype,"__",void 0),Ft([Sa(100)],t.Canvas.prototype,"width",void 0),Ft([Sa(100)],t.Canvas.prototype,"height",void 0),Ft([Sa(1)],t.Canvas.prototype,"pixelRatio",void 0),Ft([Sa(!0)],t.Canvas.prototype,"smooth",void 0),Ft([Sa()],t.Canvas.prototype,"contextSettings",void 0),t.Canvas=Ft([to()],t.Canvas);const{copyAndSpread:Hh,includes:Vh,isSame:Gh,spread:qh,setList:Qh}=ot;function Jh(t,e){let s;const{rows:i,decorationY:r,decorationHeight:o}=t.__.__textDrawData;for(let t=0,n=i.length;t<n;t++)s=i[t],s.text?e.fillText(s.text,s.x,s.y):s.data&&s.data.forEach((t=>{e.fillText(t.char,t.x,s.y)})),r&&e.fillRect(s.x,s.y+r,s.width,o)}function $h(t,e,s){const{strokeAlign:i}=e.__,r="string"!=typeof t;switch(i){case"center":s.setStroke(r?void 0:t,e.__.strokeWidth,e.__),r?tl(t,!0,e,s):Kh(e,s);break;case"inside":Zh("inside",t,r,e,s);break;case"outside":Zh("outside",t,r,e,s)}}function Zh(t,e,s,i,r){const{__strokeWidth:o,__font:n}=i.__,a=r.getSameCanvas(!0,!0);a.setStroke(s?void 0:e,2*o,i.__),a.font=n,s?tl(e,!0,i,a):Kh(i,a),a.blendMode="outside"===t?"destination-out":"destination-in",Jh(i,a),a.blendMode="normal",i.__worldFlipped?r.copyWorldByReset(a,i.__nowWorld):r.copyWorldToInner(a,i.__nowWorld,i.__layout.renderBounds),a.recycle(i.__nowWorld)}function Kh(t,e){let s;const{rows:i,decorationY:r,decorationHeight:o}=t.__.__textDrawData;for(let t=0,n=i.length;t<n;t++)s=i[t],s.text?e.strokeText(s.text,s.x,s.y):s.data&&s.data.forEach((t=>{e.strokeText(t.char,t.x,s.y)})),r&&e.strokeRect(s.x,s.y+r,s.width,o)}function tl(t,e,s,i){let r;for(let o=0,n=t.length;o<n;o++)r=t[o],r.image&&Aa.checkImage(s,i,r,!1)||r.style&&(i.strokeStyle=r.style,r.blendMode?(i.saveBlendMode(r.blendMode),e?Kh(s,i):i.stroke(),i.restoreBlendMode()):e?Kh(s,i):i.stroke())}t.Text=class extends t.UI{get __tag(){return"Text"}get textDrawData(){return this.__layout.update(),this.__.__textDrawData}constructor(t){super(t)}__drawHitPath(t){const{__lineHeight:e,fontSize:s,__baseLine:i,__textDrawData:r}=this.__;t.beginPath(),this.__.__letterSpacing<0?this.__drawPathByData(t):r.rows.forEach((r=>t.rect(r.x,r.y-i,r.width,e<s?s:e)))}__drawPathByData(t,e){const{x:s,y:i,width:r,height:o}=this.__layout.boxBounds;t.rect(s,i,r,o)}__drawRenderPath(t){t.font=this.__.__font}__updateTextDrawData(){const t=this.__,{lineHeight:e,letterSpacing:s,fontFamily:i,fontSize:r,fontWeight:o,italic:n,textCase:a,textOverflow:l,padding:d}=t;t.__lineHeight=Ia.number(e,r),t.__letterSpacing=Ia.number(s,r),t.__padding=d?h.fourNumber(d):void 0,t.__baseLine=t.__lineHeight-(t.__lineHeight-.7*r)/2,t.__font=`${n?"italic ":""}${"small-caps"===a?"small-caps ":""}${"normal"!==o?o+" ":""}${r}px ${i}`,t.__clipText="show"!==l&&!t.__autoSize,t.__textDrawData=Pa.getDrawData(t.text,this.__)}__updateBoxBounds(){const t=this.__,e=this.__layout,{fontSize:s,italic:i,padding:r,__autoWidth:o,__autoHeight:n}=t;this.__updateTextDrawData();const{bounds:a}=t.__textDrawData,h=e.boxBounds;if(t.__lineHeight<s&&qh(a,s/2),o||n){if(h.x=o?a.x:0,h.y=n?a.y:0,h.width=o?a.width:t.width,h.height=n?a.height:t.height,r){const[e,s,i,r]=t.__padding;o&&(h.x-=r,h.width+=s+r),n&&(h.y-=e,h.height+=i+e)}this.__updateNaturalSize()}else super.__updateBoxBounds();i&&(h.width+=.16*s);const l=Vh(h,a)?h:a;Gh(l,e.contentBounds)?t.__textBoxBounds=l:(e.contentBounds=l,e.renderChanged=!0,Qh(t.__textBoxBounds={},[h,a]))}__updateRenderSpread(){let t=super.__updateRenderSpread();return t||(t=this.__layout.boxBounds===this.__layout.contentBounds?0:1),t}__updateRenderBounds(){Hh(this.__layout.renderBounds,this.__.__textBoxBounds,this.__layout.renderSpread)}},Ft([Hr(ih)],t.Text.prototype,"__",void 0),Ft([Sr(0)],t.Text.prototype,"width",void 0),Ft([Sr(0)],t.Text.prototype,"height",void 0),Ft([br(!1)],t.Text.prototype,"resizeFontSize",void 0),Ft([Wr("#000000")],t.Text.prototype,"fill",void 0),Ft([Or("outside")],t.Text.prototype,"strokeAlign",void 0),Ft([Xr("all")],t.Text.prototype,"hitFill",void 0),Ft([Sr("")],t.Text.prototype,"text",void 0),Ft([Sr("L")],t.Text.prototype,"fontFamily",void 0),Ft([Sr(12)],t.Text.prototype,"fontSize",void 0),Ft([Sr("normal")],t.Text.prototype,"fontWeight",void 0),Ft([Sr(!1)],t.Text.prototype,"italic",void 0),Ft([Sr("none")],t.Text.prototype,"textCase",void 0),Ft([Sr("none")],t.Text.prototype,"textDecoration",void 0),Ft([Sr(0)],t.Text.prototype,"letterSpacing",void 0),Ft([Sr({type:"percent",value:1.5})],t.Text.prototype,"lineHeight",void 0),Ft([Sr(0)],t.Text.prototype,"paraIndent",void 0),Ft([Sr(0)],t.Text.prototype,"paraSpacing",void 0),Ft([Sr("left")],t.Text.prototype,"textAlign",void 0),Ft([Sr("top")],t.Text.prototype,"verticalAlign",void 0),Ft([Sr(!0)],t.Text.prototype,"autoSizeAlign",void 0),Ft([Sr("normal")],t.Text.prototype,"textWrap",void 0),Ft([Sr("show")],t.Text.prototype,"textOverflow",void 0),t.Text=Ft([to()],t.Text),t.Path=class extends t.UI{get __tag(){return"Path"}constructor(t){super(t)}},Ft([Hr(th)],t.Path.prototype,"__",void 0),Ft([Or("center")],t.Path.prototype,"strokeAlign",void 0),t.Path=Ft([to()],t.Path),t.Pen=class extends t.Group{get __tag(){return"Pen"}constructor(t){super(t)}setStyle(e){const s=this.pathElement=new t.Path(e);return this.pathStyle=e,this.__path=s.path||(s.path=[]),this.add(s),this}beginPath(){return this}moveTo(t,e){return this}lineTo(t,e){return this}bezierCurveTo(t,e,s,i,r,o){return this}quadraticCurveTo(t,e,s,i){return this}closePath(){return this}rect(t,e,s,i){return this}roundRect(t,e,s,i,r){return this}ellipse(t,e,s,i,r,o,n,a){return this}arc(t,e,s,i,r,o){return this}arcTo(t,e,s,i,r){return this}drawEllipse(t,e,s,i,r,o,n,a){return this}drawArc(t,e,s,i,r,o){return this}drawPoints(t,e,s){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate("path")}},Ft([Hr(eh)],t.Pen.prototype,"__",void 0),Ft([(t,e)=>{yr(t,e,{get(){return this.__path}})}],t.Pen.prototype,"path",void 0),t.Pen=Ft([Kr(si,["set","path","paint"]),to()],t.Pen);const{getSpread:el,getOuterOf:sl,getByMove:il,getIntersectData:rl}=ot;let ol;function nl(t,e,s){if("object"!=typeof e||!1===e.visible||0===e.opacity)return;const{boxBounds:i}=s.__layout;switch(e.type){case"solid":let{type:r,blendMode:o,color:n,opacity:a}=e;return{type:r,blendMode:o,style:La.string(n,a)};case"image":return Aa.image(s,t,e,i,!ol||!ol[e.url]);case"linear":return Ma.linearGradient(e,i);case"radial":return Ma.radialGradient(e,i);case"angular":return Ma.conicGradient(e,i);default:return void 0!==e.r?{type:"solid",style:La.string(e)}:void 0}}const al={compute:function(t,e){const s=e.__,i=[];let r,o=s.__input[t];o instanceof Array||(o=[o]),ol=Aa.recycleImage(t,s);for(let s,r=0,n=o.length;r<n;r++)s=nl(t,o[r],e),s&&i.push(s);s["_"+t]=i.length?i:void 0,i.length&&i[0].image&&(r=i[0].image.hasOpacityPixel),"fill"===t?s.__pixelFill=r:s.__pixelStroke=r},fill:function(t,e,s){s.fillStyle=t,e.__.__font?Jh(e,s):e.__.windingRule?s.fill(e.__.windingRule):s.fill()},fills:function(t,e,s){let i;const{windingRule:r,__font:o}=e.__;for(let n=0,a=t.length;n<a;n++)i=t[n],i.image&&Aa.checkImage(e,s,i,!o)||i.style&&(s.fillStyle=i.style,i.transform?(s.save(),s.transform(i.transform),i.blendMode&&(s.blendMode=i.blendMode),o?Jh(e,s):r?s.fill(r):s.fill(),s.restore()):i.blendMode?(s.saveBlendMode(i.blendMode),o?Jh(e,s):r?s.fill(r):s.fill(),s.restoreBlendMode()):o?Jh(e,s):r?s.fill(r):s.fill())},fillText:Jh,stroke:function(t,e,s){const i=e.__,{__strokeWidth:r,strokeAlign:o,__font:n}=i;if(r)if(n)$h(t,e,s);else switch(o){case"center":s.setStroke(t,r,i),s.stroke();break;case"inside":s.save(),s.setStroke(t,2*r,i),i.windingRule?s.clip(i.windingRule):s.clip(),s.stroke(),s.restore();break;case"outside":const o=s.getSameCanvas(!0,!0);o.setStroke(t,2*r,i),e.__drawRenderPath(o),o.stroke(),i.windingRule?o.clip(i.windingRule):o.clip(),o.clearWorld(e.__layout.renderBounds),e.__worldFlipped?s.copyWorldByReset(o,e.__nowWorld):s.copyWorldToInner(o,e.__nowWorld,e.__layout.renderBounds),o.recycle(e.__nowWorld)}},strokes:function(t,e,s){const i=e.__,{__strokeWidth:r,strokeAlign:o,__font:n}=i;if(r)if(n)$h(t,e,s);else switch(o){case"center":s.setStroke(void 0,r,i),tl(t,!1,e,s);break;case"inside":s.save(),s.setStroke(void 0,2*r,i),i.windingRule?s.clip(i.windingRule):s.clip(),tl(t,!1,e,s),s.restore();break;case"outside":const{renderBounds:o}=e.__layout,n=s.getSameCanvas(!0,!0);e.__drawRenderPath(n),n.setStroke(void 0,2*r,i),tl(t,!1,e,n),i.windingRule?n.clip(i.windingRule):n.clip(),n.clearWorld(o),e.__worldFlipped?s.copyWorldByReset(n,e.__nowWorld):s.copyWorldToInner(n,e.__nowWorld,o),n.recycle(e.__nowWorld)}},strokeText:$h,drawTextStroke:Kh,shape:function(t,e,s){const i=e.getSameCanvas(),r=t.__nowWorld;let o,n,a,h,{scaleX:l,scaleY:d}=r;if(l<0&&(l=-l),d<0&&(d=-d),e.bounds.includes(r))h=i,o=a=r;else{const{renderShapeSpread:i}=t.__layout,c=rl(i?el(e.bounds,l===d?i*l:[i*d,i*l]):e.bounds,r);n=e.bounds.getFitMatrix(c);let{a:u,d:_}=n;if(n.a<1&&(h=e.getSameCanvas(),t.__renderShape(h,s),l*=u,d*=_),a=sl(r,n),o=il(a,-n.e,-n.f),s.matrix){const{matrix:t}=s;n.multiply(t),u*=t.scaleX,_*=t.scaleY}s=Object.assign(Object.assign({},s),{matrix:n.withScale(u,_)})}return t.__renderShape(i,s),{canvas:i,matrix:n,bounds:o,worldCanvas:h,shapeBounds:a,scaleX:l,scaleY:d}}};let hl={};const{get:ll,rotateOfOuter:dl,translate:cl,scaleOfOuter:ul,scale:_l,rotate:pl}=b;function gl(t,e,s,i,r,o,n){const a=ll();cl(a,e.x+s,e.y+i),_l(a,r,o),n&&dl(a,{x:e.x+e.width/2,y:e.y+e.height/2},n),t.transform=a}function fl(t,e,s,i,r,o,n){const a=ll();cl(a,e.x+s,e.y+i),r&&_l(a,r,o),n&&pl(a,n),t.transform=a}function yl(t,e,s,i,r,o,n,a,h,l){const d=ll();if(h)if("center"===l)dl(d,{x:s/2,y:i/2},h);else switch(pl(d,h),h){case 90:cl(d,i,0);break;case 180:cl(d,s,i);break;case 270:cl(d,0,s)}hl.x=e.x+r,hl.y=e.y+o,cl(d,hl.x,hl.y),n&&ul(d,hl,n,a),t.transform=d}const{get:ml,translate:wl}=b,xl=new lt,vl={},bl={};function Bl(t,e,s,i){const{blendMode:r,sync:o}=s;r&&(t.blendMode=r),o&&(t.sync=o),t.data=kl(s,i,e)}function kl(t,e,s){let{width:i,height:r}=s;t.padding&&(e=xl.set(e).shrink(t.padding)),"strench"===t.mode&&(t.mode="stretch");const{opacity:o,mode:n,align:a,offset:l,scale:d,size:c,rotation:u,repeat:_}=t,p=e.width===i&&e.height===r,g={mode:n},f="center"!==a&&(u||0)%180==90,y=f?r:i,m=f?i:r;let w,x,v=0,b=0;if(n&&"cover"!==n&&"fit"!==n)(d||c)&&(h.getScaleData(d,c,s,bl),w=bl.scaleX,x=bl.scaleY);else if(!p||u){const t=e.width/y,s=e.height/m;w=x="fit"===n?Math.min(t,s):Math.max(t,s),v+=(e.width-i*w)/2,b+=(e.height-r*x)/2}if(a){const t={x:v,y:b,width:y,height:m};w&&(t.width*=w,t.height*=x),mt.toPoint(a,t,e,vl,!0),v+=vl.x,b+=vl.y}switch(l&&(v+=l.x,b+=l.y),n){case"stretch":p||(i=e.width,r=e.height);break;case"normal":case"clip":(v||b||w||u)&&fl(g,e,v,b,w,x,u);break;case"repeat":(!p||w||u)&&yl(g,e,i,r,v,b,w,x,u,a),_||(g.repeat="repeat");break;default:w&&gl(g,e,v,b,w,x,u)}return g.transform||(e.x||e.y)&&(g.transform=ml(),wl(g.transform,e.x,e.y)),w&&"stretch"!==n&&(g.scaleX=w,g.scaleY=x),g.width=i,g.height=r,o&&(g.opacity=o),_&&(g.repeat="string"==typeof _?"x"===_?"repeat-x":"repeat-y":"repeat"),g}let Rl,Cl=new lt;const{isSame:Sl}=ot;function Tl(t,e,s,i,r,o){if("fill"===e&&!t.__.__naturalWidth){const e=t.__;if(e.__naturalWidth=i.width/e.pixelRatio,e.__naturalHeight=i.height/e.pixelRatio,e.__autoSide)return t.forceUpdate("width"),t.__proxyData&&(t.setProxyAttr("width",e.width),t.setProxyAttr("height",e.height)),!1}return r.data||Bl(r,i,s,o),!0}function Pl(t,e){Ol(t,zo.LOAD,e)}function Ll(t,e){Ol(t,zo.LOADED,e)}function Il(t,e,s){e.error=s,t.forceUpdate("surface"),Ol(t,zo.ERROR,e)}function Ol(t,e,s){t.hasEvent(e)&&t.emitEvent(new zo(e,s))}function El(t,e){const{leafer:s}=t;s&&s.viewReady&&(s.renderer.ignore=e)}const{get:Al,scale:Ml,copy:Wl}=b,{ceil:Dl,abs:Fl}=Math;function zl(t,s,i){let{scaleX:r,scaleY:o}=ur.patternLocked?t.__world:t.__nowWorld;const n=r+"-"+o+"-"+i;if(s.patternId===n||t.destroyed)return!1;{r=Fl(r),o=Fl(o);const{image:t,data:a}=s;let h,l,{width:d,height:c,scaleX:u,scaleY:_,opacity:p,transform:g,repeat:f}=a;u&&(l=Al(),Wl(l,g),Ml(l,1/u,1/_),r*=u,o*=_),r*=i,o*=i,d*=r,c*=o;const y=d*c;if(!f&&y>e.image.maxCacheSize)return!1;let m=e.image.maxPatternSize;if(!t.isSVG){const e=t.width*t.height;m>e&&(m=e)}y>m&&(h=Math.sqrt(y/m)),h&&(r/=h,o/=h,d/=h,c/=h),u&&(r/=u,o/=_),(g||1!==r||1!==o)&&(l||(l=Al(),g&&Wl(l,g)),Ml(l,1/r,1/o));const w=t.getCanvas(Dl(d)||1,Dl(c)||1,p),x=t.getPattern(w,f||e.origin.noRepeat||"no-repeat",l,s);return s.style=x,s.patternId=n,!0}}const{abs:Ul}=Math;const Nl={image:function(t,e,s,i,r){let o,n;const a=ur.get(s);return Rl&&s===Rl.paint&&Sl(i,Rl.boxBounds)?o=Rl.leafPaint:(o={type:s.type,image:a},Rl=a.use>1?{leafPaint:o,paint:s,boxBounds:Cl.set(i)}:null),(r||a.loading)&&(n={image:a,attrName:e,attrValue:s}),a.ready?(Tl(t,e,s,a,o,i),r&&(Pl(t,n),Ll(t,n))):a.error?r&&Il(t,n,a.error):(r&&(El(t,!0),Pl(t,n)),o.loadId=a.load((()=>{El(t,!1),t.destroyed||(Tl(t,e,s,a,o,i)&&(a.hasOpacityPixel&&(t.__layout.hitCanvasChanged=!0),t.forceUpdate("surface")),Ll(t,n)),o.loadId=null}),(e=>{El(t,!1),Il(t,n,e),o.loadId=null}))),o},checkImage:function(t,s,i,r){const{scaleX:o,scaleY:n}=ur.patternLocked?t.__world:t.__nowWorld,{pixelRatio:a}=s;if(!i.data||i.patternId===o+"-"+n+"-"+a&&!Da.running)return!1;{const{data:h}=i;if(r)if(h.repeat)r=!1;else{let{width:t,height:s}=h;t*=Ul(o)*a,s*=Ul(n)*a,h.scaleX&&(t*=h.scaleX,s*=h.scaleY),r=t*s>e.image.maxCacheSize||Da.running}return r?(s.save(),t.windingRule?s.clip(t.windingRule):s.clip(),i.blendMode&&(s.blendMode=i.blendMode),h.opacity&&(s.opacity*=h.opacity),h.transform&&s.transform(h.transform),s.drawImage(i.image.view,0,0,h.width,h.height),s.restore(),!0):(!i.style||i.sync||Da.running?zl(t,i,a):i.patternTask||(i.patternTask=ur.patternTasker.add((()=>zt(this,void 0,void 0,(function*(){i.patternTask=null,s.bounds.hit(t.__nowWorld)&&zl(t,i,a),t.forceUpdate("surface")}))),300)),!1)}},createPattern:zl,recycleImage:function(t,e){const s=e["_"+t];if(s instanceof Array){let i,r,o,n;for(let a=0,h=s.length;a<h;a++)i=s[a].image,n=i&&i.url,n&&(r||(r={}),r[n]=!0,ur.recycle(i),i.loading&&(o||(o=e.__input&&e.__input[t]||[],o instanceof Array||(o=[o])),i.unload(s[a].loadId,!o.some((t=>t.url===n)))));return r}return null},createData:Bl,getPatternData:kl,fillOrFitMode:gl,clipMode:fl,repeatMode:yl},{toPoint:Yl}=gt,Xl={},jl={};function Hl(t,e,s){if(e){let i;for(let r=0,o=e.length;r<o;r++)i=e[r],"string"==typeof i?t.addColorStop(r/(o-1),La.string(i,s)):t.addColorStop(i.offset,La.string(i.color,s))}}const{getAngle:Vl,getDistance:Gl}=E,{get:ql,rotateOfOuter:Ql,scaleOfOuter:Jl}=b,{toPoint:$l}=gt,Zl={},Kl={};function td(t,e,s,i,r){let o;const{width:n,height:a}=t;if(n!==a||i){const t=Vl(e,s);o=ql(),r?(Jl(o,e,n/a*(i||1),1),Ql(o,e,t+90)):(Jl(o,e,1,n/a*(i||1)),Ql(o,e,t))}return o}const{getDistance:ed}=E,{toPoint:sd}=gt,id={},rd={};const od={linearGradient:function(t,s){let{from:i,to:r,type:o,blendMode:n,opacity:a}=t;Yl(i||"top",s,Xl),Yl(r||"bottom",s,jl);const h=e.canvas.createLinearGradient(Xl.x,Xl.y,jl.x,jl.y);Hl(h,t.stops,a);const l={type:o,style:h};return n&&(l.blendMode=n),l},radialGradient:function(t,s){let{from:i,to:r,type:o,opacity:n,blendMode:a,stretch:h}=t;$l(i||"center",s,Zl),$l(r||"bottom",s,Kl);const l=e.canvas.createRadialGradient(Zl.x,Zl.y,0,Zl.x,Zl.y,Gl(Zl,Kl));Hl(l,t.stops,n);const d={type:o,style:l},c=td(s,Zl,Kl,h,!0);return c&&(d.transform=c),a&&(d.blendMode=a),d},conicGradient:function(t,s){let{from:i,to:r,type:o,opacity:n,blendMode:a,stretch:h}=t;sd(i||"center",s,id),sd(r||"bottom",s,rd);const l=e.conicGradientSupport?e.canvas.createConicGradient(0,id.x,id.y):e.canvas.createRadialGradient(id.x,id.y,0,id.x,id.y,ed(id,rd));Hl(l,t.stops,n);const d={type:o,style:l},c=td(s,id,rd,h||1,e.conicGradientRotate90);return c&&(d.transform=c),a&&(d.blendMode=a),d},getTransform:td},{copy:nd,toOffsetOutBounds:ad}=ot,hd={},ld={};function dd(t,s,i,r){const{bounds:o,shapeBounds:n}=r;if(e.fullImageShadow){if(nd(hd,t.bounds),hd.x+=s.x-n.x,hd.y+=s.y-n.y,i){const{matrix:t}=r;hd.x-=(o.x+(t?t.e:0)+o.width/2)*(i-1),hd.y-=(o.y+(t?t.f:0)+o.height/2)*(i-1),hd.width*=i,hd.height*=i}t.copyWorld(r.canvas,t.bounds,hd)}else i&&(nd(hd,s),hd.x-=s.width/2*(i-1),hd.y-=s.height/2*(i-1),hd.width*=i,hd.height*=i),t.copyWorld(r.canvas,n,i?hd:s)}const{toOffsetOutBounds:cd}=ot,ud={};const _d={shadow:function(t,e,s){let i,r;const{__nowWorld:o,__layout:n}=t,{shadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=s,_=e.getSameCanvas(),p=a.length-1;ad(l,ld),a.forEach(((a,g)=>{_.setWorldShadow(ld.offsetX+a.x*c,ld.offsetY+a.y*u,a.blur*c,a.color),r=a.spread?1+2*a.spread/(n.boxBounds.width+2*(n.strokeBoxSpread||0)):0,dd(_,ld,r,s),i=l,a.box&&(_.restore(),_.save(),h&&(_.copyWorld(_,l,o,"copy"),i=o),h?_.copyWorld(h,o,o,"destination-out"):_.copyWorld(s.canvas,d,l,"destination-out")),t.__worldFlipped?e.copyWorldByReset(_,i,o,a.blendMode):e.copyWorldToInner(_,i,n.renderBounds,a.blendMode),p&&g<p&&_.clearWorld(i,!0)})),_.recycle(i)},innerShadow:function(t,e,s){let i,r;const{__nowWorld:o,__layout:n}=t,{innerShadow:a}=t.__,{worldCanvas:h,bounds:l,shapeBounds:d,scaleX:c,scaleY:u}=s,_=e.getSameCanvas(),p=a.length-1;cd(l,ud),a.forEach(((a,g)=>{_.save(),_.setWorldShadow(ud.offsetX+a.x*c,ud.offsetY+a.y*u,a.blur*c),r=a.spread?1-2*a.spread/(n.boxBounds.width+2*(n.strokeBoxSpread||0)):0,dd(_,ud,r,s),_.restore(),h?(_.copyWorld(_,l,o,"copy"),_.copyWorld(h,o,o,"source-out"),i=o):(_.copyWorld(s.canvas,d,l,"source-out"),i=l),_.fillWorld(i,a.color,"source-in"),t.__worldFlipped?e.copyWorldByReset(_,i,o,a.blendMode):e.copyWorldToInner(_,i,n.renderBounds,a.blendMode),p&&g<p&&_.clearWorld(i,!0)})),_.recycle(i)},blur:function(t,e,s){const{blur:i}=t.__;s.setWorldBlur(i*t.__nowWorld.a),s.copyWorldToInner(e,t.__nowWorld,t.__layout.renderBounds),s.filter="none"},backgroundBlur:function(t,e,s){}},{excludeRenderBounds:pd}=xo;function gd(t,e,s,i,r,o){switch(e){case"grayscale":r.useGrayscaleAlpha(t.__nowWorld);case"alpha":!function(t,e,s,i){const r=t.__nowWorld;s.resetTransform(),s.opacity=1,s.useMask(i,r),i.recycle(r),yd(t,e,s,1)}(t,s,i,r);break;case"opacity-path":yd(t,s,i,o);break;case"path":s.restore()}}function fd(t){return t.getSameCanvas(!1,!0)}function yd(t,e,s,i){const r=t.__nowWorld;e.resetTransform(),e.opacity=i,e.copyWorld(s,r),s.recycle(r)}t.Group.prototype.__renderMask=function(t,e){let s,i,r,o,n,a;const{children:h}=this;for(let l=0,d=h.length;l<d;l++)s=h[l],a=s.__.mask,a&&(n&&(gd(this,n,t,r,i,o),i=r=null),"path"===a||"clipping-path"===a?(s.opacity<1?(n="opacity-path",o=s.opacity,r||(r=fd(t))):(n="path",t.save()),s.__clip(r||t,e)):(n="grayscale"===a?"grayscale":"alpha",i||(i=fd(t)),r||(r=fd(t)),s.__render(i,e)),"clipping"!==a&&"clipping-path"!==a)||pd(s,e)||s.__render(r||t,e);gd(this,n,t,r,i,o)};const md=">)]}%!?,.:;'\"",wd=md+"_#~&*+\\=|",xd=new RegExp([[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]].map((([t,e])=>`[\\u${t.toString(16)}-\\u${e.toString(16)}]`)).join("|"));function vd(t){const e={};return t.split("").forEach((t=>e[t]=!0)),e}const bd=vd("ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz"),Bd=vd("{[(<'\""),kd=vd(md),Rd=vd(wd),Cd=vd("- ");var Sd;!function(t){t[t.Letter=0]="Letter",t[t.Single=1]="Single",t[t.Before=2]="Before",t[t.After=3]="After",t[t.Symbol=4]="Symbol",t[t.Break=5]="Break"}(Sd||(Sd={}));const{Letter:Td,Single:Pd,Before:Ld,After:Id,Symbol:Od,Break:Ed}=Sd;function Ad(t){return bd[t]?Td:Cd[t]?Ed:Bd[t]?Ld:kd[t]?Id:Rd[t]?Od:xd.test(t)?Pd:Td}const Md={trimRight(t){const{words:e}=t;let s,i=0,r=e.length;for(let o=r-1;o>-1&&(s=e[o].data[0]," "===s.char);o--)i++,t.width-=s.width;i&&e.splice(r-i,i)}};function Wd(t,e,s){switch(e){case"title":return s?t.toUpperCase():t;case"upper":return t.toUpperCase();case"lower":return t.toLowerCase();default:return t}}const{trimRight:Dd}=Md,{Letter:Fd,Single:zd,Before:Ud,After:Nd,Symbol:Yd,Break:Xd}=Sd;let jd,Hd,Vd,Gd,qd,Qd,Jd,$d,Zd,Kd,tc,ec,sc,ic,rc,oc,nc,ac=[];function hc(t,e){Zd&&!$d&&($d=Zd),jd.data.push({char:t,width:e}),Vd+=e}function lc(){Gd+=Vd,jd.width=Vd,Hd.words.push(jd),jd={data:[]},Vd=0}function dc(){ic&&(rc.paraNumber++,Hd.paraStart=!0,ic=!1),Zd&&(Hd.startCharSize=$d,Hd.endCharSize=Zd,$d=0),Hd.width=Gd,oc.width?Dd(Hd):nc&&cc(),ac.push(Hd),Hd={words:[]},Gd=0}function cc(){Gd>(rc.maxWidth||0)&&(rc.maxWidth=Gd)}const uc=0,_c=1,pc=2;const{top:gc,right:fc,bottom:yc,left:mc}=t.Direction4;function wc(t,e,s){const{bounds:i,rows:r}=t;i[e]+=s;for(let t=0;t<r.length;t++)r[t][e]+=s}const xc={getDrawData:function(t,s){"string"!=typeof t&&(t=String(t));let i=0,r=0,o=s.__getInput("width")||0,n=s.__getInput("height")||0;const{textDecoration:a,__font:h,__padding:l}=s;l&&(o?(i=l[mc],o-=l[fc]+l[mc]):s.autoSizeAlign||(i=l[mc]),n?(r=l[gc],n-=l[gc]+l[yc]):s.autoSizeAlign||(r=l[gc]));const d={bounds:{x:i,y:r,width:o,height:n},rows:[],paraNumber:0,font:e.canvas.font=h};return function(t,s,i){rc=t,ac=t.rows,oc=t.bounds,nc=!oc.width&&!i.autoSizeAlign;const{__letterSpacing:r,paraIndent:o,textCase:n}=i,{canvas:a}=e,{width:h,height:l}=oc;if(h||l||r||"none"!==n){const t="none"!==i.textWrap,e="break"===i.textWrap;ic=!0,tc=null,$d=Jd=Zd=Vd=Gd=0,jd={data:[]},Hd={words:[]};for(let i=0,l=s.length;i<l;i++)Qd=s[i],"\n"===Qd?(Vd&&lc(),Hd.paraEnd=!0,dc(),ic=!0):(Kd=Ad(Qd),Kd===Fd&&"none"!==n&&(Qd=Wd(Qd,n,!Vd)),Jd=a.measureText(Qd).width,r&&(r<0&&(Zd=Jd),Jd+=r),ec=Kd===zd&&(tc===zd||tc===Fd)||tc===zd&&Kd!==Nd,sc=!(Kd!==Ud&&Kd!==zd||tc!==Yd&&tc!==Nd),qd=ic&&o?h-o:h,t&&h&&Gd+Vd+Jd>qd&&(e?(Vd&&lc(),Gd&&dc()):(sc||(sc=Kd===Fd&&tc==Nd),ec||sc||Kd===Xd||Kd===Ud||Kd===zd||Vd+Jd>qd?(Vd&&lc(),Gd&&dc()):Gd&&dc()))," "===Qd&&!0!==ic&&Gd+Vd===0||(Kd===Xd?(" "===Qd&&Vd&&lc(),hc(Qd,Jd),lc()):ec||sc?(Vd&&lc(),hc(Qd,Jd)):hc(Qd,Jd)),tc=Kd);Vd&&lc(),Gd&&dc(),ac.length>0&&(ac[ac.length-1].paraEnd=!0)}else s.split("\n").forEach((t=>{rc.paraNumber++,Gd=a.measureText(t).width,ac.push({x:o||0,text:t,width:Gd,paraStart:!0}),nc&&cc()}))}(d,t,s),l&&function(t,e,s,i,r){if(!i&&s.autoSizeAlign)switch(s.textAlign){case"left":wc(e,"x",t[mc]);break;case"right":wc(e,"x",-t[fc])}if(!r&&s.autoSizeAlign)switch(s.verticalAlign){case"top":wc(e,"y",t[gc]);break;case"bottom":wc(e,"y",-t[yc])}}(l,d,s,o,n),function(t,e){const{rows:s,bounds:i}=t,{__lineHeight:r,__baseLine:o,__letterSpacing:n,__clipText:a,textAlign:h,verticalAlign:l,paraSpacing:d,autoSizeAlign:c}=e;let{x:u,y:_,width:p,height:g}=i,f=r*s.length+(d?d*(t.paraNumber-1):0),y=o;if(a&&f>g)f=Math.max(g,r),t.overflow=s.length;else if(g||c)switch(l){case"middle":_+=(g-f)/2;break;case"bottom":_+=g-f}y+=_;let m,w,x,v=p||c?p:t.maxWidth;for(let o=0,l=s.length;o<l;o++){if(m=s[o],m.x=u,m.width<p||m.width>p&&!a)switch(h){case"center":m.x+=(v-m.width)/2;break;case"right":m.x+=v-m.width}m.paraStart&&d&&o>0&&(y+=d),m.y=y,y+=r,t.overflow>o&&y>f&&(m.isOverflow=!0,t.overflow=o+1),w=m.x,x=m.width,n<0&&(m.width<0?(x=-m.width+e.fontSize+n,w-=x,x+=e.fontSize):x-=n),w<i.x&&(i.x=w),x>i.width&&(i.width=x),a&&p&&p<x&&(m.isOverflow=!0,t.overflow||(t.overflow=s.length))}i.y=_,i.height=f}(d,s),function(t,e,s,i){const{rows:r}=t,{textAlign:o,paraIndent:n,letterSpacing:a}=e;let h,l,d,c,u;r.forEach((t=>{t.words&&(d=n&&t.paraStart?n:0,l=s&&"justify"===o&&t.words.length>1?(s-t.width-d)/(t.words.length-1):0,c=a||t.isOverflow?uc:l>.01?_c:pc,t.isOverflow&&!a&&(t.textMode=!0),c===pc?(t.x+=d,function(t){t.text="",t.words.forEach((e=>{e.data.forEach((e=>{t.text+=e.char}))}))}(t)):(t.x+=d,h=t.x,t.data=[],t.words.forEach((e=>{c===_c?(u={char:"",x:h},h=function(t,e,s){return t.forEach((t=>{s.char+=t.char,e+=t.width})),e}(e.data,h,u),(t.isOverflow||" "!==u.char)&&t.data.push(u)):h=function(t,e,s,i){return t.forEach((t=>{(i||" "!==t.char)&&(t.x=e,s.push(t)),e+=t.width})),e}(e.data,h,t.data,t.isOverflow),!t.paraEnd&&l&&(h+=l,t.width+=l)}))),t.words=null)}))}(d,s,o),d.overflow&&function(t,s,i,r){if(!r)return;const{rows:o,overflow:n}=t;let{textOverflow:a}=s;if(o.splice(n),a&&"show"!==a){let t,h;"hide"===a?a="":"ellipsis"===a&&(a="...");const l=a?e.canvas.measureText(a).width:0,d=i+r-l;("none"===s.textWrap?o:[o[n-1]]).forEach((e=>{if(e.isOverflow&&e.data){let s=e.data.length-1;for(let i=s;i>-1&&(t=e.data[i],h=t.x+t.width,!(i===s&&h<d));i--){if(h<d&&" "!==t.char){e.data.splice(i+1),e.width-=t.width;break}e.width-=t.width}e.width+=l,e.data.push({char:a,x:h}),e.textMode&&function(t){t.text="",t.data.forEach((e=>{t.text+=e.char})),t.data=null}(e)}}))}}(d,s,i,o),"none"!==a&&function(t,e){const{fontSize:s}=e;switch(t.decorationHeight=s/11,e.textDecoration){case"under":t.decorationY=.15*s;break;case"delete":t.decorationY=.35*-s}}(d,s),d}};const vc={string:function(t,e){const s="number"==typeof e&&1!==e;if("string"==typeof t){if(!s||!La.object)return t;t=La.object(t)}let i=void 0===t.a?1:t.a;s&&(i*=e);const r=t.r+","+t.g+","+t.b;return 1===i?"rgb("+r+")":"rgba("+r+","+i+")"}},{setPoint:bc,addPoint:Bc,toBounds:kc}=Y;const Rc={export(t,i,r){this.running=!0;const o=ar.fileType(i),n=i.includes(".");return r=ar.getExportOptions(r),function(t){Cc||(Cc=new cr);return new Promise((e=>{Cc.add((()=>zt(this,void 0,void 0,(function*(){return yield t(e)}))),{parallel:!1})}))}((a=>new Promise((l=>{const d=t=>{a(t),l(),this.running=!1},{toURL:c}=e,{download:u}=e.origin;if("json"===o)return n&&u(c(JSON.stringify(t.toJSON(r.json)),"text"),i),d({data:!!n||t.toJSON(r.json)});if("svg"===o)return n&&u(c(t.toSVG(),"svg"),i),d({data:!!n||t.toSVG()});const{leafer:_}=t;_?(Sc(t),_.waitViewCompleted((()=>zt(this,void 0,void 0,(function*(){let e,o,n=1,a=1;const{worldTransform:l,isLeafer:c,isFrame:u}=t,{slice:p,trim:g,onCanvas:f}=r,y=void 0===r.smooth?_.config.smooth:r.smooth,m=r.contextSettings||_.config.contextSettings,w=r.screenshot||t.isApp,x=c&&w&&void 0===r.fill?t.fill:r.fill,v=ar.isOpaqueImage(i)||x,b=new U;if(w)e=!0===w?c?_.canvas.bounds:t.worldRenderBounds:w;else{let s=r.relative||(c?"inner":"local");switch(n=l.scaleX,a=l.scaleY,s){case"inner":b.set(l);break;case"local":b.set(l).divide(t.localTransform),n/=t.scaleX,a/=t.scaleY;break;case"world":n=1,a=1;break;case"page":s=t.leafer;default:b.set(l).divide(t.getTransform(s));const e=s.worldTransform;n/=n/e.scaleX,a/=a/e.scaleY}e=t.getBounds("render",s)}const B={scaleX:1,scaleY:1};h.getScaleData(r.scale,r.size,e,B);let k=r.pixelRatio||1;t.isApp&&(B.scaleX*=k,B.scaleY*=k,k=t.app.pixelRatio);const{x:R,y:C,width:S,height:T}=new lt(e).scale(B.scaleX,B.scaleY),P={matrix:b.scale(1/B.scaleX,1/B.scaleY).invert().translate(-R,-C).withScale(1/n*B.scaleX,1/a*B.scaleY)};let L,I=s.canvas({width:Math.round(S),height:Math.round(T),pixelRatio:k,smooth:y,contextSettings:m});if(p&&(L=t,L.__worldOpacity=0,t=_,P.bounds=I.bounds),I.save(),u&&void 0!==x){const e=t.get("fill");t.fill="",t.__render(I,P),t.fill=e}else t.__render(I,P);if(I.restore(),L&&L.__updateWorldOpacity(),g){o=function(t){const{width:e,height:s}=t.view,{data:i}=t.context.getImageData(0,0,e,s);let r,o,n,a=0;for(let t=0;t<i.length;t+=4)0!==i[t+3]&&(r=a%e,o=(a-r)/e,n?Bc(n,r,o):bc(n={},r,o)),a++;const h=new lt;return kc(n,h),h.scale(1/t.pixelRatio).ceil()}(I);const t=I,{width:e,height:i}=o,r={x:0,y:0,width:e,height:i,pixelRatio:k};I=s.canvas(r),I.copyWorld(t,o,r)}v&&I.fillWorld(I.bounds,x||"#FFFFFF","destination-over"),f&&f(I);const O="canvas"===i?I:yield I.export(i,r);d({data:O,width:I.pixelWidth,height:I.pixelHeight,renderBounds:e,trimBounds:o})}))))):d({data:!1})}))))}};let Cc;function Sc(t){t.__.__needComputePaint&&t.__.__computePaint(),t.isBranch&&t.children.forEach((t=>Sc(t)))}const Tc=qt.prototype,Pc=xt.get("@leafer-ui/export");return Tc.export=function(t,e){const{quality:s,blob:i}=ar.getExportOptions(e);return t.includes(".")?this.saveAs(t,s):i?this.toBlob(t,s):this.toDataURL(t,s)},Tc.toBlob=function(t,s){return new Promise((i=>{e.origin.canvasToBolb(this.view,t,s).then((t=>{i(t)})).catch((t=>{Pc.error(t),i(null)}))}))},Tc.toDataURL=function(t,s){return e.origin.canvasToDataURL(this.view,t,s)},Tc.saveAs=function(t,s){return new Promise((i=>{e.origin.canvasSaveAs(this.view,t,s).then((()=>{i(!0)})).catch((t=>{Pc.error(t),i(!1)}))}))},Object.assign(Pa,xc),Object.assign(La,vc),Object.assign(Ea,al),Object.assign(Aa,Nl),Object.assign(Ma,od),Object.assign(Wa,_d),Object.assign(Da,Rc),la(),t.AlignHelper=mt,t.AroundHelper=gt,t.AutoBounds=ct,t.BezierHelper=Be,t.Bounds=lt,t.BoundsHelper=ot,t.BoxData=Va,t.BranchHelper=bo,t.BranchRender=Rn,t.CanvasData=oh,t.CanvasManager=Et,t.ChildEvent=Do,t.ColorConvert=La,t.Creator=s,t.DataHelper=At,t.Debug=xt,t.Effect=Wa,t.EllipseData=$a,t.EllipseHelper=Oe,t.Event=Wo,t.EventCreator=It,t.Eventer=Vo,t.Export=Da,t.FileHelper=ar,t.FrameData=qa,t.GroupData=Ha,t.ImageData=rh,t.ImageEvent=zo,t.ImageManager=ur,t.IncrementId=i,t.LayoutEvent=Yo,t.Layouter=Ba,t.LeafBounds=bn,t.LeafBoundsHelper=xo,t.LeafData=Wt,t.LeafDataProxy=an,t.LeafEventer=rn,t.LeafHelper=uo,t.LeafLayout=Mo,t.LeafLevelList=ra,t.LeafList=ia,t.LeafMatrix=pn,t.LeafRender=Bn,t.LeaferCanvas=na,t.LeaferCanvasBase=qt,t.LeaferData=Ga,t.LeaferEvent=jo,t.LeaferImage=fr,t.LineData=Qa,t.MathHelper=h,t.Matrix=U,t.MatrixHelper=b,t.MyImage=jh,t.NeedConvertToCanvasCommandMap=Kt,t.OneRadian=l,t.PI2=d,t.PI_2=c,t.Paint=Ea,t.PaintGradient=Ma,t.PaintImage=Aa,t.PathArrow=Oa,t.PathBounds=Qi,t.PathCommandDataHelper=zs,t.PathCommandMap=$t,t.PathConvert=fs,t.PathCorner=ir,t.PathCreator=si,t.PathData=th,t.PathDrawer=yi,t.PathHelper=Qt,t.PathNumberCommandLengthMap=ie,t.PathNumberCommandMap=se,t.PenData=eh,t.Platform=e,t.Point=F,t.PointHelper=E,t.PolygonData=Za,t.PropertyEvent=Fo,t.RectData=Ja,t.RectHelper=re,t.RectRender=lh,t.RenderEvent=Xo,t.Renderer=Ra,t.ResizeEvent=Uo,t.Run=kt,t.StarData=Ka,t.State=Fa,t.StringNumberMap=wt,t.TaskItem=dr,t.TaskProcessor=cr,t.TextConvert=Pa,t.TextData=ih,t.Transition=za,t.TwoPointBoundsHelper=Y,t.UIBounds=nh,t.UICreator=Tt,t.UIData=ja,t.UIRender=ah,t.UnitConvert=Ia,t.WaitHelper=Co,t.WatchEvent=No,t.Watcher=ca,t.affectRenderBoundsType=Mr,t.affectStrokeBoundsType=Or,t.attr=xr,t.autoLayoutType=kr,t.boundsType=Sr,t.canvasPatch=nr,t.canvasSizeAttrs=Gt,t.cursorType=jr,t.dataProcessor=Hr,t.dataType=br,t.decorateLeafAttr=wr,t.defineDataProcessor=Vr,t.defineKey=yr,t.defineLeafAttr=vr,t.doBoundsType=Pr,t.doStrokeType=Er,t.effectType=Ca,t.emptyData={},t.eraserType=Yr,t.getBoundsData=_,t.getDescriptor=mr,t.getMatrixData=p,t.getPointData=u,t.hitType=Xr,t.isNull=function(t){return null==t},t.layoutProcessor=function(t){return(e,s)=>{yr(e,"__LayoutProcessor",{get:()=>t})}},t.maskType=Nr,t.naturalBoundsType=Tr,t.needPlugin=Ct,t.opacityType=Dr,t.pathInputType=Lr,t.pathType=Ir,t.pen=rr,t.positionType=Br,t.registerUI=to,t.registerUIEvent=function(){return t=>{It.register(t)}},t.resizeType=Sa,t.rewrite=Jr,t.rewriteAble=$r,t.rotationType=Cr,t.scaleType=Rr,t.sortType=Ur,t.strokeType=Ar,t.surfaceType=Wr,t.tempBounds=dt,t.tempMatrix=N,t.tempPoint=z,t.useCanvas=la,t.useModule=Kr,t.version="1.0.10",t.visibleType=Fr,t.zoomLayerType=Ta,t}({});
