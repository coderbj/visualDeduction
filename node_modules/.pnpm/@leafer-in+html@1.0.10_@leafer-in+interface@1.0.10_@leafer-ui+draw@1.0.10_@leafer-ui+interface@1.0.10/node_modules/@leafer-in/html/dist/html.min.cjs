"use strict";var e=require("@leafer-ui/draw");function t(e,t,n,o){var r,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var d=e.length-1;d>=0;d--)(r=e[d])&&(s=(i<3?r(s):i>3?r(t,n,s):r(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}"function"==typeof SuppressedError&&SuppressedError;class n extends e.ImageData{setText(e){this._text=e,this.__htmlChanged=!0}}exports.HTMLText=class extends e.Image{get __tag(){return"HTMLText"}get editInner(){return"TextEditor"}constructor(e){super(e)}__updateBoxBounds(){const e=this.__;if(e.__htmlChanged){const t=document.createElement("div"),{style:n}=t;n.all="initial",n.position="absolute",n.visibility="hidden",t.innerHTML=this.text,document.body.appendChild(t);const{width:o,height:r}=t.getBoundingClientRect(),i=o+10,s=`<svg xmlns="http://www.w3.org/2000/svg" width="${i}" height="${r}">\n                        <foreignObject width="${i}" height="${r}">\n                            <style>\n                                * {\n                                    margin: 0;\n                                    padding: 0;\n                                    box-sizing: border-box;\n                                }\n                            </style>\n                            <body xmlns="http://www.w3.org/1999/xhtml">\n                                ${this.text}\n                            </body>\n                        </foreignObject>\n                    </svg>`;e.__setImageFill("data:image/svg+xml,"+encodeURIComponent(s)),e.__naturalWidth=i/e.pixelRatio,e.__naturalHeight=r/e.pixelRatio,e.__htmlChanged=!1,t.remove()}super.__updateBoxBounds()}},t([e.dataProcessor(n)],exports.HTMLText.prototype,"__",void 0),t([e.boundsType("")],exports.HTMLText.prototype,"text",void 0),exports.HTMLText=t([e.registerUI()],exports.HTMLText),exports.HTMLTextData=n;
